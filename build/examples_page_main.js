function er(e,r,...n){let[t,...i]=e.split("."),a=document.createElement(t);i.length>0&&a.classList.add(...i);for(var[u,s]of Object.entries(r??{}))a.setAttribute(u,s);return a.append(...n),a}function Ji(e){let r=er("span");return r.innerHTML=e,r}function Xi(e){return document.querySelector(e)}var Qi=".scm";var Zi=/^\*([a-z-_+]+)\*$/i;var ea="https://api.github.com/repos/dragoncoder047/lynx/contents/examples/files/";function Ka(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ka=function(){return!!e})()}function Sn(e,r){return Sn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,t){return n.__proto__=t,n},Sn(e,r)}function at(e,r,n){if(Ka())return Reflect.construct.apply(null,arguments);var t=[null];t.push.apply(t,r);var i=new(e.bind.apply(e,t));return n&&Sn(i,n.prototype),i}function Ja(e){if(Array.isArray(e))return e}function Xa(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qt(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,t=Array(r);n<r;n++)t[n]=e[n];return t}function mi(e,r){if(e){if(typeof e=="string")return Qt(e,r);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qt(e,r):void 0}}function Qa(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ut(e){return Ja(e)||Xa(e)||mi(e)||Qa()}function ye(e){"@babel/helpers - typeof";return ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ye(e)}function vo(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yo(e,r){if(r&&(ye(r)=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vo(e)}function Bn(e){return Bn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bn(e)}function vi(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&Sn(e,r)}function go(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function ot(e){var r=typeof Map=="function"?new Map:void 0;return ot=function(t){if(t===null||!go(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(r!==void 0){if(r.has(t))return r.get(t);r.set(t,i)}function i(){return at(t,arguments,Bn(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Sn(i,t)},ot(e)}function ra(e,r,n,t,i,a,u){try{var s=e[a](u),o=s.value}catch(f){return void n(f)}s.done?r(o):Promise.resolve(o).then(t,i)}function ke(e){return function(){var r=this,n=arguments;return new Promise(function(t,i){var a=e.apply(r,n);function u(o){ra(a,t,i,u,s,"next",o)}function s(o){ra(a,t,i,u,s,"throw",o)}u(void 0)})}}function vr(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function bo(e,r){if(ye(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var t=n.call(e,r||"default");if(ye(t)!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Za(e){var r=bo(e,"string");return ye(r)=="symbol"?r:r+""}function wo(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,Za(t.key),t)}}function yr(e,r,n){return r&&wo(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mr(e,r,n){return(r=Za(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function Do(e,r){if(e==null)return{};var n={};for(var t in e)if({}.hasOwnProperty.call(e,t)){if(r.includes(t))continue;n[t]=e[t]}return n}function _n(e,r){if(e==null)return{};var n,t,i=Do(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)n=a[t],r.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function xo(e,r){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var t,i,a,u,s=[],o=!0,f=!1;try{if(a=(n=n.call(e)).next,r===0){if(Object(n)!==n)return;o=!1}else for(;!(o=(t=a.call(n)).done)&&(s.push(t.value),s.length!==r);o=!0);}catch(c){f=!0,i=c}finally{try{if(!o&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(f)throw i}}return s}}function ve(e,r){return Ja(e)||xo(e,r)||mi(e,r)||Qa()}function Eo(e){if(Array.isArray(e))return Qt(e)}function Ao(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ge(e){return Eo(e)||Xa(e)||mi(e)||Ao()}function eu(e,r){this.v=e,this.k=r}function Fo(e){return new eu(e,0)}function ko(e){return function(){return new An(e.apply(this,arguments))}}function An(e){var r,n;function t(a,u){try{var s=e[a](u),o=s.value,f=o instanceof eu;Promise.resolve(f?o.v:o).then(function(c){if(f){var _=a==="return"?"return":"next";if(!o.k||c.done)return t(_,c);c=e[_](c).value}i(s.done?"return":"normal",c)},function(c){t("throw",c)})}catch(c){i("throw",c)}}function i(a,u){switch(a){case"return":r.resolve({value:u,done:!0});break;case"throw":r.reject(u);break;default:r.resolve({value:u,done:!1})}(r=r.next)?t(r.key,r.arg):n=null}this._invoke=function(a,u){return new Promise(function(s,o){var f={key:a,arg:u,resolve:s,reject:o,next:null};n?n=n.next=f:(r=n=f,t(a,u))})},typeof e.return!="function"&&(this.return=void 0)}An.prototype[typeof Symbol=="function"&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},An.prototype.next=function(e){return this._invoke("next",e)},An.prototype.throw=function(e){return this._invoke("throw",e)},An.prototype.return=function(e){return this._invoke("return",e)};function Co(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Tt={exports:{}},Lt={exports:{}},na;function Oo(){return na||(na=1,function(e){function r(n){"@babel/helpers - typeof";return e.exports=r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e.exports.__esModule=!0,e.exports.default=e.exports,r(n)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(Lt)),Lt.exports}var ta;function So(){return ta||(ta=1,function(e){var r=Oo().default;function n(){e.exports=n=function(){return i},e.exports.__esModule=!0,e.exports.default=e.exports;var t,i={},a=Object.prototype,u=a.hasOwnProperty,s=Object.defineProperty||function(j,D,F){j[D]=F.value},o=typeof Symbol=="function"?Symbol:{},f=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",_=o.toStringTag||"@@toStringTag";function m(j,D,F){return Object.defineProperty(j,D,{value:F,enumerable:!0,configurable:!0,writable:!0}),j[D]}try{m({},"")}catch{m=function(F,z,re){return F[z]=re}}function k(j,D,F,z){var re=D&&D.prototype instanceof A?D:A,ne=Object.create(re.prototype),be=new T(z||[]);return s(ne,"_invoke",{value:y(j,F,be)}),ne}function L(j,D,F){try{return{type:"normal",arg:j.call(D,F)}}catch(z){return{type:"throw",arg:z}}}i.wrap=k;var b="suspendedStart",g="suspendedYield",h="executing",v="completed",p={};function A(){}function O(){}function S(){}var V={};m(V,f,function(){return this});var K=Object.getPrototypeOf,G=K&&K(K(X([])));G&&G!==a&&u.call(G,f)&&(V=G);var M=S.prototype=A.prototype=Object.create(V);function W(j){["next","throw","return"].forEach(function(D){m(j,D,function(F){return this._invoke(D,F)})})}function ce(j,D){function F(re,ne,be,Fe){var J=L(j[re],j,ne);if(J.type!=="throw"){var nr=J.arg,Ge=nr.value;return Ge&&r(Ge)=="object"&&u.call(Ge,"__await")?D.resolve(Ge.__await).then(function(tr){F("next",tr,be,Fe)},function(tr){F("throw",tr,be,Fe)}):D.resolve(Ge).then(function(tr){nr.value=tr,be(nr)},function(tr){return F("throw",tr,be,Fe)})}Fe(J.arg)}var z;s(this,"_invoke",{value:function(ne,be){function Fe(){return new D(function(J,nr){F(ne,be,J,nr)})}return z=z?z.then(Fe,Fe):Fe()}})}function y(j,D,F){var z=b;return function(re,ne){if(z===h)throw Error("Generator is already running");if(z===v){if(re==="throw")throw ne;return{value:t,done:!0}}for(F.method=re,F.arg=ne;;){var be=F.delegate;if(be){var Fe=N(be,F);if(Fe){if(Fe===p)continue;return Fe}}if(F.method==="next")F.sent=F._sent=F.arg;else if(F.method==="throw"){if(z===b)throw z=v,F.arg;F.dispatchException(F.arg)}else F.method==="return"&&F.abrupt("return",F.arg);z=h;var J=L(j,D,F);if(J.type==="normal"){if(z=F.done?v:g,J.arg===p)continue;return{value:J.arg,done:F.done}}J.type==="throw"&&(z=v,F.method="throw",F.arg=J.arg)}}}function N(j,D){var F=D.method,z=j.iterator[F];if(z===t)return D.delegate=null,F==="throw"&&j.iterator.return&&(D.method="return",D.arg=t,N(j,D),D.method==="throw")||F!=="return"&&(D.method="throw",D.arg=new TypeError("The iterator does not provide a '"+F+"' method")),p;var re=L(z,j.iterator,D.arg);if(re.type==="throw")return D.method="throw",D.arg=re.arg,D.delegate=null,p;var ne=re.arg;return ne?ne.done?(D[j.resultName]=ne.value,D.next=j.nextLoc,D.method!=="return"&&(D.method="next",D.arg=t),D.delegate=null,p):ne:(D.method="throw",D.arg=new TypeError("iterator result is not an object"),D.delegate=null,p)}function P(j){var D={tryLoc:j[0]};1 in j&&(D.catchLoc=j[1]),2 in j&&(D.finallyLoc=j[2],D.afterLoc=j[3]),this.tryEntries.push(D)}function R(j){var D=j.completion||{};D.type="normal",delete D.arg,j.completion=D}function T(j){this.tryEntries=[{tryLoc:"root"}],j.forEach(P,this),this.reset(!0)}function X(j){if(j||j===""){var D=j[f];if(D)return D.call(j);if(typeof j.next=="function")return j;if(!isNaN(j.length)){var F=-1,z=function re(){for(;++F<j.length;)if(u.call(j,F))return re.value=j[F],re.done=!1,re;return re.value=t,re.done=!0,re};return z.next=z}}throw new TypeError(r(j)+" is not iterable")}return O.prototype=S,s(M,"constructor",{value:S,configurable:!0}),s(S,"constructor",{value:O,configurable:!0}),O.displayName=m(S,_,"GeneratorFunction"),i.isGeneratorFunction=function(j){var D=typeof j=="function"&&j.constructor;return!!D&&(D===O||(D.displayName||D.name)==="GeneratorFunction")},i.mark=function(j){return Object.setPrototypeOf?Object.setPrototypeOf(j,S):(j.__proto__=S,m(j,_,"GeneratorFunction")),j.prototype=Object.create(M),j},i.awrap=function(j){return{__await:j}},W(ce.prototype),m(ce.prototype,c,function(){return this}),i.AsyncIterator=ce,i.async=function(j,D,F,z,re){re===void 0&&(re=Promise);var ne=new ce(k(j,D,F,z),re);return i.isGeneratorFunction(D)?ne:ne.next().then(function(be){return be.done?be.value:ne.next()})},W(M),m(M,_,"Generator"),m(M,f,function(){return this}),m(M,"toString",function(){return"[object Generator]"}),i.keys=function(j){var D=Object(j),F=[];for(var z in D)F.push(z);return F.reverse(),function re(){for(;F.length;){var ne=F.pop();if(ne in D)return re.value=ne,re.done=!1,re}return re.done=!0,re}},i.values=X,T.prototype={constructor:T,reset:function(D){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!D)for(var F in this)F.charAt(0)==="t"&&u.call(this,F)&&!isNaN(+F.slice(1))&&(this[F]=t)},stop:function(){this.done=!0;var D=this.tryEntries[0].completion;if(D.type==="throw")throw D.arg;return this.rval},dispatchException:function(D){if(this.done)throw D;var F=this;function z(nr,Ge){return be.type="throw",be.arg=D,F.next=nr,Ge&&(F.method="next",F.arg=t),!!Ge}for(var re=this.tryEntries.length-1;re>=0;--re){var ne=this.tryEntries[re],be=ne.completion;if(ne.tryLoc==="root")return z("end");if(ne.tryLoc<=this.prev){var Fe=u.call(ne,"catchLoc"),J=u.call(ne,"finallyLoc");if(Fe&&J){if(this.prev<ne.catchLoc)return z(ne.catchLoc,!0);if(this.prev<ne.finallyLoc)return z(ne.finallyLoc)}else if(Fe){if(this.prev<ne.catchLoc)return z(ne.catchLoc,!0)}else{if(!J)throw Error("try statement without catch or finally");if(this.prev<ne.finallyLoc)return z(ne.finallyLoc)}}}},abrupt:function(D,F){for(var z=this.tryEntries.length-1;z>=0;--z){var re=this.tryEntries[z];if(re.tryLoc<=this.prev&&u.call(re,"finallyLoc")&&this.prev<re.finallyLoc){var ne=re;break}}ne&&(D==="break"||D==="continue")&&ne.tryLoc<=F&&F<=ne.finallyLoc&&(ne=null);var be=ne?ne.completion:{};return be.type=D,be.arg=F,ne?(this.method="next",this.next=ne.finallyLoc,p):this.complete(be)},complete:function(D,F){if(D.type==="throw")throw D.arg;return D.type==="break"||D.type==="continue"?this.next=D.arg:D.type==="return"?(this.rval=this.arg=D.arg,this.method="return",this.next="end"):D.type==="normal"&&F&&(this.next=F),p},finish:function(D){for(var F=this.tryEntries.length-1;F>=0;--F){var z=this.tryEntries[F];if(z.finallyLoc===D)return this.complete(z.completion,z.afterLoc),R(z),p}},catch:function(D){for(var F=this.tryEntries.length-1;F>=0;--F){var z=this.tryEntries[F];if(z.tryLoc===D){var re=z.completion;if(re.type==="throw"){var ne=re.arg;R(z)}return ne}}throw Error("illegal catch attempt")},delegateYield:function(D,F,z){return this.delegate={iterator:X(D),resultName:F,nextLoc:z},this.method==="next"&&(this.arg=t),p}},i}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(Tt)),Tt.exports}var Mt,ia;function Bo(){if(ia)return Mt;ia=1;var e=So()();Mt=e;try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}return Mt}var jo=Bo(),ae=Co(jo),Zt;try{Zt=new TextDecoder}catch{}var ee,Jr,I=0,Io=105,Po=57342,No=57343,aa=57337,ua=6,Zr={},bn=11281e4,wr=1681e4,de={},Be,st,ct=0,jn=0,Le,ir,Ie=[],ei=[],Ze,We,Fn,oa={useRecords:!1,mapsAsObjects:!0},In=!1,ru=2;try{new Function("")}catch{ru=1/0}var ft=class e{constructor(r){if(r&&((r.keyMap||r._keyMap)&&!r.useRecords&&(r.useRecords=!1,r.mapsAsObjects=!0),r.useRecords===!1&&r.mapsAsObjects===void 0&&(r.mapsAsObjects=!0),r.getStructures&&(r.getShared=r.getStructures),r.getShared&&!r.structures&&((r.structures=[]).uninitialized=!0),r.keyMap)){this.mapKey=new Map;for(let[n,t]of Object.entries(r.keyMap))this.mapKey.set(t,n)}Object.assign(this,r)}decodeKey(r){return this.keyMap&&this.mapKey.get(r)||r}encodeKey(r){return this.keyMap&&this.keyMap.hasOwnProperty(r)?this.keyMap[r]:r}encodeKeys(r){if(!this._keyMap)return r;let n=new Map;for(let[t,i]of Object.entries(r))n.set(this._keyMap.hasOwnProperty(t)?this._keyMap[t]:t,i);return n}decodeKeys(r){if(!this._keyMap||r.constructor.name!="Map")return r;if(!this._mapKey){this._mapKey=new Map;for(let[t,i]of Object.entries(this._keyMap))this._mapKey.set(i,t)}let n={};return r.forEach((t,i)=>n[ar(this._mapKey.has(i)?this._mapKey.get(i):i)]=t),n}mapDecode(r,n){let t=this.decode(r);if(this._keyMap)switch(t.constructor.name){case"Array":return t.map(i=>this.decodeKeys(i))}return t}decode(r,n){if(ee)return au(()=>(ii(),this?this.decode(r,n):e.prototype.decode.call(oa,r,n)));Jr=n>-1?n:r.length,I=0,jn=0,st=null,Le=null,ee=r;try{We=r.dataView||(r.dataView=new DataView(r.buffer,r.byteOffset,r.byteLength))}catch(t){throw ee=null,r instanceof Uint8Array?t:new Error("Source must be a Uint8Array or Buffer but was a "+(r&&typeof r=="object"?r.constructor.name:typeof r))}if(this instanceof e){if(de=this,Ze=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return Be=this.structures,Rn();(!Be||Be.length>0)&&(Be=[])}else de=oa,(!Be||Be.length>0)&&(Be=[]),Ze=null;return Rn()}decodeMultiple(r,n){let t,i=0;try{let a=r.length;In=!0;let u=this?this.decode(r,a):bi.decode(r,a);if(n){if(n(u)===!1)return;for(;I<a;)if(i=I,n(Rn())===!1)return}else{for(t=[u];I<a;)i=I,t.push(Rn());return t}}catch(a){throw a.lastPosition=i,a.values=t,a}finally{In=!1,ii()}}};function Rn(){try{let e=me();if(Le){if(I>=Le.postBundlePosition){let r=new Error("Unexpected bundle position");throw r.incomplete=!0,r}I=Le.postBundlePosition,Le=null}if(I==Jr)Be=null,ee=null,ir&&(ir=null);else if(I>Jr){let r=new Error("Unexpected end of CBOR data");throw r.incomplete=!0,r}else if(!In)throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw ii(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function me(){let e=ee[I++],r=e>>5;if(e=e&31,e>23)switch(e){case 24:e=ee[I++];break;case 25:if(r==7)return Ro();e=We.getUint16(I),I+=2;break;case 26:if(r==7){let n=We.getFloat32(I);if(de.useFloat32>2){let t=gi[(ee[I]&127)<<1|ee[I+1]>>7];return I+=4,(t*n+(n>0?.5:-.5)>>0)/t}return I+=4,n}e=We.getUint32(I),I+=4;break;case 27:if(r==7){let n=We.getFloat64(I);return I+=8,n}if(r>1){if(We.getUint32(I)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");e=We.getUint32(I+4)}else de.int64AsNumber?(e=We.getUint32(I)*4294967296,e+=We.getUint32(I+4)):e=We.getBigUint64(I);I+=8;break;case 31:switch(r){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let n=[],t,i=0;for(;(t=me())!=Zr;){if(i>=bn)throw new Error(`Array length exceeds ${bn}`);n[i++]=t}return r==4?n:r==3?n.join(""):Buffer.concat(n);case 5:let a;if(de.mapsAsObjects){let u={},s=0;if(de.keyMap)for(;(a=me())!=Zr;){if(s++>=wr)throw new Error(`Property count exceeds ${wr}`);u[ar(de.decodeKey(a))]=me()}else for(;(a=me())!=Zr;){if(s++>=wr)throw new Error(`Property count exceeds ${wr}`);u[ar(a)]=me()}return u}else{Fn&&(de.mapsAsObjects=!0,Fn=!1);let u=new Map;if(de.keyMap){let s=0;for(;(a=me())!=Zr;){if(s++>=wr)throw new Error(`Map size exceeds ${wr}`);u.set(de.decodeKey(a),me())}}else{let s=0;for(;(a=me())!=Zr;){if(s++>=wr)throw new Error(`Map size exceeds ${wr}`);u.set(a,me())}}return u}case 7:return Zr;default:throw new Error("Invalid major type for indefinite length "+r)}default:throw new Error("Unknown token "+e)}switch(r){case 0:return e;case 1:return~e;case 2:return Mo(e);case 3:if(jn>=I)return st.slice(I-ct,(I+=e)-ct);if(jn==0&&Jr<140&&e<32){let i=e<16?nu(e):Lo(e);if(i!=null)return i}return To(e);case 4:if(e>=bn)throw new Error(`Array length exceeds ${bn}`);let n=new Array(e);for(let i=0;i<e;i++)n[i]=me();return n;case 5:if(e>=wr)throw new Error(`Map size exceeds ${bn}`);if(de.mapsAsObjects){let i={};if(de.keyMap)for(let a=0;a<e;a++)i[ar(de.decodeKey(me()))]=me();else for(let a=0;a<e;a++)i[ar(me())]=me();return i}else{Fn&&(de.mapsAsObjects=!0,Fn=!1);let i=new Map;if(de.keyMap)for(let a=0;a<e;a++)i.set(de.decodeKey(me()),me());else for(let a=0;a<e;a++)i.set(me(),me());return i}case 6:if(e>=aa){let i=Be[e&8191];if(i)return i.read||(i.read=ri(i)),i.read();if(e<65536){if(e==No){let a=tn(),u=me(),s=me();ti(u,s);let o={};if(de.keyMap)for(let f=2;f<a;f++){let c=de.decodeKey(s[f-2]);o[ar(c)]=me()}else for(let f=2;f<a;f++){let c=s[f-2];o[ar(c)]=me()}return o}else if(e==Po){let a=tn(),u=me();for(let s=2;s<a;s++)ti(u++,me());return me()}else if(e==aa)return Ho();if(de.getShared&&(yi(),i=Be[e&8191],i))return i.read||(i.read=ri(i)),i.read()}}let t=Ie[e];if(t)return t.handlesRead?t(me):t(me());{let i=me();for(let a=0;a<ei.length;a++){let u=ei[a](e,i);if(u!==void 0)return u}return new Er(i,e)}case 7:switch(e){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let i=(Ze||Gr())[e];if(i!==void 0)return i;throw new Error("Unknown token "+e)}default:if(isNaN(e)){let i=new Error("Unexpected end of CBOR data");throw i.incomplete=!0,i}throw new Error("Unknown CBOR token "+e)}}var sa=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function ri(e){if(!e)throw new Error("Structure is required in record definition");function r(){let n=ee[I++];if(n=n&31,n>23)switch(n){case 24:n=ee[I++];break;case 25:n=We.getUint16(I),I+=2;break;case 26:n=We.getUint32(I),I+=4;break;default:throw new Error("Expected array header, but got "+ee[I-1])}let t=this.compiledReader;for(;t;){if(t.propertyCount===n)return t(me);t=t.next}if(this.slowReads++>=ru){let a=this.length==n?this:this.slice(0,n);return t=de.keyMap?new Function("r","return {"+a.map(u=>de.decodeKey(u)).map(u=>sa.test(u)?ar(u)+":r()":"["+JSON.stringify(u)+"]:r()").join(",")+"}"):new Function("r","return {"+a.map(u=>sa.test(u)?ar(u)+":r()":"["+JSON.stringify(u)+"]:r()").join(",")+"}"),this.compiledReader&&(t.next=this.compiledReader),t.propertyCount=n,this.compiledReader=t,t(me)}let i={};if(de.keyMap)for(let a=0;a<n;a++)i[ar(de.decodeKey(this[a]))]=me();else for(let a=0;a<n;a++)i[ar(this[a])]=me();return i}return e.slowReads=0,r}function ar(e){if(typeof e=="string")return e==="__proto__"?"__proto_":e;if(typeof e=="number"||typeof e=="boolean"||typeof e=="bigint")return e.toString();if(e==null)return e+"";throw new Error("Invalid property name type "+typeof e)}var To=ni;function ni(e){let r;if(e<16&&(r=nu(e)))return r;if(e>64&&Zt)return Zt.decode(ee.subarray(I,I+=e));let n=I+e,t=[];for(r="";I<n;){let i=ee[I++];if((i&128)===0)t.push(i);else if((i&224)===192){let a=ee[I++]&63;t.push((i&31)<<6|a)}else if((i&240)===224){let a=ee[I++]&63,u=ee[I++]&63;t.push((i&31)<<12|a<<6|u)}else if((i&248)===240){let a=ee[I++]&63,u=ee[I++]&63,s=ee[I++]&63,o=(i&7)<<18|a<<12|u<<6|s;o>65535&&(o-=65536,t.push(o>>>10&1023|55296),o=56320|o&1023),t.push(o)}else t.push(i);t.length>=4096&&(r+=Me.apply(String,t),t.length=0)}return t.length>0&&(r+=Me.apply(String,t)),r}var Me=String.fromCharCode;function Lo(e){let r=I,n=new Array(e);for(let t=0;t<e;t++){let i=ee[I++];if((i&128)>0){I=r;return}n[t]=i}return Me.apply(String,n)}function nu(e){if(e<4)if(e<2){if(e===0)return"";{let r=ee[I++];if((r&128)>1){I-=1;return}return Me(r)}}else{let r=ee[I++],n=ee[I++];if((r&128)>0||(n&128)>0){I-=2;return}if(e<3)return Me(r,n);let t=ee[I++];if((t&128)>0){I-=3;return}return Me(r,n,t)}else{let r=ee[I++],n=ee[I++],t=ee[I++],i=ee[I++];if((r&128)>0||(n&128)>0||(t&128)>0||(i&128)>0){I-=4;return}if(e<6){if(e===4)return Me(r,n,t,i);{let a=ee[I++];if((a&128)>0){I-=5;return}return Me(r,n,t,i,a)}}else if(e<8){let a=ee[I++],u=ee[I++];if((a&128)>0||(u&128)>0){I-=6;return}if(e<7)return Me(r,n,t,i,a,u);let s=ee[I++];if((s&128)>0){I-=7;return}return Me(r,n,t,i,a,u,s)}else{let a=ee[I++],u=ee[I++],s=ee[I++],o=ee[I++];if((a&128)>0||(u&128)>0||(s&128)>0||(o&128)>0){I-=8;return}if(e<10){if(e===8)return Me(r,n,t,i,a,u,s,o);{let f=ee[I++];if((f&128)>0){I-=9;return}return Me(r,n,t,i,a,u,s,o,f)}}else if(e<12){let f=ee[I++],c=ee[I++];if((f&128)>0||(c&128)>0){I-=10;return}if(e<11)return Me(r,n,t,i,a,u,s,o,f,c);let _=ee[I++];if((_&128)>0){I-=11;return}return Me(r,n,t,i,a,u,s,o,f,c,_)}else{let f=ee[I++],c=ee[I++],_=ee[I++],m=ee[I++];if((f&128)>0||(c&128)>0||(_&128)>0||(m&128)>0){I-=12;return}if(e<14){if(e===12)return Me(r,n,t,i,a,u,s,o,f,c,_,m);{let k=ee[I++];if((k&128)>0){I-=13;return}return Me(r,n,t,i,a,u,s,o,f,c,_,m,k)}}else{let k=ee[I++],L=ee[I++];if((k&128)>0||(L&128)>0){I-=14;return}if(e<15)return Me(r,n,t,i,a,u,s,o,f,c,_,m,k,L);let b=ee[I++];if((b&128)>0){I-=15;return}return Me(r,n,t,i,a,u,s,o,f,c,_,m,k,L,b)}}}}}function Mo(e){return de.copyBuffers?Uint8Array.prototype.slice.call(ee,I,I+=e):ee.subarray(I,I+=e)}var tu=new Float32Array(1),qn=new Uint8Array(tu.buffer,0,4);function Ro(){let e=ee[I++],r=ee[I++],n=(e&127)>>2;if(n===31)return r||e&3?NaN:e&128?-1/0:1/0;if(n===0){let t=((e&3)<<8|r)/16777216;return e&128?-t:t}return qn[3]=e&128|(n>>1)+56,qn[2]=(e&7)<<5|r>>3,qn[1]=r<<5,qn[0]=0,tu[0]}new Array(4096);var Er=class{constructor(r,n){this.value=r,this.tag=n}};Ie[0]=e=>new Date(e);Ie[1]=e=>new Date(Math.round(e*1e3));Ie[2]=e=>{let r=BigInt(0);for(let n=0,t=e.byteLength;n<t;n++)r=BigInt(e[n])+(r<<BigInt(8));return r};Ie[3]=e=>BigInt(-1)-Ie[2](e);Ie[4]=e=>+(e[1]+"e"+e[0]);Ie[5]=e=>e[1]*Math.exp(e[0]*Math.log(2));var ti=(e,r)=>{e=e-57344;let n=Be[e];n&&n.isShared&&((Be.restoreStructures||(Be.restoreStructures=[]))[e]=n),Be[e]=r,r.read=ri(r)};Ie[Io]=e=>{let r=e.length,n=e[1];ti(e[0],n);let t={};for(let i=2;i<r;i++){let a=n[i-2];t[ar(a)]=e[i]}return t};Ie[14]=e=>Le?Le[0].slice(Le.position0,Le.position0+=e):new Er(e,14);Ie[15]=e=>Le?Le[1].slice(Le.position1,Le.position1+=e):new Er(e,15);var qo={Error,RegExp};Ie[27]=e=>(qo[e[0]]||Error)(e[1],e[2]);var iu=e=>{if(ee[I++]!=132){let n=new Error("Packed values structure must be followed by a 4 element array");throw ee.length<I&&(n.incomplete=!0),n}let r=e();if(!r||!r.length){let n=new Error("Packed values structure must be followed by a 4 element array");throw n.incomplete=!0,n}return Ze=Ze?r.concat(Ze.slice(r.length)):r,Ze.prefixes=e(),Ze.suffixes=e(),e()};iu.handlesRead=!0;Ie[51]=iu;Ie[ua]=e=>{if(!Ze)if(de.getShared)yi();else return new Er(e,ua);if(typeof e=="number")return Ze[16+(e>=0?2*e:-2*e-1)];let r=new Error("No support for non-integer packed references yet");throw e===void 0&&(r.incomplete=!0),r};Ie[28]=e=>{ir||(ir=new Map,ir.id=0);let r=ir.id++,n=I,t=ee[I],i;t>>5==4?i=[]:i={};let a={target:i};ir.set(r,a);let u=e();return a.used?(Object.getPrototypeOf(i)!==Object.getPrototypeOf(u)&&(I=n,i=u,ir.set(r,{target:i}),u=e()),Object.assign(i,u)):(a.target=u,u)};Ie[28].handlesRead=!0;Ie[29]=e=>{let r=ir.get(e);return r.used=!0,r.target};Ie[258]=e=>new Set(e);(Ie[259]=e=>(de.mapsAsObjects&&(de.mapsAsObjects=!1,Fn=!0),e())).handlesRead=!0;function en(e,r){return typeof e=="string"?e+r:e instanceof Array?e.concat(r):Object.assign({},e,r)}function Gr(){if(!Ze)if(de.getShared)yi();else throw new Error("No packed values available");return Ze}var Uo=1399353956;ei.push((e,r)=>{if(e>=225&&e<=255)return en(Gr().prefixes[e-224],r);if(e>=28704&&e<=32767)return en(Gr().prefixes[e-28672],r);if(e>=1879052288&&e<=2147483647)return en(Gr().prefixes[e-1879048192],r);if(e>=216&&e<=223)return en(r,Gr().suffixes[e-216]);if(e>=27647&&e<=28671)return en(r,Gr().suffixes[e-27639]);if(e>=1811940352&&e<=1879048191)return en(r,Gr().suffixes[e-1811939328]);if(e==Uo)return{packedValues:Ze,structures:Be.slice(0),version:r};if(e==55799)return r});var zo=new Uint8Array(new Uint16Array([1]).buffer)[0]==1,ca=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],$o=[64,68,69,70,71,72,77,78,79,85,86];for(let e=0;e<ca.length;e++)Vo(ca[e],$o[e]);function Vo(e,r){let n="get"+e.name.slice(0,-5),t;typeof e=="function"?t=e.BYTES_PER_ELEMENT:e=null;for(let i=0;i<2;i++){if(!i&&t==1)continue;let a=t==2?1:t==4?2:t==8?3:0;Ie[i?r:r-4]=t==1||i==zo?u=>{if(!e)throw new Error("Could not find typed array for code "+r);return!de.copyBuffers&&(t===1||t===2&&!(u.byteOffset&1)||t===4&&!(u.byteOffset&3)||t===8&&!(u.byteOffset&7))?new e(u.buffer,u.byteOffset,u.byteLength>>a):new e(Uint8Array.prototype.slice.call(u,0).buffer)}:u=>{if(!e)throw new Error("Could not find typed array for code "+r);let s=new DataView(u.buffer,u.byteOffset,u.byteLength),o=u.length>>a,f=new e(o),c=s[n];for(let _=0;_<o;_++)f[_]=c.call(s,_<<a,i);return f}}}function Ho(){let e=tn(),r=I+me();for(let t=2;t<e;t++){let i=tn();I+=i}let n=I;return I=r,Le=[ni(tn()),ni(tn())],Le.position0=0,Le.position1=0,Le.postBundlePosition=I,I=n,me()}function tn(){let e=ee[I++]&31;if(e>23)switch(e){case 24:e=ee[I++];break;case 25:e=We.getUint16(I),I+=2;break;case 26:e=We.getUint32(I),I+=4;break}return e}function yi(){if(de.getShared){let e=au(()=>(ee=null,de.getShared()))||{},r=e.structures||[];de.sharedVersion=e.version,Ze=de.sharedValues=e.packedValues,Be===!0?de.structures=Be=r:Be.splice.apply(Be,[0,r.length].concat(r))}}function au(e){let r=Jr,n=I,t=ct,i=jn,a=st,u=ir,s=Le,o=new Uint8Array(ee.slice(0,Jr)),f=Be,c=de,_=In,m=e();return Jr=r,I=n,ct=t,jn=i,st=a,ir=u,Le=s,ee=o,In=_,Be=f,de=c,We=new DataView(ee.buffer,ee.byteOffset,ee.byteLength),m}function ii(){ee=null,ir=null,Be=null}function Yo(e){Ie[e.tag]=e.decode}var gi=new Array(147);for(let e=0;e<256;e++)gi[e]=+("1e"+Math.floor(45.15-e*.30103));var bi=new ft({useRecords:!1});bi.decode;bi.decodeMultiple;var Kn;try{Kn=new TextEncoder}catch{}var lt,wi,Dt=typeof globalThis=="object"&&globalThis.Buffer,Nn=typeof Dt<"u",Rt=Nn?Dt.allocUnsafeSlow:Uint8Array,fa=Nn?Dt:Uint8Array,la=256,_a=Nn?4294967296:2144337920,qt,w,Ee,d=0,jr,Ne=null,Go=61440,Wo=/[\u0080-\uFFFF]/,rr=Symbol("record-id"),_t=class extends ft{constructor(r){super(r),this.offset=0;let n,t,i,a,u;r=r||{};let s=fa.prototype.utf8Write?function(y,N,P){return w.utf8Write(y,N,P)}:Kn&&Kn.encodeInto?function(y,N){return Kn.encodeInto(y,w.subarray(N)).written}:!1,o=this,f=r.structures||r.saveStructures,c=r.maxSharedStructures;if(c==null&&(c=f?128:0),c>8190)throw new Error("Maximum maxSharedStructure is 8190");let _=r.sequential;_&&(c=0),this.structures||(this.structures=[]),this.saveStructures&&(this.saveShared=this.saveStructures);let m,k,L=r.sharedValues,b;if(L){b=Object.create(null);for(let y=0,N=L.length;y<N;y++)b[L[y]]=y}let g=[],h=0,v=0;this.mapEncode=function(y,N){if(this._keyMap&&!this._mapped)switch(y.constructor.name){case"Array":y=y.map(P=>this.encodeKeys(P));break}return this.encode(y,N)},this.encode=function(y,N){if(w||(w=new Rt(8192),Ee=new DataView(w.buffer,0,8192),d=0),jr=w.length-10,jr-d<2048?(w=new Rt(w.length),Ee=new DataView(w.buffer,0,w.length),jr=w.length-10,d=0):N===ma&&(d=d+7&2147483640),n=d,o.useSelfDescribedHeader&&(Ee.setUint32(d,3654940416),d+=3),u=o.structuredClone?new Map:null,o.bundleStrings&&typeof y!="string"?(Ne=[],Ne.size=1/0):Ne=null,t=o.structures,t){if(t.uninitialized){let R=o.getShared()||{};o.structures=t=R.structures||[],o.sharedVersion=R.version;let T=o.sharedValues=R.packedValues;if(T){b={};for(let X=0,j=T.length;X<j;X++)b[T[X]]=X}}let P=t.length;if(P>c&&!_&&(P=c),!t.transitions){t.transitions=Object.create(null);for(let R=0;R<P;R++){let T=t[R];if(!T)continue;let X,j=t.transitions;for(let D=0,F=T.length;D<F;D++){j[rr]===void 0&&(j[rr]=R);let z=T[D];X=j[z],X||(X=j[z]=Object.create(null)),j=X}j[rr]=R|1048576}}_||(t.nextId=P)}if(i&&(i=!1),a=t||[],k=b,r.pack){let P=new Map;if(P.values=[],P.encoder=o,P.maxValues=r.maxPrivatePackedValues||(b?16:1/0),P.objectMap=b||!1,P.samplingPackedValues=m,Jn(y,P),P.values.length>0){w[d++]=216,w[d++]=51,hr(4);let R=P.values;p(R),hr(0),hr(0),k=Object.create(b||null);for(let T=0,X=R.length;T<X;T++)k[R[T]]=T}}qt=N&zt;try{if(qt)return;if(p(y),Ne&&pa(n,p),o.offset=d,u&&u.idsToInsert){d+=u.idsToInsert.length*2,d>jr&&O(d),o.offset=d;let P=Xo(w.subarray(n,d),u.idsToInsert);return u=null,P}return N&ma?(w.start=n,w.end=d,w):w.subarray(n,d)}finally{if(t){if(v<10&&v++,t.length>c&&(t.length=c),h>1e4)t.transitions=null,v=0,h=0,g.length>0&&(g=[]);else if(g.length>0&&!_){for(let P=0,R=g.length;P<R;P++)g[P][rr]=void 0;g=[]}}if(i&&o.saveShared){o.structures.length>c&&(o.structures=o.structures.slice(0,c));let P=w.subarray(n,d);return o.updateSharedData()===!1?o.encode(y):P}N&Qo&&(d=n)}},this.findCommonStringsToPack=()=>(m=new Map,b||(b=Object.create(null)),y=>{let N=y&&y.threshold||4,P=this.pack?y.maxPrivatePackedValues||16:0;L||(L=this.sharedValues=[]);for(let[R,T]of m)T.count>N&&(b[R]=P++,L.push(R),i=!0);for(;this.saveShared&&this.updateSharedData()===!1;);m=null});let p=y=>{d>jr&&(w=O(d));var N=typeof y,P;if(N==="string"){if(k){let j=k[y];if(j>=0){j<16?w[d++]=j+224:(w[d++]=198,j&1?p(15-j>>1):p(j-16>>1));return}else if(m&&!r.pack){let D=m.get(y);D?D.count++:m.set(y,{count:1})}}let R=y.length;if(Ne&&R>=4&&R<1024){if((Ne.size+=R)>Go){let D,F=(Ne[0]?Ne[0].length*3+Ne[1].length:0)+10;d+F>jr&&(w=O(d+F)),w[d++]=217,w[d++]=223,w[d++]=249,w[d++]=Ne.position?132:130,w[d++]=26,D=d-n,d+=4,Ne.position&&pa(n,p),Ne=["",""],Ne.size=0,Ne.position=D}let j=Wo.test(y);Ne[j?0:1]+=y,w[d++]=j?206:207,p(R);return}let T;R<32?T=1:R<256?T=2:R<65536?T=3:T=5;let X=R*3;if(d+X>jr&&(w=O(d+X)),R<64||!s){let j,D,F,z=d+T;for(j=0;j<R;j++)D=y.charCodeAt(j),D<128?w[z++]=D:D<2048?(w[z++]=D>>6|192,w[z++]=D&63|128):(D&64512)===55296&&((F=y.charCodeAt(j+1))&64512)===56320?(D=65536+((D&1023)<<10)+(F&1023),j++,w[z++]=D>>18|240,w[z++]=D>>12&63|128,w[z++]=D>>6&63|128,w[z++]=D&63|128):(w[z++]=D>>12|224,w[z++]=D>>6&63|128,w[z++]=D&63|128);P=z-d-T}else P=s(y,d+T,X);P<24?w[d++]=96|P:P<256?(T<2&&w.copyWithin(d+2,d+1,d+1+P),w[d++]=120,w[d++]=P):P<65536?(T<3&&w.copyWithin(d+3,d+2,d+2+P),w[d++]=121,w[d++]=P>>8,w[d++]=P&255):(T<5&&w.copyWithin(d+5,d+3,d+3+P),w[d++]=122,Ee.setUint32(d,P),d+=4),d+=P}else if(N==="number")if(!this.alwaysUseFloat&&y>>>0===y)y<24?w[d++]=y:y<256?(w[d++]=24,w[d++]=y):y<65536?(w[d++]=25,w[d++]=y>>8,w[d++]=y&255):(w[d++]=26,Ee.setUint32(d,y),d+=4);else if(!this.alwaysUseFloat&&y>>0===y)y>=-24?w[d++]=31-y:y>=-256?(w[d++]=56,w[d++]=~y):y>=-65536?(w[d++]=57,Ee.setUint16(d,~y),d+=2):(w[d++]=58,Ee.setUint32(d,~y),d+=4);else{let R;if((R=this.useFloat32)>0&&y<4294967296&&y>=-2147483648){w[d++]=250,Ee.setFloat32(d,y);let T;if(R<4||(T=y*gi[(w[d]&127)<<1|w[d+1]>>7])>>0===T){d+=4;return}else d--}w[d++]=251,Ee.setFloat64(d,y),d+=8}else if(N==="object")if(!y)w[d++]=246;else{if(u){let T=u.get(y);if(T){if(w[d++]=216,w[d++]=29,w[d++]=25,!T.references){let X=u.idsToInsert||(u.idsToInsert=[]);T.references=[],X.push(T)}T.references.push(d-n),d+=2;return}else u.set(y,{offset:d-n})}let R=y.constructor;if(R===Object)A(y);else if(R===Array){P=y.length,P<24?w[d++]=128|P:hr(P);for(let T=0;T<P;T++)p(y[T])}else if(R===Map)if((this.mapsAsObjects?this.useTag259ForMaps!==!1:this.useTag259ForMaps)&&(w[d++]=217,w[d++]=1,w[d++]=3),P=y.size,P<24?w[d++]=160|P:P<256?(w[d++]=184,w[d++]=P):P<65536?(w[d++]=185,w[d++]=P>>8,w[d++]=P&255):(w[d++]=186,Ee.setUint32(d,P),d+=4),o.keyMap)for(let[T,X]of y)p(o.encodeKey(T)),p(X);else for(let[T,X]of y)p(T),p(X);else{for(let T=0,X=lt.length;T<X;T++){let j=wi[T];if(y instanceof j){let D=lt[T],F=D.tag;F==null&&(F=D.getTag&&D.getTag.call(this,y)),F<24?w[d++]=192|F:F<256?(w[d++]=216,w[d++]=F):F<65536?(w[d++]=217,w[d++]=F>>8,w[d++]=F&255):F>-1&&(w[d++]=218,Ee.setUint32(d,F),d+=4),D.encode.call(this,y,p,O);return}}if(y[Symbol.iterator]){if(qt){let T=new Error("Iterable should be serialized as iterator");throw T.iteratorNotHandled=!0,T}w[d++]=159;for(let T of y)p(T);w[d++]=255;return}if(y[Symbol.asyncIterator]||Ut(y)){let T=new Error("Iterable/blob should be serialized as iterator");throw T.iteratorNotHandled=!0,T}if(this.useToJSON&&y.toJSON){let T=y.toJSON();if(T!==y)return p(T)}A(y)}}else if(N==="boolean")w[d++]=y?245:244;else if(N==="bigint"){if(y<BigInt(1)<<BigInt(64)&&y>=0)w[d++]=27,Ee.setBigUint64(d,y);else if(y>-(BigInt(1)<<BigInt(64))&&y<0)w[d++]=59,Ee.setBigUint64(d,-y-BigInt(1));else if(this.largeBigIntToFloat)w[d++]=251,Ee.setFloat64(d,Number(y));else{y>=BigInt(0)?w[d++]=194:(w[d++]=195,y=BigInt(-1)-y);let R=[];for(;y;)R.push(Number(y&BigInt(255))),y>>=BigInt(8);ai(new Uint8Array(R.reverse()),O);return}d+=8}else if(N==="undefined")w[d++]=247;else throw new Error("Unknown type: "+N)},A=this.useRecords===!1?this.variableMapSize?y=>{let N=Object.keys(y),P=Object.values(y),R=N.length;if(R<24?w[d++]=160|R:R<256?(w[d++]=184,w[d++]=R):R<65536?(w[d++]=185,w[d++]=R>>8,w[d++]=R&255):(w[d++]=186,Ee.setUint32(d,R),d+=4),o.keyMap)for(let T=0;T<R;T++)p(o.encodeKey(N[T])),p(P[T]);else for(let T=0;T<R;T++)p(N[T]),p(P[T])}:y=>{w[d++]=185;let N=d-n;d+=2;let P=0;if(o.keyMap)for(let R in y)(typeof y.hasOwnProperty!="function"||y.hasOwnProperty(R))&&(p(o.encodeKey(R)),p(y[R]),P++);else for(let R in y)(typeof y.hasOwnProperty!="function"||y.hasOwnProperty(R))&&(p(R),p(y[R]),P++);w[N+++n]=P>>8,w[N+n]=P&255}:(y,N)=>{let P,R=a.transitions||(a.transitions=Object.create(null)),T=0,X=0,j,D;if(this.keyMap){D=Object.keys(y).map(z=>this.encodeKey(z)),X=D.length;for(let z=0;z<X;z++){let re=D[z];P=R[re],P||(P=R[re]=Object.create(null),T++),R=P}}else for(let z in y)(typeof y.hasOwnProperty!="function"||y.hasOwnProperty(z))&&(P=R[z],P||(R[rr]&1048576&&(j=R[rr]&65535),P=R[z]=Object.create(null),T++),R=P,X++);let F=R[rr];if(F!==void 0)F&=65535,w[d++]=217,w[d++]=F>>8|224,w[d++]=F&255;else if(D||(D=R.__keys__||(R.__keys__=Object.keys(y))),j===void 0?(F=a.nextId++,F||(F=0,a.nextId=1),F>=la&&(a.nextId=(F=c)+1)):F=j,a[F]=D,F<c){w[d++]=217,w[d++]=F>>8|224,w[d++]=F&255,R=a.transitions;for(let z=0;z<X;z++)(R[rr]===void 0||R[rr]&1048576)&&(R[rr]=F),R=R[D[z]];R[rr]=F|1048576,i=!0}else{if(R[rr]=F,Ee.setUint32(d,3655335680),d+=3,T&&(h+=v*T),g.length>=la-c&&(g.shift()[rr]=void 0),g.push(R),hr(X+2),p(57344+F),p(D),N)return;for(let z in y)(typeof y.hasOwnProperty!="function"||y.hasOwnProperty(z))&&p(y[z]);return}if(X<24?w[d++]=128|X:hr(X),!N)for(let z in y)(typeof y.hasOwnProperty!="function"||y.hasOwnProperty(z))&&p(y[z])},O=y=>{let N;if(y>16777216){if(y-n>_a)throw new Error("Encoded buffer would be larger than maximum buffer size");N=Math.min(_a,Math.round(Math.max((y-n)*(y>67108864?1.25:2),4194304)/4096)*4096)}else N=(Math.max(y-n<<2,w.length-1)>>12)+1<<12;let P=new Rt(N);return Ee=new DataView(P.buffer,0,N),w.copy?w.copy(P,0,n,y):P.set(w.slice(n,y)),d-=n,n=0,jr=P.length-10,w=P},S=100,V=1e3;this.encodeAsIterable=function(y,N){return W(y,N,K)},this.encodeAsAsyncIterable=function(y,N){return W(y,N,ce)};function*K(y,N,P){let R=y.constructor;if(R===Object){let T=o.useRecords!==!1;T?A(y,!0):ha(Object.keys(y).length,160);for(let X in y){let j=y[X];T||p(X),j&&typeof j=="object"?N[X]?yield*K(j,N[X]):yield*G(j,N,X):p(j)}}else if(R===Array){let T=y.length;hr(T);for(let X=0;X<T;X++){let j=y[X];j&&(typeof j=="object"||d-n>S)?N.element?yield*K(j,N.element):yield*G(j,N,"element"):p(j)}}else if(y[Symbol.iterator]&&!y.buffer){w[d++]=159;for(let T of y)T&&(typeof T=="object"||d-n>S)?N.element?yield*K(T,N.element):yield*G(T,N,"element"):p(T);w[d++]=255}else Ut(y)?(ha(y.size,64),yield w.subarray(n,d),yield y,M()):y[Symbol.asyncIterator]?(w[d++]=159,yield w.subarray(n,d),yield y,M(),w[d++]=255):p(y);P&&d>n?yield w.subarray(n,d):d-n>S&&(yield w.subarray(n,d),M())}function*G(y,N,P){let R=d-n;try{p(y),d-n>S&&(yield w.subarray(n,d),M())}catch(T){if(T.iteratorNotHandled)N[P]={},d=n+R,yield*K.call(this,y,N[P]);else throw T}}function M(){S=V,o.encode(null,zt)}function W(y,N,P){return N&&N.chunkThreshold?S=V=N.chunkThreshold:S=100,y&&typeof y=="object"?(o.encode(null,zt),P(y,o.iterateProperties||(o.iterateProperties={}),!0)):[o.encode(y)]}async function*ce(y,N){for(let P of K(y,N,!0)){let R=P.constructor;if(R===fa||R===Uint8Array)yield P;else if(Ut(P)){let T=P.stream().getReader(),X;for(;!(X=await T.read()).done;)yield X.value}else if(P[Symbol.asyncIterator])for await(let T of P)M(),T?yield*ce(T,N.async||(N.async={})):yield o.encode(T);else yield P}}}useBuffer(r){w=r,Ee=new DataView(w.buffer,w.byteOffset,w.byteLength),d=0}clearSharedData(){this.structures&&(this.structures=[]),this.sharedValues&&(this.sharedValues=void 0)}updateSharedData(){let r=this.sharedVersion||0;this.sharedVersion=r+1;let n=this.structures.slice(0),t=new ht(n,this.sharedValues,this.sharedVersion),i=this.saveShared(t,a=>(a&&a.version||0)==r);return i===!1?(t=this.getShared()||{},this.structures=t.structures||[],this.sharedValues=t.packedValues,this.sharedVersion=t.version,this.structures.nextId=this.structures.length):n.forEach((a,u)=>this.structures[u]=a),i}};function ha(e,r){e<24?w[d++]=r|e:e<256?(w[d++]=r|24,w[d++]=e):e<65536?(w[d++]=r|25,w[d++]=e>>8,w[d++]=e&255):(w[d++]=r|26,Ee.setUint32(d,e),d+=4)}var ht=class{constructor(r,n,t){this.structures=r,this.packedValues=n,this.version=t}};function hr(e){e<24?w[d++]=128|e:e<256?(w[d++]=152,w[d++]=e):e<65536?(w[d++]=153,w[d++]=e>>8,w[d++]=e&255):(w[d++]=154,Ee.setUint32(d,e),d+=4)}var Ko=typeof Blob>"u"?function(){}:Blob;function Ut(e){if(e instanceof Ko)return!0;let r=e[Symbol.toStringTag];return r==="Blob"||r==="File"}function Jn(e,r){switch(typeof e){case"string":if(e.length>3){if(r.objectMap[e]>-1||r.values.length>=r.maxValues)return;let t=r.get(e);if(t)++t.count==2&&r.values.push(e);else if(r.set(e,{count:1}),r.samplingPackedValues){let i=r.samplingPackedValues.get(e);i?i.count++:r.samplingPackedValues.set(e,{count:1})}}break;case"object":if(e)if(e instanceof Array)for(let t=0,i=e.length;t<i;t++)Jn(e[t],r);else{let t=!r.encoder.useRecords;for(var n in e)e.hasOwnProperty(n)&&(t&&Jn(n,r),Jn(e[n],r))}break;case"function":console.log(e)}}var Jo=new Uint8Array(new Uint16Array([1]).buffer)[0]==1;wi=[Date,Set,Error,RegExp,Er,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?function(){}:BigInt64Array,Float32Array,Float64Array,ht];lt=[{tag:1,encode(e,r){let n=e.getTime()/1e3;(this.useTimestamp32||e.getMilliseconds()===0)&&n>=0&&n<4294967296?(w[d++]=26,Ee.setUint32(d,n),d+=4):(w[d++]=251,Ee.setFloat64(d,n),d+=8)}},{tag:258,encode(e,r){let n=Array.from(e);r(n)}},{tag:27,encode(e,r){r([e.name,e.message])}},{tag:27,encode(e,r){r(["RegExp",e.source,e.flags])}},{getTag(e){return e.tag},encode(e,r){r(e.value)}},{encode(e,r,n){ai(e,n)}},{getTag(e){if(e.constructor===Uint8Array&&(this.tagUint8Array||Nn&&this.tagUint8Array!==!1))return 64},encode(e,r,n){ai(e,n)}},_r(68,1),_r(69,2),_r(70,4),_r(71,8),_r(72,1),_r(77,2),_r(78,4),_r(79,8),_r(85,4),_r(86,8),{encode(e,r){let n=e.packedValues||[],t=e.structures||[];if(n.values.length>0){w[d++]=216,w[d++]=51,hr(4);let i=n.values;r(i),hr(0),hr(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let a=0,u=i.length;a<u;a++)packedObjectMap[i[a]]=a}if(t){Ee.setUint32(d,3655335424),d+=3;let i=t.slice(0);i.unshift(57344),i.push(new Er(e.version,1399353956)),r(i)}else r(new Er(e.version,1399353956))}}];function _r(e,r){return!Jo&&r>1&&(e-=4),{tag:e,encode:function(t,i){let a=t.byteLength,u=t.byteOffset||0,s=t.buffer||t;i(Nn?Dt.from(s,u,a):new Uint8Array(s,u,a))}}}function ai(e,r){let n=e.byteLength;n<24?w[d++]=64+n:n<256?(w[d++]=88,w[d++]=n):n<65536?(w[d++]=89,w[d++]=n>>8,w[d++]=n&255):(w[d++]=90,Ee.setUint32(d,n),d+=4),d+n>=w.length&&r(d+n),w.set(e.buffer?e:new Uint8Array(e),d),d+=n}function Xo(e,r){let n,t=r.length*2,i=e.length-t;r.sort((a,u)=>a.offset>u.offset?1:-1);for(let a=0;a<r.length;a++){let u=r[a];u.id=a;for(let s of u.references)e[s++]=a>>8,e[s]=a&255}for(;n=r.pop();){let a=n.offset;e.copyWithin(a+t,a,i),t-=2;let u=a+t;e[u++]=216,e[u++]=28,i=a}return e}function pa(e,r){Ee.setUint32(Ne.position+e,d-Ne.position-e+1);let n=Ne;Ne=null,r(n[0]),r(n[1])}function da(e){if(e.Class){if(!e.encode)throw new Error("Extension has no encode function");wi.unshift(e.Class),lt.unshift(e)}Yo(e)}var Di=new _t({useRecords:!1});Di.encode;Di.encodeAsIterable;Di.encodeAsAsyncIterable;var ma=512,Qo=1024,zt=2048,wn={};var va;function Zo(){if(va)return wn;va=1,Object.defineProperty(wn,"__esModule",{value:!0});let e=8,r=6,n=3,t=(1<<r)+(n-1),i=(1<<16-r)-1,a=256;function u(g,h){var v=0,p=0,A=0,O=0,S=0,V=1<<e-1,K=0,G=0,M=0,W=new Int32Array(a),ce=0;for(ce=0;ce<a;ce++)W[ce]=-858993460;for(v=g.length;p<v;){if((V<<=1)==1<<e&&(V=1,S=A,h[A++]=0),p>v-t){h[A++]=g[p++];continue}if(M=(g[p]+13^g[p+1]-13^g[p+2])&a-1,G=p-W[M]&i,W[M]=p,O=p-G,O>=0&&O!=p&&g[p]==g[O]&&g[p+1]==g[O+1]&&g[p+2]==g[O+2]){for(h[S]|=V,K=n;K<t&&g[p+K]==g[O+K];K++);h[A++]=K-n<<e-r|G>>e,h[A++]=G,p+=K}else h[A++]=g[p++]}return console.assert(g.length>=p),A}function s(g,h,v){h=h|0;for(var p=0,A=0,O=0,S=0,V=1<<(e-1|0),K=0,G=0;p<h;)if((V<<=1)===1<<e&&(V=1,S=g[p],p=p+1|0),S&V){K=(g[p]>>(e-r|0))+n|0,G=(g[p]<<e|g[p+1|0])&i,p=p+2|0,O=A-G|0;{for(;K>4;)v[A]=v[O],A=A+1|0,O=O+1|0,v[A]=v[O],A=A+1|0,O=O+1|0,v[A]=v[O],A=A+1|0,O=O+1|0,v[A]=v[O],A=A+1|0,O=O+1|0,K=K-4|0;for(;K>0;)v[A]=v[O],A=A+1|0,O=O+1|0,K=K-1|0}}else v[A]=g[p],A=A+1|0,p=p+1|0;return A}function o(){return new TextEncoder("utf-8").encode(f)}let f="@lzjb",c=o();function _(...g){if(g.length>1){let h=g.reduce((A,O)=>A+O.length,0),v=new Uint8Array(h),p=0;return g.forEach(A=>{v.set(A,p),p+=A.length}),v}else if(g.length)return g[0]}function m(g){let h=Math.ceil(Math.log2(g)/8),v=new Uint8Array(h);for(let p=0;p<v.length;p++){let A=g&255;v[p]=A,g=(g-A)/256}return v}function k(g){let h=0;for(let v=g.length-1;v>=0;v--)h=h*256+g[v];return h}function L(g,{magic:h=!0}={}){let v=new Uint8Array(Math.max(g.length*1.5|0,16384)),p=u(g,v),A=m(g.length),O=[Uint8Array.of(A.length),A,v.slice(0,p)];return h&&O.unshift(c),_(...O)}function b(g,{magic:h=!0}={}){if(h&&new TextDecoder("utf-8").decode(g.slice(0,c.length))!==f)throw new Error("Invalid magic value");let v=h?c.length:0,p=g[v],A=v+1,O=v+p+1,S=k(g.slice(A,O));g=g.slice(O);let V=new Uint8Array(S);return s(g,g.length,V),V}return wn.pack=L,wn.unpack=b,wn}var uu=Zo();function es(e,r){return r=r||{},new Promise(function(n,t){var i=new XMLHttpRequest,a=[],u={},s=function f(){return{ok:(i.status/100|0)==2,statusText:i.statusText,status:i.status,url:i.responseURL,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(i.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([i.response]))},clone:f,headers:{keys:function(){return a},entries:function(){return a.map(function(c){return[c,i.getResponseHeader(c)]})},get:function(c){return i.getResponseHeader(c)},has:function(c){return i.getResponseHeader(c)!=null}}}};for(var o in i.open(r.method||"get",e,!0),i.onload=function(){i.getAllResponseHeaders().toLowerCase().replace(/^(.+?):/gm,function(f,c){u[c]||a.push(u[c]=c)}),n(s())},i.onerror=t,i.withCredentials=r.credentials=="include",r.headers)i.setRequestHeader(o,r.headers[o]);i.send(r.body||null)})}var rs=["token"],ns=["env"],ts=["stderr","stdin","stdout","command_line"],is=["use_dynamic"],as=["use_dynamic"],us=["env","dynamic_env","use_dynamic","error"];function os(e,r,n){ss(e,r),r.set(e,n)}function ss(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cs(e,r){return e.get(ou(e,r))}function ya(e,r,n){return e.set(ou(e,r),n),n}function ou(e,r,n){if(typeof e=="function"?e===r:e.has(r))return arguments.length<3?r:n;throw new TypeError("Private element is not present on this object")}function xi(e,r,n){return r=Bn(r),yo(e,su()?Reflect.construct(r,n||[],Bn(e).constructor):r.apply(e,n))}function su(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(su=function(){return!!e})()}function Or(e,r){var n=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=fs(e))||r){n&&(e=n);var t=0,i=function(){};return{s:i,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,u=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var f=n.next();return u=f.done,f},e:function(f){s=!0,a=f},f:function(){try{u||n.return==null||n.return()}finally{if(s)throw a}}}}function fs(e,r){if(e){if(typeof e=="string")return ga(e,r);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ga(e,r):void 0}}function ga(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,t=Array(r);n<r;n++)t[n]=e[n];return t}function ba(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,t)}return n}function se(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?ba(Object(n),!0).forEach(function(t){Mr(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ba(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function cu(e){var r,n,t,i=2;for(typeof Symbol<"u"&&(n=Symbol.asyncIterator,t=Symbol.iterator);i--;){if(n&&(r=e[n])!=null)return r.call(e);if(t&&(r=e[t])!=null)return new Xn(r.call(e));n="@@asyncIterator",t="@@iterator"}throw new TypeError("Object is not async iterable")}function Xn(e){function r(n){if(Object(n)!==n)return Promise.reject(new TypeError(n+" is not an object."));var t=n.done;return Promise.resolve(n.value).then(function(i){return{value:i,done:t}})}return Xn=function(t){this.s=t,this.n=t.next},Xn.prototype={s:null,n:null,next:function(){return r(this.n.apply(this.s,arguments))},return:function(t){var i=this.s.return;return i===void 0?Promise.resolve({value:t,done:!0}):r(i.apply(this.s,arguments))},throw:function(t){var i=this.s.return;return i===void 0?Promise.reject(t):r(i.apply(this.s,arguments))}},new Xn(e)}var Ar=typeof global<"u"?global:self;Ar.fetch||(Ar.fetch=es);var ls={pair:B,symbol:x,number:l,array:Array,nil:Sr,character:pe,values:Vr,"input-port":Ye,"output-port":$e,regex:RegExp,syntax:Te,eof:Vi,macro:fe,string:Q,"native-symbol":Symbol},_s=new Map([[NaN,"NaN"],[null,"null"]]),fu,Tr,Nr,pr=Ar.BN;function hs(e,r){var n=!1,t=!0,i=e.document,a=i.documentElement,u=i.addEventListener,s=u?"addEventListener":"attachEvent",o=u?"removeEventListener":"detachEvent",f=u?"":"on",c=function(k){k.type=="readystatechange"&&i.readyState!="complete"||((k.type=="load"?e:i)[o](f+k.type,c,!1),!n&&(n=!0)&&r.call(e,k.type||k))},_=function(){try{a.doScroll("left")}catch{setTimeout(_,50);return}c("poll")};if(i.readyState=="complete")r.call(e,"lazy");else{if(!u&&a.doScroll){try{t=!e.frameElement}catch{}t&&_()}i[s](f+"DOMContentLoaded",c,!1),i[s](f+"readystatechange",c,!1),e[s](f+"load",c,!1)}}function Y(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),t=1;t<r;t++)n[t-1]=arguments[t];if(sr(e)&&ui(n[0]))console.log(Ru(e,function(a){return ze(a,!0)}));else if(ui()){var i;(i=console).log.apply(i,[ze(e,!0)].concat(ge(n.map(function(a){return ze(a,!0)}))))}}function ui(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=Oe&&Oe.get("DEBUG",{throwError:!1});return e===null?r===!0:r?.valueOf()===e.valueOf()}function Ei(e){return e?"(?:#".concat(e,"(?:#[ie])?|#[ie]#").concat(e,")"):"(?:#[ie])?"}function lu(e,r){return"".concat(Ei(e),"[+-]?").concat(r,"+/").concat(r,"+")}function Ai(e,r){return"".concat(Ei(e),"(?:[+-]?(?:").concat(r,"+/").concat(r,"+|nan.0|inf.0|").concat(r,"+))?(?:[+-]i|[+-]?(?:").concat(r,"+/").concat(r,"+|").concat(r,"+|nan.0|inf.0)i)(?=[()[\\]\\s]|$)")}function _u(e,r){return"".concat(Ei(e),"[+-]?").concat(r,"+")}var Fi=/^#\/((?:\\\/|[^/]|\[[^\]]*\/[^\]]*\])+)\/([gimyus]*)$/,oi="(?:[-+]?(?:[0-9]+(?:[eE][-+]?[0-9]+)|(?:\\.[0-9]+|[0-9]+\\.[0-9]+)(?:[eE][-+]?[0-9]+)?)|[0-9]+\\.)",ps="(?:#[ie])?(?:[+-]?(?:[0-9][0-9_]*/[0-9][0-9_]*|nan.0|inf.0|".concat(oi,"|[+-]?[0-9]+))?(?:").concat(oi,"|[+-](?:[0-9]+/[0-9]+|[0-9]+|nan.0|inf.0))i"),xt=new RegExp("^(#[ie])?".concat(oi,"$"),"i");function hu(e,r){var n=e==="x"?"(?!\\+|".concat(r,")"):"(?!\\.|".concat(r,")"),t="";return e===""&&(t="(?:[-+]?(?:[0-9]+(?:[eE][-+]?[0-9]+)|(?:\\.[0-9]+|[0-9]+\\.[0-9]+(?![0-9]))(?:[eE][-+]?[0-9]+)?))"),new RegExp("^((?:(?:".concat(t,"|[-+]?inf.0|[-+]?nan.0|[+-]?").concat(r,"+/").concat(r,"+(?!").concat(r,")|[+-]?").concat(r,"+)").concat(n,")?)(").concat(t,"|[-+]?inf.0|[-+]?nan.0|[+-]?").concat(r,"+/").concat(r,"+|[+-]?").concat(r,"+|[+-])i$"),"i")}var ds=function(){var e={};return[[10,"","[0-9]"],[16,"x","[0-9a-fA-F]"],[8,"o","[0-7]"],[2,"b","[01]"]].forEach(function(r){var n=ve(r,3),t=n[0],i=n[1],a=n[2];e[t]=hu(i,a)}),e}(),pu={alarm:"\x07",backspace:"\b",delete:"",escape:"\x1B",newline:`
`,null:"\0",return:"\r",space:" ",tab:"	",dle:"",soh:"",dc1:"",stx:"",dc2:"",etx:"",dc3:"",eot:"",dc4:"",enq:"",nak:"",ack:"",syn:"",bel:"\x07",etb:"",bs:"\b",can:"",ht:"	",em:"",lf:`
`,sub:"",vt:"\v",esc:"\x1B",ff:"\f",fs:"",cr:"\r",gs:"",so:"",rs:"",si:"",us:"",del:""};function ms(e){for(var r=[],n=0,t=e.length;n<t;){var i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<t){var a=e.charCodeAt(n++);(a&64512)===56320?r.push(((i&1023)<<10)+(a&1023)+65536):(r.push(i),n--)}else r.push(i)}return r}var vs=Object.keys(pu).join("|"),ys="#\\\\(?:x[0-9a-f]+|".concat(vs,"|[\\s\\S])"),du=new RegExp("^".concat(ys,"$"),"i");function gs(e){var r=[["o","[0-7]"],["x","[0-9a-fA-F]"],["b","[01]"],["d","[0-9]"],["","[0-9]"]],n=r.map(function(t){var i=ve(t,2),a=i[0],u=i[1];return e(a,u)}).join("|");return e===Ai&&(n=ps+"|"+n),n}function ki(e){return new RegExp("^(?:"+gs(e)+")$","i")}var Ci=ki(Ai),Oi=ki(lu),Si=ki(_u),mu=new RegExp("^(?:"+_u("","[0-9a-f]")+")$","i"),vu=new RegExp("^(?:"+lu("","[0-9a-f]")+")$","i"),bs=new RegExp("^(?:"+Ai("","[0-9a-f]")+")$","i"),ws=hu("","[0-9a-fA-F]"),Ds=/((?:#[xodbie]){0,2})(.*)/i;function Et(e){var r=e.match(Ds),n={};if(r[1]){var t=r[1].replace(/#/g,"").toLowerCase().split("");t.includes("x")?n.radix=16:t.includes("o")?n.radix=8:t.includes("b")?n.radix=2:t.includes("d")&&(n.radix=10),t.includes("i")&&(n.inexact=!0),t.includes("e")&&(n.exact=!0)}return n.number=r[2],n}function yu(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10,n=Et(e),t=n.number.split("/"),i=le({num:l([t[0],n.radix||r]),denom:l([t[1],n.radix||r])});return n.inexact?i.valueOf():i}function gu(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10,n=Et(e);return n.inexact?ue(parseInt(n.number,n.radix||r)):l([n.number,n.radix||r])}function wa(e){var r=e.match(/#\\x([0-9a-f]+)$/i),n;if(r){var t=parseInt(r[1],16);n=String.fromCodePoint(t)}else r=e.match(/#\\([\s\S]+)$/),r&&(n=r[1]);if(n)return pe(n);throw new Error("Parse: invalid character")}function bu(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10;function n(o){var f;if(o==="+")f=l(1);else if(o==="-")f=l(-1);else if(o.match(mu))f=l([o,r]);else if(o.match(vu)){var c=o.split("/");f=le({num:l([c[0],r]),denom:l([c[1],r])})}else if(o.match(xt)){var _=Bi(o);return t.exact?_.toRational():_}else{if(o.match(/nan.0$/))return l(NaN);if(o.match(/inf.0$/))return o[0]==="-"?l(Number.NEGATIVE_INFINITY):l(Number.POSITIVE_INFINITY);throw new Error("Internal Parser Error")}return t.inexact?ue(f.valueOf()):f}var t=Et(e);r=t.radix||r;var i,a=t.number.match(ws);r!==10&&a?i=a:i=t.number.match(ds[r]);var u,s;return s=n(i[2]),i[1]?u=n(i[1]):s instanceof ue?u=ue(0):u=l(0),s.cmp(0)===0&&s.__type__==="bigint"?u:oe({im:s,re:u})}function xs(e){return parseInt(e.toString(),10)===e}function Es(e){var r=e.match(/^(([-+]?[0-9]*)(?:\.([0-9]+))?)e([-+]?[0-9]+)/i);if(r){var n=parseInt(r[4],10),t,i=r[1].replace(/[-+]?([0-9]*)\..+$/,"$1").length,a=r[3]&&r[3].length;i<Math.abs(n)&&(t=l([r[1].replace(/\./,""),10]),a&&(n-=a))}return{exponent:n,mantisa:t}}function As(e){if(e.match(/e/i)){var r=e.split("e"),n=ve(r,2),t=n[0],i=n[1],a=Math.abs(parseInt(i));if(a<7&&i<0){var u="0".repeat(a-1),s=t[0]==="-"?"-":"+",o=t.replace(/(^[-+])|\./g,""),f="".concat(s,"0.").concat(u).concat(o);return parseFloat(f)}}return parseFloat(e)}function Bi(e){var r=Et(e),n=As(r.number),t=(r.number.match(/\.0$/)||!r.number.match(/\./))&&!r.number.match(/e/i);if(!r.inexact){if(r.exact&&t||xs(n)&&Number.isSafeInteger(n)&&r.number.match(/e\+?[0-9]/i))return l(n);var i=Es(r.number),a=i.mantisa,u=i.exponent;if(a!==void 0&&u!==void 0){var s=l(10).pow(l(Math.abs(u)));if(r.exact&&u<0)return le({num:a,denom:s});if(u>0&&(r.exact||!r.number.match(/\./)))return l(a).mul(s)}}return n=ue(n),r.exact?n.toRational():n}function Fs(e){e=e.replace(/\\x([0-9a-f]+);/gi,function(i,a){return"\\u"+a.padStart(4,"0")}).replace(/\n/g,"\\n");var r=e.match(/(\\*)(\\x[0-9A-F])/i);if(r&&r[1].length%2===0)throw new Error("Invalid string literal, unclosed ".concat(r[2]));try{var n=Q(JSON.parse(e));return n.freeze(),n}catch(i){var t=i.message.replace(/in JSON /,"").replace(/.*Error: /,"");throw new Error("Invalid string literal: ".concat(t))}}function ks(e){e.match(/^name/);var r=/(^|.)\|/g;if(e.match(r)){e=e.split("|").filter(Boolean).reduce(function(t,i){var a="";if(i.match(/^\\+$/)){if(i.length>1){var u=Math.floor(i.length/2);a="\\".repeat(u)}i.length%2!==0&&(a+="|")}else a=i;return t+a});var n={t:"	",r:"\r",n:`
`};e=e.replace(/\\(x[^;]+);/g,function(t,i){return String.fromCharCode(parseInt("0"+i,16))}).replace(/\\([trn])/g,function(t,i){return n[i]})}return new x(e)}function Cs(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=e.token;if(Ua.hasOwnProperty(n))return Ua[n];var t;if(n.match(/^"[\s\S]*"$/))t=Fs(n);else if(n[0]==="#"){var i=n.match(Fi);i?t=new RegExp(i[1],i[2]):n.match(du)&&(t=wa(n));var a=n.match(/#\\(.+)/);a&&ms(a[1]).length===1&&(t=wa(n))}if(n.match(/[0-9a-f]|[+-]i/i)&&(n.match(Si)?t=gu(n):n.match(xt)?t=Bi(n):n.match(Oi)?t=yu(n):n.match(Ci)&&(t=bu(n))),!t&&n.match(/^#[iexobd]/))throw new Error("Invalid numeric constant: "+e);if(t||(t=ks(n)),r){var u=e.col,s=e.offset,o=e.line;Z(t,"__col__",u),Z(t,"__offset__",s),Z(t,"__line__",o)}return t}function Os(e){return!(["(",")","[","]"].includes(e)||Ce.names().includes(e))}function Ss(e){return Os(e)&&!(e.match(Fi)||e.match(/^"[\s\S]*"$/)||e.match(Si)||e.match(xt)||e.match(Ci)||e.match(Oi)||e.match(du)||["#t","#f","nil"].includes(e))}var pt=/"(?:\\[\S\s]|[^"])*"?/g;function Bs(e){if(typeof e=="string"){var r=/([-\\^$[\]()+{}?*.|])/g;return e.replace(r,"\\$1")}return e}function Tn(){this.data=[]}Tn.prototype.push=function(e){this.data.push(e)};Tn.prototype.top=function(){return this.data[this.data.length-1]};Tn.prototype.pop=function(){return this.data.pop()};Tn.prototype.is_empty=function(){return!this.data.length};function Da(e){e instanceof Q&&(e=e.valueOf());for(var r=new q(e,{whitespace:!0}),n=[];;){var t=r.peek(!0);if(t===Se)break;n.push(t),r.skip()}return n}function js(e){var r=e.token,n=_n(e,rs);if(r.match(/^"[\s\S]*"$/)&&r.match(/\n/)){var t=new RegExp("^ {1,"+(e.col+1)+"}","mg");r=r.replace(t,"")}return se({token:r},n)}function dt(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};this.fn=e,this.cont=r}dt.prototype.toString=function(){return"#<Thunk>"};function Is(e){return function(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return Ps(e.apply(this,n))}}function Ps(e){for(;e instanceof dt;){var r=e;e=e.fn(),e instanceof dt||r.cont()}return e}function hn(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e instanceof Q&&(e=e.toString()),r)return Da(e);var n=Da(e).map(function(t){return t.token==="#\\ "||t.token==`#\\
`?t.token:t.token.trim()}).filter(function(t){return t&&!t.match(/^;/)&&!t.match(/^#\|[\s\S]*\|#$/)});return Ns(n)}function Ns(e){for(var r=0,n=null,t=[],i=0;i<e.length;++i){var a=e[i];if(a==="#;"){["(","["].includes(e[i+1])?(r=1,n=i):t.push([i,i+2]),i+=1;continue}n!==null&&([")","]"].includes(a)?r--:["(","["].includes(a)&&r++,r===0&&(t.push([n,i+1]),n=null))}e=e.slice(),t.reverse();for(var u=0,s=t;u<s.length;u++){var o=ve(s[u],2),f=o[0],c=o[1];e.splice(f,c-f)}return e}function Ts(e){return ye(e)==="symbol"||ye(e)==="object"&&Object.prototype.toString.call(e)==="[object Symbol]"}function x(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e instanceof Q&&(e=e.valueOf()),r&&x.list[e]instanceof x)return x.list[e];if(typeof this<"u"&&this.constructor!==x||typeof this>"u")return new x(e,r);this.__name__=e,r&&typeof e=="string"&&(x.list[e]=this)}x.list={};x.literal=Symbol.for("__literal__");x.object=Symbol.for("__object__");x.prototype.is_interned=function(){return x.list[this.__name__]==this};x.is=function(e,r){return e instanceof x&&(r instanceof x&&e.__name__===r.__name__||typeof r=="string"&&e.__name__===r||r instanceof RegExp&&r.test(e.__name__))};x.prototype.toString=function(e){if(Ts(this.__name__))return ji(this.__name__);var r=this.valueOf();return e&&r.match(/(^;|[\s()[\]'])/)?"|".concat(r,"|"):r};x.prototype.literal=function(){return this.is_gensym()?this[x.literal]:this.valueOf()};x.prototype.serialize=function(){return Q.isString(this.__name__)?this.__name__:[ji(this.__name__)]};x.prototype.valueOf=function(){return this.__name__.valueOf()};x.prototype.is_gensym=function(){return Ii(this.__name__)};function ji(e){return e.toString().replace(/^Symbol\(([^)]+)\)/,"$1")}function Ii(e){return ye(e)==="symbol"?!!e.toString().match(/^Symbol\(#:/):!1}var Pi=function(){var e=0;function r(n,t){var i=new x(t,!1);return xr(i,"__literal__",n),i}return function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(n instanceof x){if(n.is_gensym())return n;n=n.valueOf()}return Ii(n)?x(n,!1):n!==null?r(n,Symbol("#:".concat(n))):(e++,r(e,Symbol("#:g".concat(e))))}}();function si(e,r){var n=H.get("begin"),t=Pi("begin");return e.forEach(function(i){i.set(t,n)}),new B(t,r)}function Pe(e){var r=this,n={pending:!0,rejected:!1,fulfilled:!1,reason:void 0,type:void 0};e=e.then(function(t){return n.type=Ae(t),n.fulfilled=!0,n.pending=!1,t}),Z(this,"_promise",e,{hidden:!0}),he(e.catch)&&(e=e.catch(function(t){n.rejected=!0,n.pending=!1,n.reason=t})),Object.keys(n).forEach(function(t){Object.defineProperty(r,"__".concat(t,"__"),{enumerable:!0,get:function(){return n[t]}})}),Z(this,"__promise__",e),this.then=!1}Pe.prototype.then=function(e){return new Pe(this.valueOf().then(e))};Pe.prototype.catch=function(e){return new Pe(this.valueOf().catch(e))};Pe.prototype.valueOf=function(){if(!this._promise)throw new Error("QuotedPromise: invalid promise created");return this._promise};Pe.prototype.toString=function(){return this.__pending__?Pe.pending_str:this.__rejected__?Pe.rejected_str:"#<js-promise resolved (".concat(this.__type__,")>")};Pe.pending_str="#<js-promise (pending)>";Pe.rejected_str="#<js-promise (rejected)>";function pn(e){return Array.isArray(e)?Promise.all(Ls(e)).then(Ms):e}function Ls(e){for(var r=new Array(e.length),n=e.length;n--;){var t=e[n];t instanceof Pe?r[n]=new He(t):r[n]=t}return r}function Ms(e){for(var r=new Array(e.length),n=e.length;n--;){var t=e[n];t instanceof He?r[n]=t.valueOf():r[n]=t}return r}var Ce={LITERAL:Symbol.for("literal"),SPLICE:Symbol.for("splice"),SYMBOL:Symbol.for("symbol"),names:function(){return Object.keys(this.__list__)},type:function(r){try{return this.get(r).type}catch(n){return console.log({name:r}),console.log(n),null}},get:function(r){return this.__list__[r]},off:function(r){var n=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Array.isArray(r)?r.forEach(function(i){return n.off(i,t)}):t===null?delete this.__events__[r]:this.__events__=this.__events__.filter(function(i){return i!==t})},on:function(r,n){var t=this;Array.isArray(r)?r.forEach(function(i){return t.on(i,n)}):this.__events__[r]?this.__events__[r].push(n):this.__events__[r]=[n]},trigger:function(r){for(var n=arguments.length,t=new Array(n>1?n-1:0),i=1;i<n;i++)t[i-1]=arguments[i];this.__events__[r]&&this.__events__[r].forEach(function(a){return a.apply(void 0,t)})},remove:function(r){delete this.__list__[r],this.trigger("remove")},append:function(r,n,t){this.__list__[r]={seq:r,symbol:n,type:t},this.trigger("append")},__events__:{},__list__:{}};function Qn(e){return Ce.names().includes(e)}function Rs(e){return Ce.__builtins__.includes(e)}function xa(e){return Ce.type(e)===Ce.LITERAL}function qs(e){return Ce.type(e)===Ce.SYMBOL}var wu=[["'",new x("quote"),Ce.LITERAL],["`",new x("quasiquote"),Ce.LITERAL],[",@",new x("unquote-splicing"),Ce.LITERAL],[",",new x("unquote"),Ce.LITERAL],["'>",new x("quote-promise"),Ce.LITERAL]],Du=wu.map(function(e){return e[0]});Object.freeze(Du);Object.defineProperty(Ce,"__builtins__",{writable:!1,enumerable:!0,value:Du});wu.forEach(function(e){var r=ve(e,3),n=r[0],t=r[1],i=r[2];Ce.append(n,t,i)});var q=function(){function e(r){var n=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.whitespace,a=i===void 0?!1:i;vr(this,e),Z(this,"__input__",r);var u={};["_i","_whitespace","_col","_newline","_line","_state","_next","_token","_prev_char"].forEach(function(s){Object.defineProperty(n,s,{configurable:!1,enumerable:!1,get:function(){return u[s]},set:function(f){u[s]=f}})}),this._whitespace=a,this._i=this._line=this._col=this._newline=0,this._state=this._next=this._token=null,this._prev_char=""}return yr(e,[{key:"get",value:function(n){return this.__internal[n]}},{key:"set",value:function(n,t){this.__internal[n]=t}},{key:"token",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(n){var t=this._line;return this._whitespace&&this._token===`
`&&--t,{token:this._token,col:this._col,offset:this._i,line:t}}return this._token}},{key:"peek",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this._i>=this.__input__.length)return Se;if(this._token)return Z(this,"__token__",this.token(!0)),this.token(n);var t=this.next_token();return t?(this._token=this.__input__.substring(this._i,this._next),this.__token__||Z(this,"__token__",this.token(!0)),this.token(n)):Se}},{key:"skip",value:function(){this._next!==null&&(this._token=null,this._i=this._next)}},{key:"read_line",value:function(){var n=this.__input__.length;if(this._i>=n)return Se;for(var t=this._i;t<n;++t){var i=this.__input__[t];if(i===`
`){var a=this.__input__.substring(this._i,t);return this._i=t+1,++this._line,a}}return this.read_rest()}},{key:"read_rest",value:function(){var n=this._i;return this._i=this.__input__.length,this.__input__.substring(n)}},{key:"read_string",value:function(n){var t=this.__input__.length;if(this._i>=t)return Se;if(n+this._i>=t)return this.read_rest();var i=this._i+n,a=this.__input__.substring(this._i,i),u=a.match(/\n/g);return u&&(this._line+=u.length),this._i=i,a}},{key:"peek_char",value:function(){return this._i>=this.__input__.length?Se:pe(this.__input__[this._i])}},{key:"read_char",value:function(){var n=this.peek_char();return this.skip_char(),n}},{key:"skip_char",value:function(){this._i<this.__input__.length&&(++this._i,this._token=null)}},{key:"match_rule",value:function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.prev_char,a=t.char,u=t.next_char,s=ve(n,4),o=s[0],f=s[1],c=s[2],_=s[3];if(n.length!==5)throw new Error("Lexer: Invalid rule of length ".concat(n.length));if(Nu(o)){if(o!==a)return!1}else if(!a.match(o))return!1;return!(!Aa(f,i)||!Aa(c,u)||_!==this._state)}},{key:"next_token",value:function(){if(this._i>=this.__input__.length)return!1;var n=!0;e:for(var t=this._i,i=this.__input__.length;t<i;++t){var a=this.__input__[t],u=this.__input__[t-1]||"",s=this.__input__[t+1]||"";if(a===`
`){++this._line;var o=this._newline;if(this._state===null&&(this._newline=t+1),this._whitespace&&this._state===null)return this._next=t+1,this._col=this._i-o,!0}if(n&&this._state===null&&a.match(/\s/))if(this._whitespace){if(s.match(/\s/))continue;return this._next=t+1,this._col=this._i-this._newline,!0}else{this._i=t+1;continue}n=!1;var f=Or(e.rules),c;try{for(f.s();!(c=f.n()).done;){var _=c.value;if(this.match_rule(_,{prev_char:u,char:a,next_char:s})){var m=_[_.length-1];if(this._state=m,this._state===null)return this._next=t+1,this._col=this._i-this._newline,!0;continue e}}}catch(p){f.e(p)}finally{f.f()}if(this._state!==null)continue e;var k=this.__input__.split(`
`)[this._line];throw new Error("Invalid Syntax at line ".concat(this._line+1,`
`).concat(k))}if(![null,e.comment].includes(this._state)){var L,b,g=(L=(b=this.__input__.substring(0,this._newline).match(/\n/g))===null||b===void 0?void 0:b.length)!==null&&L!==void 0?L:0,h=this.__input__.substring(this._newline);if(this.__input__[this._i]==="#"){var v=this.__input__.substring(this._i).replace(/^([^\s()\[\]]+).*/,"$1");throw new Error("Invalid Syntax at line ".concat(g+1,": invalid token ").concat(v))}throw new At("Invalid Syntax at line ".concat(g+1,": Unterminated expression ").concat(h))}}}])}();q.literal_rule=function(r,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(r.length===0)throw new Error("Lexer: invalid literal rule");if(r.length===1)return[[r,t,i,null,null]];for(var a=[],u=0,s=r.length;u<s;++u){var o=[];o.push(r[u]),o.push(r[u-1]||t),o.push(r[u+1]||i),u===0?(o.push(null),o.push(n)):u===s-1?(o.push(n),o.push(null)):(o.push(n),o.push(n)),a.push(o)}return a};q.string=Symbol.for("string");q.string_escape=Symbol.for("string_escape");q.symbol=Symbol.for("symbol");q.comment=Symbol.for("comment");q.regex=Symbol.for("regex");q.regex_init=Symbol.for("regex_init");q.regex_class=Symbol.for("regex_class");q.character=Symbol.for("character");q.bracket=Symbol.for("bracket");q.b_symbol=Symbol.for("b_symbol");q.b_symbol_ex=Symbol.for("b_symbol_ex");q.b_comment=Symbol.for("b_comment");q.i_comment=Symbol.for("i_comment");q.l_datum=Symbol.for("l_datum");q.dot=Symbol.for("dot");q.boundary=/^$|[\s()[\]']/;q._rules=[[/"/,null,null,q.string,null],[/"/,null,null,null,q.string],[/"/,null,null,q.string_escape,q.string],[/\\/,null,null,q.string,q.string_escape],[/./,/\\/,null,q.string_escape,q.string],[/#/,null,/[bdxoei]/i,null,q.symbol],[/#/,null,/\\/,null,q.character],[/\\/,/#/,/\s/,q.character,q.character],[/\\/,/#/,/[()[\]]/,q.character,q.character],[/\s/,/\\/,null,q.character,null],[/\S/,null,q.boundary,q.character,null],[/#/,q.boundary,/\//,null,q.regex_init],[/./,/\//,null,q.regex_init,q.regex],[/[ \t]/,null,null,q.regex,q.regex],[/\[/,/[^\\]/,null,q.regex,q.regex_class],[/\]/,/[^\\]/,null,q.regex_class,q.regex],[/[()[\]]/,null,null,q.regex,q.regex],[/\//,/\\/,null,q.regex,q.regex],[/\//,null,q.boundary,q.regex,null],[/[gimyus]/,/\//,q.boundary,q.regex,null],[/[gimyus]/,/\//,/[gimyus]/,q.regex,q.regex],[/[gimyus]/,/[gimyus]/,q.boundary,q.regex,null],[/;/,/^$|[^#]/,null,null,q.comment],[/\n/,";",null,q.comment,null],[/[\s\S]/,null,/\n/,q.comment,null],[/\s/,null,null,q.comment,q.comment],[/#/,null,/\|/,null,q.b_comment],[/\s/,null,null,q.b_comment,q.b_comment],[/#/,/\|/,null,q.b_comment,null],[/#/,null,/;/,null,q.i_comment],[/;/,/#/,null,q.i_comment,null],[/#/,null,/[0-9]/,null,q.l_datum],[/=/,/[0-9]/,null,q.l_datum,null],[/#/,/[0-9]/,null,q.l_datum,null],[/\./,q.boundary,/,/,null,null],[/\|/,null,null,null,q.b_symbol],[/\s/,null,null,q.b_symbol,q.b_symbol],[/\|/,null,q.boundary,q.b_symbol,null],[/\|/,null,/\S/,q.b_symbol,q.b_symbol_ex],[/\S/,null,q.boundary,q.b_symbol_ex,null]];q._brackets=[[/[()[\]]/,null,null,null,null]];q._symbol_rules=[[/\S/,q.boundary,q.boundary,null,null],[/\S/,q.boundary,null,null,q.symbol],[/\S/,null,q.boundary,null,null],[/\S/,null,null,null,q.symbol],[/\S/,null,q.boundary,q.symbol,null]];q._cache={valid:!1,rules:null};Ce.on(["remove","append"],function(){q._cache.valid=!1,q._cache.rules=null});var xu={"#null":null,"#void":void 0},Eu=["#!fold-case","#!no-fold-case"],Ea=["#t","#f"];Object.defineProperty(q,"rules",{get:function(){if(q._cache.valid)return q._cache.rules;var r=Object.keys(xu).concat(Eu,Ea),n=Ce.names().concat(r).sort(function(i,a){return a.length-i.length||i.localeCompare(a)}),t=n.reduce(function(i,a){var u,s=null;a[0]==="#"?a.length===1?u=Symbol.for(a):(Ea.includes(a)&&(s=q.boundary),u=Symbol.for(a[1])):u=Symbol.for(a);var o=q.literal_rule(a,u,null,s);return i.concat(o)},[]);return q._cache.rules=q._rules.concat(q._brackets,t,q._symbol_rules),q._cache.valid=!0,q._cache.rules}});function Aa(e,r){return Nu(e)?e===r:e===null||r.match(e)}var Fr=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.env,t=r.meta,i=t===void 0?!1:t,a=r.formatter,u=a===void 0?js:a;vr(this,e),Z(this,"_formatter",u,{hidden:!0}),Z(this,"__env__",n),Z(this,"_meta",i,{hidden:!0}),Z(this,"_refs",[],{hidden:!0}),Z(this,"_state",{parentheses:0,line:0,fold_case:!1},{hidden:!0})}return yr(e,[{key:"prepare",value:function(n){n instanceof Q&&(n=n.toString()),this._reset_state(),Z(this,"__lexer__",new q(n))}},{key:"_with_syntax_scope",value:function(n){var t=Ju(this.__env__),i=t.get("stdin");H.set("lips",se(se({},mr),{},{__parser__:this})),t.set("stdin",new zr(this,this.__env__));var a=function(){H.set("lips",mr),t.set("stdin",i)};return _e(n(),function(u){return a(),u},a)}},{key:"_reset_state",value:function(){Object.assign(this._state,{parentheses:0,line:0})}},{key:"_resolve",value:function(n){return this.__env__&&this.__env__.get(n,{throwError:!1})}},{key:"_peek",value:function(){var r=ke(ae.mark(function t(){var i;return ae.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(i=this.__lexer__.peek(!0),i!==Se){u.next=4;break}return u.abrupt("return",Se);case 4:if(!this._is_comment(i.token)){u.next=7;break}return this.skip(),u.abrupt("continue",0);case 7:if(!Pu(i.token)){u.next=11;break}return this.skip(),i.token==="#!fold-case"?this._state.fold_case=!0:i.token==="#!no-fold-case"&&(this._state.fold_case=!1),u.abrupt("continue",0);case 11:if(i.token!=="#;"){u.next=18;break}if(this.skip(),this.__lexer__.peek()!==Se){u.next=15;break}throw new Error("Lexer: syntax error eof found after comment");case 15:return u.next=17,this._read_object();case 17:return u.abrupt("continue",0);case 18:return u.abrupt("break",21);case 21:return i=this._formatter(i),this._state.fold_case&&(i.token=Cu(i.token)),u.abrupt("return",i);case 24:case"end":return u.stop()}},t,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"peek",value:function(){var r=ke(ae.mark(function t(){var i;return ae.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(i=this._peek(),!this._meta){u.next=3;break}return u.abrupt("return",i);case 3:return u.abrupt("return",i.token);case 4:case"end":return u.stop()}},t,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"_reset",value:function(){this._refs.length=0}},{key:"skip",value:function(){this.__lexer__.skip()}},{key:"_read",value:function(){var r=ke(ae.mark(function t(){var i;return ae.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this._peek();case 2:return i=u.sent,this.skip(),u.abrupt("return",i);case 5:case"end":return u.stop()}},t,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"read",value:function(){var r=ke(ae.mark(function t(){var i;return ae.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.peek();case 2:return i=u.sent,this.skip(),u.abrupt("return",i);case 5:case"end":return u.stop()}},t,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"_match_datum_label",value:function(n){var t=n.token.match(/^#([0-9]+)=$/);return t&&t[1]}},{key:"_match_datum_ref",value:function(n){var t=n.token.match(/^#([0-9]+)#$/);return t&&t[1]}},{key:"_is_open",value:function(n){return["(","["].includes(n.token)}},{key:"_is_close",value:function(n){return[")","]"].includes(n.token)}},{key:"_read_list",value:function(){var r=ke(ae.mark(function t(){var i,a,u,s,o,f;return ae.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:i=te,a=i;case 1:return _.next=4,this._peek();case 4:if(s=_.sent,s!==Se){_.next=7;break}return _.abrupt("break",31);case 7:if(!this._is_close(s)){_.next=11;break}return--this._state.parentheses,this.skip(),_.abrupt("break",31);case 11:if(!(s.token==="."&&!$(i))){_.next=19;break}return this.skip(),_.next=15,this._read_object();case 15:a.cdr=_.sent,u=!0,_.next=29;break;case 19:if(!u){_.next=23;break}throw new Error("Parser: syntax error more than one element after dot");case 23:return _.next=25,this._read_object();case 25:o=_.sent,f=new B(o,te),$(i)?i=f:a.cdr=f,a=f;case 29:_.next=1;break;case 31:return _.abrupt("return",i);case 32:case"end":return _.stop()}},t,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"_read_value",value:function(){var r=ke(ae.mark(function t(){var i;return ae.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this._read();case 2:if(i=u.sent,!(i===Se||i.token===Se)){u.next=5;break}throw new Error("Parser: Expected token eof found");case 5:return u.abrupt("return",Cs(i,this._meta));case 6:case"end":return u.stop()}},t,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"_is_comment",value:function(n){return n.match(/^;/)||n.match(/^#\|/)&&n.match(/\|#$/)}},{key:"evaluate",value:function(n){return ie(n,{env:this.__env__,error:function(i){throw i}})}},{key:"read_object",value:function(){var r=ke(ae.mark(function t(){var i;return ae.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this._reset(),u.next=3,this._read_object();case 3:if(i=u.sent,i instanceof Un&&(i=i.valueOf()),!this._refs.length){u.next=7;break}return u.abrupt("return",_e(this._resolve_object(i),function(s){return C(s)&&s.mark_cycles(),s}));case 7:return u.abrupt("return",i);case 8:case"end":return u.stop()}},t,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"balanced",value:function(){return this._state.parentheses===0}},{key:"_ballancing_error",value:function(n,t){var i=this._state.parentheses,a;if(i<0)a=new Error("Parser: unexpected parenthesis"),t?a.__code__=[t.toString()+")"]:a.__code__=[")"];else{a=new Error("Parser: expected parenthesis but eof found");var u=new RegExp("\\){".concat(i,"}$"));a.__code__=[n.toString().replace(u,"")]}throw this._agument_exception(a),a}},{key:"_agument_exception",value:function(n){var t=this.__lexer__.__token__;if("col"in t){var i=t.col,a=t.offset,u=t.line;n.message+=" at line ".concat(u+1," and column ").concat(i+1),Z(n,"__col__",i),Z(n,"__offset__",a),Z(n,"__line__",u)}}},{key:"_resolve_object",value:function(){var r=ke(ae.mark(function t(i){var a=this,u;return ae.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!Array.isArray(i)){o.next=2;break}return o.abrupt("return",i.map(function(f){return a._resolve_object(f)}));case 2:if(!sr(i)){o.next=6;break}return u={},Object.keys(i).forEach(function(f){u[f]=a._resolve_object(i[f])}),o.abrupt("return",u);case 6:if(!C(i)){o.next=8;break}return o.abrupt("return",this._resolve_pair(i));case 8:return o.abrupt("return",i);case 9:case"end":return o.stop()}},t,this)}));function n(t){return r.apply(this,arguments)}return n}()},{key:"_resolve_pair",value:function(){var r=ke(ae.mark(function t(i){return ae.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!C(i)){u.next=15;break}if(!(i.car instanceof Un)){u.next=7;break}return u.next=4,i.car.valueOf();case 4:i.car=u.sent,u.next=8;break;case 7:this._resolve_pair(i.car);case 8:if(!(i.cdr instanceof Un)){u.next=14;break}return u.next=11,i.cdr.valueOf();case 11:i.cdr=u.sent,u.next=15;break;case 14:this._resolve_pair(i.cdr);case 15:return u.abrupt("return",i);case 16:case"end":return u.stop()}},t,this)}));function n(t){return r.apply(this,arguments)}return n}()},{key:"get_line",value:function(){return this._state.line}},{key:"_read_object",value:function(){var r=ke(ae.mark(function t(){var i=this,a,u,s,o,f,c,_,m,k,L,b,g,h,v,p,A;return ae.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this._peek();case 2:if(a=S.sent,a!==Se){S.next=5;break}return S.abrupt("return",a);case 5:if(this._state.line=this.__lexer__.__token__.line,!Qn(a.token)){S.next=58;break}return u=Ce.get(a.token),s=Rs(a.token),this.skip(),c=qs(a.token),S.t0=this,S.next=14,this._peek();case 14:if(S.t1=S.sent,_=S.t0._is_close.call(S.t0,S.t1),!c){S.next=20;break}S.t2=void 0,S.next=23;break;case 20:return S.next=22,this._read_object();case 22:S.t2=S.sent;case 23:if(m=S.t2,m!==Se){S.next=26;break}throw new At("Expecting expression eof found");case 26:if(s){S.next=35;break}if(f=this.__env__.get(u.symbol),typeof f!="function"){S.next=35;break}if(xa(a.token)?k=[m]:$(m)?k=[]:C(m)&&(k=m.to_array(!1)),!(k||c)){S.next=32;break}return S.abrupt("return",this._with_syntax_scope(function(){return un(f,c?[]:k,{env:i.__env__,dynamic_env:i.__env__,use_dynamic:!1})}));case 32:throw L=new Error("Parse Error: Invalid parser extension "+"invocation ".concat(u.symbol)),this._agument_exception(L),L;case 35:if(!xa(a.token)){S.next=43;break}if(!_){S.next=40;break}throw b=new Error("Parse Error: expecting datum"),this._agument_exception(b),b;case 40:o=new B(u.symbol,new B(m,te)),S.next=44;break;case 43:o=new B(u.symbol,m);case 44:if(!s){S.next=46;break}return S.abrupt("return",o);case 46:if(!(f instanceof fe)){S.next=55;break}return S.next=49,this._with_syntax_scope(function(){return i.evaluate(o)});case 49:if(g=S.sent,!(C(g)||g instanceof x)){S.next=52;break}return S.abrupt("return",B.fromArray([x("quote"),g]));case 52:return S.abrupt("return",g);case 55:throw h=new Error("Parse Error: invalid parser extension: "+u.symbol),this._agument_exception(h),h;case 58:if(v=this._match_datum_ref(a),v===null){S.next=66;break}if(this.skip(),!this._refs[v]){S.next=63;break}return S.abrupt("return",new Un(v,this._refs[v]));case 63:throw p=new Error("Parse Error: invalid datum label #".concat(v,"#")),this._agument_exception(p),p;case 66:if(A=this._match_datum_label(a),A===null){S.next=73;break}return this.skip(),this._refs[A]=this._read_object(),S.abrupt("return",this._refs[A]);case 73:if(!this._is_close(a)){S.next=78;break}--this._state.parentheses,this.skip(),S.next=85;break;case 78:if(!this._is_open(a)){S.next=84;break}return++this._state.parentheses,this.skip(),S.abrupt("return",this._read_list());case 84:return S.abrupt("return",this._read_value());case 85:case"end":return S.stop()}},t,this)}));function n(){return r.apply(this,arguments)}return n}()}])}(),At=function(e){function r(){return vr(this,r),xi(this,r,arguments)}return vi(r,e),yr(r)}(ot(Error));Fr.Unterminated=At;var Un=function(){function e(r,n){vr(this,e),this.name=r,this.data=n}return yr(e,[{key:"valueOf",value:function(){return this.data}}])}();function Ni(e,r){return ci.apply(this,arguments)}function ci(){return ci=ko(ae.mark(function e(r,n){var t,i,a;return ae.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:n||(H?n=H.get("**interaction-environment**",{throwError:!1}):n=Oe),r instanceof Fr?t=r:(t=new Fr({env:n}),t.prepare(r));case 2:return s.next=5,Fo(t.read_object());case 5:if(a=s.sent,t.balanced()||t._ballancing_error(a,i),a!==Se){s.next=9;break}return s.abrupt("break",14);case 9:return i=a,s.next=12,a;case 12:s.next=2;break;case 14:case"end":return s.stop()}},e)})),ci.apply(this,arguments)}function _e(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(i){return i},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Ke(e)){var t=e.then(r);return n===null?t:t.catch(n)}return e instanceof Array?Us(e,r,n):sr(e)?zs(e,r,n):r(e)}function Us(e,r,n){return e.find(Ke)?_e(pn(e),function(t){return Object.isFrozen(e)&&Object.freeze(t),r(t)},n):r(e)}function zs(e,r,n){for(var t=Object.keys(e),i=[],a=[],u=t.length;u--;){var s=t[u],o=e[s];i[u]=o,Ke(o)&&a.push(o)}return a.length?_e(pn(i),function(f){var c={};return f.forEach(function(_,m){var k=t[m];c[k]=_}),Object.isFrozen(e)&&Object.freeze(c),c},n):r(e)}function Z(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},i=t.hidden,a=i===void 0?!1:i;Object.defineProperty(e,r,{value:n,writable:!1,configurable:!0,enumerable:!a})}function $s(e){return fi.apply(this,arguments)}function fi(){return fi=ke(ae.mark(function e(r){var n,t,i,a,u,s,o;return ae.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:n=[],t=!1,i=!1,c.prev=3,u=cu(r);case 5:return c.next=7,u.next();case 7:if(!(t=!(s=c.sent).done)){c.next=13;break}o=s.value,n.push(o);case 10:t=!1,c.next=5;break;case 13:c.next=19;break;case 15:c.prev=15,c.t0=c.catch(3),i=!0,a=c.t0;case 19:if(c.prev=19,c.prev=20,!(t&&u.return!=null)){c.next=24;break}return c.next=24,u.return();case 24:if(c.prev=24,!i){c.next=27;break}throw a;case 27:return c.finish(24);case 28:return c.finish(19);case 29:return c.abrupt("return",n);case 30:case"end":return c.stop()}},e,null,[[3,15,19,29],[20,,24,28]])})),fi.apply(this,arguments)}function Fa(e,r){if(r instanceof RegExp)return function(a){return String(a).match(r)};if(he(r))return r;if(r instanceof l)return function(a){return l(a).cmp(r)===0};if(r instanceof Q){var n=r.__string__;return function(a){return Q.is(a,n)}}else if(r instanceof x){var t=r.__name__;return function(a){return x.is(a,t)}}else if(r instanceof pe){var i=r.__char__;return function(a){return pe.is(a,i)}}return function(a){return r===a}}function E(e,r,n,t){return typeof e!="string"&&(r=arguments[0],n=arguments[1],t=arguments[2],e=null),n&&(t?r.__doc__=n:r.__doc__=Ti(n)),e?r.__name__=e:r.name&&!qr(r)&&(r.__name__=r.name),r}function Ti(e){return e.split(`
`).map(function(r){return r.trim()}).join(`
`)}function Au(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=e.length;if(r<=0)throw Error("previousSexp: Invalid argument sexp = ".concat(r));e:for(;r--&&n>=0;){for(var t=1;t>0;){var i=e[--n];if(!i)break e;i==="("||i.token==="("?t--:(i===")"||i.token===")")&&t++}n--}return e.slice(n+1)}function Vs(e){if(!e||!e.length)return 0;var r=e.length;if(e[r-1].token===`
`)return 0;for(;--r;)if(e[r].token===`
`){var n=(e[r+1]||{}).token;if(n)return n.length}return 0}function Fu(e,r){return n(e,r)===r.length;function n(t,i){function a(k,L){var b=Or(k),g;try{for(b.s();!(g=b.n()).done;){var h=g.value,v=n(h,L);if(v!==-1)return v}}catch(p){b.e(p)}finally{b.f()}return-1}function u(){return t[o]===Symbol.for("symbol")&&!Ss(i[c])}function s(){var k=t[o+1],L=i[c+1];if(k!==void 0&&L!==void 0)return n([k],[L])}for(var o=0,f={},c=0;c<i.length;++c){if(typeof t[o]>"u")return c;if(t[o]instanceof gr){var _;if(["+","*"].includes(t[o].flag)){for(;c<i.length&&(_=a(t[o].patterns,i.slice(c)),_!==-1);)c+=_;c-=1,o++;continue}else if(t[o].flag==="?"){_=a(t[o].patterns,i.slice(c)),_===-1?c-=2:o++;continue}}else if(t[o]instanceof RegExp){if(!i[c].match(t[o]))return-1}else if(mr.LString.isString(t[o])){if(t[o].valueOf()!==i[c])return-1}else if(ye(t[o])==="symbol"){if(t[o]===Symbol.for("*")){if(f[o]=f[o]||0,["(","["].includes(i[c])?f[o]++:[")","]"].includes(i[c])&&f[o]--,typeof t[o+1]<"u"&&f[o]===0&&s()===-1||f[o]>0)continue}else if(u())return-1}else if(t[o]instanceof Array){var m=n(t[o],i.slice(c));if(m===-1||m+c>i.length)return-1;c+=m-1,o++;continue}else return-1;o++}return t.length!==o?-1:i.length}}function Re(e){this.__code__=e.replace(/\r/g,"")}Re.defaults={offset:0,indent:2,exceptions:{specials:[/^(?:#:)?(?:define(?:-values|-syntax|-macro|-class|-record-type)?|(?:call-with-(?:input-file|output-file|port))|lambda|let-env|try|catch|when|unless|while|syntax-rules|(let|letrec)(-syntax|\*?-values|\*)?)$/],shift:{1:["&","#"]}}};Re.match=Fu;Re.prototype._options=function(r){var n=Re.defaults;if(typeof r>"u")return Object.assign({},n);var t=r&&r.exceptions||{},i=t.specials||[],a=t.shift||{1:[]};return se(se(se({},n),r),{},{exceptions:{specials:[].concat(ge(n.exceptions.specials),ge(i)),shift:se(se({},a),{},{1:[].concat(ge(n.exceptions.shift[1]),ge(a[1]))})}})};Re.prototype.indent=function(r){var n=hn(this.__code__,!0);return this._indent(n,r)};Re.exception_shift=function(e,r){function n(f){if(!f.length)return!1;if(f.indexOf(e)!==-1)return!0;var c=f.filter(function(L){return L instanceof RegExp});if(!c.length)return!1;var _=Or(c),m;try{for(_.s();!(m=_.n()).done;){var k=m.value;if(e.match(k))return!0}}catch(L){_.e(L)}finally{_.f()}return!1}if(n(r.exceptions.specials))return r.indent;for(var t=r.exceptions.shift,i=0,a=Object.entries(t);i<a.length;i++){var u=ve(a[i],2),s=u[0],o=u[1];if(n(o))return+s}return-1};Re.prototype._indent=function(r,n){var t=this._options(n),i=Vs(r),a=Au(r),u=r[r.length-a.length-1],s=r[r.length-1];if(s.token.match(/^"[\S\s]+[^"]$/))return i+t.indent;if(a&&a.length){if(a[0].line>0&&(t.offset=0),a.toString()===r.toString()&&it(a))return t.offset+a[0].col;if(a.length===1)return t.offset+a[0].col+1;var o=-1;if(u){var f=Re.exception_shift(u.token,t);f!==-1&&(o=f)}if(o===-1&&(o=Re.exception_shift(a[1].token,t)),o!==-1)return t.offset+a[0].col+o;if(a[0].line<a[1].line)return t.offset+a[0].col+1;if(a.length>3&&a[1].line===a[3].line)return a[1].token==="("||a[1].token==="["?t.offset+a[1].col:t.offset+a[3].col;if(a[0].line===a[1].line)return t.offset+t.indent+a[0].col;for(var c=a.slice(2),_=0;_<c.length;++_){var m=c[_];if(m.token.trim())return m.col}}else return 0;return i+t.indent};function dn(e){this.pattern=e}dn.prototype.toString=function(){return"#<pattern(".concat(this.pattern,")>")};dn.prototype.match=function(e){return e.match(this.pattern)};function gr(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var t=r.pop();this.patterns=r,this.flag=t}gr.prototype.toString=function(){var e=this.patterns.map(function(r){return ze(r)}).join("|");return"#<pattern(".concat(e," ").concat(this.flag,")>")};Re.Pattern=gr;Re.Ahead=dn;var xe=/^[[(]$/,Ln=/^[\])]$/,Wr=/[^()[\]]/,qe=new dn(/[^)\]]/),Ft=Symbol.for("*"),Hs=new gr([xe,Ft,Ln],[Wr],"+"),Dr=new gr([xe,Ft,Ln],"+"),ka=new gr([Symbol.for("symbol")],"?"),Ys=new gr([Symbol.for("symbol")],"*"),Ir=[xe,Ys,Ln],Ca=new gr([xe,Symbol.for("symbol"),Ft,Ln],"+"),zn=Kr("syntax-rules"),$n=Kr("define","lambda","define-macro","syntax-rules"),Gs=/^(?!.*\b(?:[()[\]]|define(?:-macro)?|let(?:\*|rec|-env|-syntax|)?|lambda|syntax-rules)\b).*$/,$t=/^(?:#:)?(let(?:\*|rec|-env|-syntax)?)$/,ku=/^;.*/;function Kr(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new RegExp("^(?:#:)?(?:".concat(r.join("|"),")$"))}Re.rules=[[[Dr],0,qe],[[xe,Kr("begin","cond-expand")],1,qe],[[xe,$t,ka,xe,Ca,Ln],1,qe],[[xe,$t,ka,Hs],1,qe],[[xe,$t,xe,Ca],1,qe],[[xe,Kr("define-syntax"),/.+/],1],[[xe,zn,Wr,Ir],1],[[xe,zn,Wr,Ir,Dr],1,qe],[[xe,zn,Ir],1],[ku,-1],[[xe,zn,Ir,Dr],1,qe],[[xe,Gs,new gr([/[^()[\]]/],"+"),Dr],1,qe],[[xe,Dr],1,qe],[[xe,Wr,Dr],1,qe],[[xe,Kr("lambda","if"),Wr],1,qe],[[xe,Kr("while"),Wr,Dr],1,qe],[[xe,Kr("if"),Wr,Ft],1,qe],[[xe,$n,Ir],0,qe],[[xe,$n,Ir,pt],0,qe],[[xe,$n,Ir,pt,Dr],0,qe],[[xe,$n,Ir,Dr],0,qe]];Re.prototype.break=function(){var e=this.__code__.replace(/\n[ \t]*/g,`
 `).trim(),r=function(S){return S.token.match(pt)||S.token.match(Fi)?S.token:S.token.replace(/\s+/," ")},n=function(S){for(var V=S.length;V--;){var K=S[V];if(K.trim()&&!Qn(K))return S.length-V-1}},t=hn(e,!0).map(r).filter(function(O){return O!==`
`}),i=Re.rules;e:for(var a=1;a<t.length;++a)if(t[a].trim()){var u=t.slice(0,a),s={};i.map(function(O){return O[1]}).forEach(function(O){O=O.valueOf(),O>0&&!s[O]&&(s[O]=Au(u,O))});var o=Or(i),f;try{for(o.s();!(f=o.n()).done;){var c=ve(f.value,3),_=c[0],m=c[1],k=c[2],L=_===ku;m=m.valueOf();var b=m>0?s[m]:u,g=b.filter(function(O){return O.trim()&&!Qn(O)});if(g.length){m===-1&&(_=[_],g=g.slice(-1));var h=n(b),v=Fu(_,g),p=t.slice(a).find(function(O){return O.trim()&&!Qn(O)});if(v&&(k instanceof dn&&k.match(p)||!k)){var A=a-h;t[A]!==`
`&&(t[A].trim()?(t.splice(A,0,`
`),a++):t[A]=`
`),a+=h;continue e}}}}catch(O){o.e(O)}finally{o.f()}}return this.__code__=t.join(""),this};Re.prototype._spaces=function(e){return" ".repeat(e)};Re.prototype.format=function(r){for(var n=this.__code__.trim().replace(/[ \t]*\n[ \t]*/g,`
 `),t=hn(n,!0),i=this._options(r),a=0,u=0,s=0;s<t.length;++s){var o=t[s];if(o.token===`
`&&(a=this._indent(t.slice(0,s),i),u+=a,t[s+1])){t[s+1].token=this._spaces(a),a--,u--;for(var f=s+2;f<t.length;++f)if(t[f].offset+=u,t[f].col+=a,t[f].token===`
`){s=f-1;break}}}return t.map(function(c){if(c.token.match(pt)&&c.token.match(/\n/)){var _=" ".repeat(c.col),m=c.token.split(`
`);c.token=[m[0]].concat(m.slice(1).map(function(k){return _+k})).join(`
`)}return c.token}).join("")};var Ws={65:97,66:98,67:99,68:100,69:101,70:102,71:103,72:104,73:105,74:106,75:107,76:108,77:109,78:110,79:111,80:112,81:113,82:114,83:115,84:116,85:117,86:118,87:119,88:120,89:121,90:122,181:956,192:224,193:225,194:226,195:227,196:228,197:229,198:230,199:231,200:232,201:233,202:234,203:235,204:236,205:237,206:238,207:239,208:240,209:241,210:242,211:243,212:244,213:245,214:246,216:248,217:249,218:250,219:251,220:252,221:253,222:254,256:257,258:259,260:261,262:263,264:265,266:267,268:269,270:271,272:273,274:275,276:277,278:279,280:281,282:283,284:285,286:287,288:289,290:291,292:293,294:295,296:297,298:299,300:301,302:303,306:307,308:309,310:311,313:314,315:316,317:318,319:320,321:322,323:324,325:326,327:328,330:331,332:333,334:335,336:337,338:339,340:341,342:343,344:345,346:347,348:349,350:351,352:353,354:355,356:357,358:359,360:361,362:363,364:365,366:367,368:369,370:371,372:373,374:375,376:255,377:378,379:380,381:382,383:115,385:595,386:387,388:389,390:596,391:392,393:598,394:599,395:396,398:477,399:601,400:603,401:402,403:608,404:611,406:617,407:616,408:409,412:623,413:626,415:629,416:417,418:419,420:421,422:640,423:424,425:643,428:429,430:648,431:432,433:650,434:651,435:436,437:438,439:658,440:441,444:445,452:454,453:454,455:457,456:457,458:460,459:460,461:462,463:464,465:466,467:468,469:470,471:472,473:474,475:476,478:479,480:481,482:483,484:485,486:487,488:489,490:491,492:493,494:495,497:499,498:499,500:501,502:405,503:447,504:505,506:507,508:509,510:511,512:513,514:515,516:517,518:519,520:521,522:523,524:525,526:527,528:529,530:531,532:533,534:535,536:537,538:539,540:541,542:543,544:414,546:547,548:549,550:551,552:553,554:555,556:557,558:559,560:561,562:563,570:11365,571:572,573:410,574:11366,577:578,579:384,580:649,581:652,582:583,584:585,586:587,588:589,590:591,837:953,880:881,882:883,886:887,895:1011,902:940,904:941,905:942,906:943,908:972,910:973,911:974,913:945,914:946,915:947,916:948,917:949,918:950,919:951,920:952,921:953,922:954,923:955,924:956,925:957,926:958,927:959,928:960,929:961,931:963,932:964,933:965,934:966,935:967,936:968,937:969,938:970,939:971,962:963,975:983,976:946,977:952,981:966,982:960,984:985,986:987,988:989,990:991,992:993,994:995,996:997,998:999,1e3:1001,1002:1003,1004:1005,1006:1007,1008:954,1009:961,1012:952,1013:949,1015:1016,1017:1010,1018:1019,1021:891,1022:892,1023:893,1024:1104,1025:1105,1026:1106,1027:1107,1028:1108,1029:1109,1030:1110,1031:1111,1032:1112,1033:1113,1034:1114,1035:1115,1036:1116,1037:1117,1038:1118,1039:1119,1040:1072,1041:1073,1042:1074,1043:1075,1044:1076,1045:1077,1046:1078,1047:1079,1048:1080,1049:1081,1050:1082,1051:1083,1052:1084,1053:1085,1054:1086,1055:1087,1056:1088,1057:1089,1058:1090,1059:1091,1060:1092,1061:1093,1062:1094,1063:1095,1064:1096,1065:1097,1066:1098,1067:1099,1068:1100,1069:1101,1070:1102,1071:1103,1120:1121,1122:1123,1124:1125,1126:1127,1128:1129,1130:1131,1132:1133,1134:1135,1136:1137,1138:1139,1140:1141,1142:1143,1144:1145,1146:1147,1148:1149,1150:1151,1152:1153,1162:1163,1164:1165,1166:1167,1168:1169,1170:1171,1172:1173,1174:1175,1176:1177,1178:1179,1180:1181,1182:1183,1184:1185,1186:1187,1188:1189,1190:1191,1192:1193,1194:1195,1196:1197,1198:1199,1200:1201,1202:1203,1204:1205,1206:1207,1208:1209,1210:1211,1212:1213,1214:1215,1216:1231,1217:1218,1219:1220,1221:1222,1223:1224,1225:1226,1227:1228,1229:1230,1232:1233,1234:1235,1236:1237,1238:1239,1240:1241,1242:1243,1244:1245,1246:1247,1248:1249,1250:1251,1252:1253,1254:1255,1256:1257,1258:1259,1260:1261,1262:1263,1264:1265,1266:1267,1268:1269,1270:1271,1272:1273,1274:1275,1276:1277,1278:1279,1280:1281,1282:1283,1284:1285,1286:1287,1288:1289,1290:1291,1292:1293,1294:1295,1296:1297,1298:1299,1300:1301,1302:1303,1304:1305,1306:1307,1308:1309,1310:1311,1312:1313,1314:1315,1316:1317,1318:1319,1320:1321,1322:1323,1324:1325,1326:1327,1329:1377,1330:1378,1331:1379,1332:1380,1333:1381,1334:1382,1335:1383,1336:1384,1337:1385,1338:1386,1339:1387,1340:1388,1341:1389,1342:1390,1343:1391,1344:1392,1345:1393,1346:1394,1347:1395,1348:1396,1349:1397,1350:1398,1351:1399,1352:1400,1353:1401,1354:1402,1355:1403,1356:1404,1357:1405,1358:1406,1359:1407,1360:1408,1361:1409,1362:1410,1363:1411,1364:1412,1365:1413,1366:1414,4256:11520,4257:11521,4258:11522,4259:11523,4260:11524,4261:11525,4262:11526,4263:11527,4264:11528,4265:11529,4266:11530,4267:11531,4268:11532,4269:11533,4270:11534,4271:11535,4272:11536,4273:11537,4274:11538,4275:11539,4276:11540,4277:11541,4278:11542,4279:11543,4280:11544,4281:11545,4282:11546,4283:11547,4284:11548,4285:11549,4286:11550,4287:11551,4288:11552,4289:11553,4290:11554,4291:11555,4292:11556,4293:11557,4295:11559,4301:11565,5112:5104,5113:5105,5114:5106,5115:5107,5116:5108,5117:5109,7296:1074,7297:1076,7298:1086,7299:1089,7300:1090,7301:1090,7302:1098,7303:1123,7304:42571,7312:4304,7313:4305,7314:4306,7315:4307,7316:4308,7317:4309,7318:4310,7319:4311,7320:4312,7321:4313,7322:4314,7323:4315,7324:4316,7325:4317,7326:4318,7327:4319,7328:4320,7329:4321,7330:4322,7331:4323,7332:4324,7333:4325,7334:4326,7335:4327,7336:4328,7337:4329,7338:4330,7339:4331,7340:4332,7341:4333,7342:4334,7343:4335,7344:4336,7345:4337,7346:4338,7347:4339,7348:4340,7349:4341,7350:4342,7351:4343,7352:4344,7353:4345,7354:4346,7357:4349,7358:4350,7359:4351,7680:7681,7682:7683,7684:7685,7686:7687,7688:7689,7690:7691,7692:7693,7694:7695,7696:7697,7698:7699,7700:7701,7702:7703,7704:7705,7706:7707,7708:7709,7710:7711,7712:7713,7714:7715,7716:7717,7718:7719,7720:7721,7722:7723,7724:7725,7726:7727,7728:7729,7730:7731,7732:7733,7734:7735,7736:7737,7738:7739,7740:7741,7742:7743,7744:7745,7746:7747,7748:7749,7750:7751,7752:7753,7754:7755,7756:7757,7758:7759,7760:7761,7762:7763,7764:7765,7766:7767,7768:7769,7770:7771,7772:7773,7774:7775,7776:7777,7778:7779,7780:7781,7782:7783,7784:7785,7786:7787,7788:7789,7790:7791,7792:7793,7794:7795,7796:7797,7798:7799,7800:7801,7802:7803,7804:7805,7806:7807,7808:7809,7810:7811,7812:7813,7814:7815,7816:7817,7818:7819,7820:7821,7822:7823,7824:7825,7826:7827,7828:7829,7835:7777,7840:7841,7842:7843,7844:7845,7846:7847,7848:7849,7850:7851,7852:7853,7854:7855,7856:7857,7858:7859,7860:7861,7862:7863,7864:7865,7866:7867,7868:7869,7870:7871,7872:7873,7874:7875,7876:7877,7878:7879,7880:7881,7882:7883,7884:7885,7886:7887,7888:7889,7890:7891,7892:7893,7894:7895,7896:7897,7898:7899,7900:7901,7902:7903,7904:7905,7906:7907,7908:7909,7910:7911,7912:7913,7914:7915,7916:7917,7918:7919,7920:7921,7922:7923,7924:7925,7926:7927,7928:7929,7930:7931,7932:7933,7934:7935,7944:7936,7945:7937,7946:7938,7947:7939,7948:7940,7949:7941,7950:7942,7951:7943,7960:7952,7961:7953,7962:7954,7963:7955,7964:7956,7965:7957,7976:7968,7977:7969,7978:7970,7979:7971,7980:7972,7981:7973,7982:7974,7983:7975,7992:7984,7993:7985,7994:7986,7995:7987,7996:7988,7997:7989,7998:7990,7999:7991,8008:8e3,8009:8001,8010:8002,8011:8003,8012:8004,8013:8005,8025:8017,8027:8019,8029:8021,8031:8023,8040:8032,8041:8033,8042:8034,8043:8035,8044:8036,8045:8037,8046:8038,8047:8039,8120:8112,8121:8113,8122:8048,8123:8049,8126:953,8136:8050,8137:8051,8138:8052,8139:8053,8152:8144,8153:8145,8154:8054,8155:8055,8168:8160,8169:8161,8170:8058,8171:8059,8172:8165,8184:8056,8185:8057,8186:8060,8187:8061,8486:969,8490:107,8491:229,8498:8526,8544:8560,8545:8561,8546:8562,8547:8563,8548:8564,8549:8565,8550:8566,8551:8567,8552:8568,8553:8569,8554:8570,8555:8571,8556:8572,8557:8573,8558:8574,8559:8575,8579:8580,9398:9424,9399:9425,9400:9426,9401:9427,9402:9428,9403:9429,9404:9430,9405:9431,9406:9432,9407:9433,9408:9434,9409:9435,9410:9436,9411:9437,9412:9438,9413:9439,9414:9440,9415:9441,9416:9442,9417:9443,9418:9444,9419:9445,9420:9446,9421:9447,9422:9448,9423:9449,11264:11312,11265:11313,11266:11314,11267:11315,11268:11316,11269:11317,11270:11318,11271:11319,11272:11320,11273:11321,11274:11322,11275:11323,11276:11324,11277:11325,11278:11326,11279:11327,11280:11328,11281:11329,11282:11330,11283:11331,11284:11332,11285:11333,11286:11334,11287:11335,11288:11336,11289:11337,11290:11338,11291:11339,11292:11340,11293:11341,11294:11342,11295:11343,11296:11344,11297:11345,11298:11346,11299:11347,11300:11348,11301:11349,11302:11350,11303:11351,11304:11352,11305:11353,11306:11354,11307:11355,11308:11356,11309:11357,11310:11358,11311:11359,11360:11361,11362:619,11363:7549,11364:637,11367:11368,11369:11370,11371:11372,11373:593,11374:625,11375:592,11376:594,11378:11379,11381:11382,11390:575,11391:576,11392:11393,11394:11395,11396:11397,11398:11399,11400:11401,11402:11403,11404:11405,11406:11407,11408:11409,11410:11411,11412:11413,11414:11415,11416:11417,11418:11419,11420:11421,11422:11423,11424:11425,11426:11427,11428:11429,11430:11431,11432:11433,11434:11435,11436:11437,11438:11439,11440:11441,11442:11443,11444:11445,11446:11447,11448:11449,11450:11451,11452:11453,11454:11455,11456:11457,11458:11459,11460:11461,11462:11463,11464:11465,11466:11467,11468:11469,11470:11471,11472:11473,11474:11475,11476:11477,11478:11479,11480:11481,11482:11483,11484:11485,11486:11487,11488:11489,11490:11491,11499:11500,11501:11502,11506:11507,42560:42561,42562:42563,42564:42565,42566:42567,42568:42569,42570:42571,42572:42573,42574:42575,42576:42577,42578:42579,42580:42581,42582:42583,42584:42585,42586:42587,42588:42589,42590:42591,42592:42593,42594:42595,42596:42597,42598:42599,42600:42601,42602:42603,42604:42605,42624:42625,42626:42627,42628:42629,42630:42631,42632:42633,42634:42635,42636:42637,42638:42639,42640:42641,42642:42643,42644:42645,42646:42647,42648:42649,42650:42651,42786:42787,42788:42789,42790:42791,42792:42793,42794:42795,42796:42797,42798:42799,42802:42803,42804:42805,42806:42807,42808:42809,42810:42811,42812:42813,42814:42815,42816:42817,42818:42819,42820:42821,42822:42823,42824:42825,42826:42827,42828:42829,42830:42831,42832:42833,42834:42835,42836:42837,42838:42839,42840:42841,42842:42843,42844:42845,42846:42847,42848:42849,42850:42851,42852:42853,42854:42855,42856:42857,42858:42859,42860:42861,42862:42863,42873:42874,42875:42876,42877:7545,42878:42879,42880:42881,42882:42883,42884:42885,42886:42887,42891:42892,42893:613,42896:42897,42898:42899,42902:42903,42904:42905,42906:42907,42908:42909,42910:42911,42912:42913,42914:42915,42916:42917,42918:42919,42920:42921,42922:614,42923:604,42924:609,42925:620,42926:618,42928:670,42929:647,42930:669,42931:43859,42932:42933,42934:42935,42936:42937,42938:42939,42940:42941,42942:42943,42944:42945,42946:42947,42948:42900,42949:642,42950:7566,42951:42952,42953:42954,42960:42961,42966:42967,42968:42969,42997:42998,43888:5024,43889:5025,43890:5026,43891:5027,43892:5028,43893:5029,43894:5030,43895:5031,43896:5032,43897:5033,43898:5034,43899:5035,43900:5036,43901:5037,43902:5038,43903:5039,43904:5040,43905:5041,43906:5042,43907:5043,43908:5044,43909:5045,43910:5046,43911:5047,43912:5048,43913:5049,43914:5050,43915:5051,43916:5052,43917:5053,43918:5054,43919:5055,43920:5056,43921:5057,43922:5058,43923:5059,43924:5060,43925:5061,43926:5062,43927:5063,43928:5064,43929:5065,43930:5066,43931:5067,43932:5068,43933:5069,43934:5070,43935:5071,43936:5072,43937:5073,43938:5074,43939:5075,43940:5076,43941:5077,43942:5078,43943:5079,43944:5080,43945:5081,43946:5082,43947:5083,43948:5084,43949:5085,43950:5086,43951:5087,43952:5088,43953:5089,43954:5090,43955:5091,43956:5092,43957:5093,43958:5094,43959:5095,43960:5096,43961:5097,43962:5098,43963:5099,43964:5100,43965:5101,43966:5102,43967:5103,65313:65345,65314:65346,65315:65347,65316:65348,65317:65349,65318:65350,65319:65351,65320:65352,65321:65353,65322:65354,65323:65355,65324:65356,65325:65357,65326:65358,65327:65359,65328:65360,65329:65361,65330:65362,65331:65363,65332:65364,65333:65365,65334:65366,65335:65367,65336:65368,65337:65369,65338:65370,66560:66600,66561:66601,66562:66602,66563:66603,66564:66604,66565:66605,66566:66606,66567:66607,66568:66608,66569:66609,66570:66610,66571:66611,66572:66612,66573:66613,66574:66614,66575:66615,66576:66616,66577:66617,66578:66618,66579:66619,66580:66620,66581:66621,66582:66622,66583:66623,66584:66624,66585:66625,66586:66626,66587:66627,66588:66628,66589:66629,66590:66630,66591:66631,66592:66632,66593:66633,66594:66634,66595:66635,66596:66636,66597:66637,66598:66638,66599:66639,66736:66776,66737:66777,66738:66778,66739:66779,66740:66780,66741:66781,66742:66782,66743:66783,66744:66784,66745:66785,66746:66786,66747:66787,66748:66788,66749:66789,66750:66790,66751:66791,66752:66792,66753:66793,66754:66794,66755:66795,66756:66796,66757:66797,66758:66798,66759:66799,66760:66800,66761:66801,66762:66802,66763:66803,66764:66804,66765:66805,66766:66806,66767:66807,66768:66808,66769:66809,66770:66810,66771:66811,66928:66967,66929:66968,66930:66969,66931:66970,66932:66971,66933:66972,66934:66973,66935:66974,66936:66975,66937:66976,66938:66977,66940:66979,66941:66980,66942:66981,66943:66982,66944:66983,66945:66984,66946:66985,66947:66986,66948:66987,66949:66988,66950:66989,66951:66990,66952:66991,66953:66992,66954:66993,66956:66995,66957:66996,66958:66997,66959:66998,66960:66999,66961:67e3,66962:67001,66964:67003,66965:67004,68736:68800,68737:68801,68738:68802,68739:68803,68740:68804,68741:68805,68742:68806,68743:68807,68744:68808,68745:68809,68746:68810,68747:68811,68748:68812,68749:68813,68750:68814,68751:68815,68752:68816,68753:68817,68754:68818,68755:68819,68756:68820,68757:68821,68758:68822,68759:68823,68760:68824,68761:68825,68762:68826,68763:68827,68764:68828,68765:68829,68766:68830,68767:68831,68768:68832,68769:68833,68770:68834,68771:68835,68772:68836,68773:68837,68774:68838,68775:68839,68776:68840,68777:68841,68778:68842,68779:68843,68780:68844,68781:68845,68782:68846,68783:68847,68784:68848,68785:68849,68786:68850,71840:71872,71841:71873,71842:71874,71843:71875,71844:71876,71845:71877,71846:71878,71847:71879,71848:71880,71849:71881,71850:71882,71851:71883,71852:71884,71853:71885,71854:71886,71855:71887,71856:71888,71857:71889,71858:71890,71859:71891,71860:71892,71861:71893,71862:71894,71863:71895,71864:71896,71865:71897,71866:71898,71867:71899,71868:71900,71869:71901,71870:71902,71871:71903,93760:93792,93761:93793,93762:93794,93763:93795,93764:93796,93765:93797,93766:93798,93767:93799,93768:93800,93769:93801,93770:93802,93771:93803,93772:93804,93773:93805,93774:93806,93775:93807,93776:93808,93777:93809,93778:93810,93779:93811,93780:93812,93781:93813,93782:93814,93783:93815,93784:93816,93785:93817,93786:93818,93787:93819,93788:93820,93789:93821,93790:93822,93791:93823,125184:125218,125185:125219,125186:125220,125187:125221,125188:125222,125189:125223,125190:125224,125191:125225,125192:125226,125193:125227,125194:125228,125195:125229,125196:125230,125197:125231,125198:125232,125199:125233,125200:125234,125201:125235,125202:125236,125203:125237,125204:125238,125205:125239,125206:125240,125207:125241,125208:125242,125209:125243,125210:125244,125211:125245,125212:125246,125213:125247,125214:125248,125215:125249,125216:125250,125217:125251};function Cu(e){return e=e.valueOf(),Array.from(e).map(function(r){var n=r.codePointAt(0),t=Ws[n];return t?String.fromCodePoint(t):r}).join("")}function Ks(e,r){var n=Object.prototype.toString,t="[object Array]",i=[],a=e.slice(),u;if(!e.length)return i;u=a.pop();do n.call(u)===t?a.push.apply(a,u):i.push(u);while(a.length&&(u=a.pop())!==void 0);return i.reverse(),i}function Oa(e,r){for(var n=e.length,t;n>0;){t=Math.floor(r()*n),n--;var i=[e[t],e[n]];e[n]=i[0],e[t]=i[1]}return e}function Sr(){}Sr.prototype.toString=function(){return"()"};Sr.prototype.valueOf=function(){};Sr.prototype.serialize=function(){return 0};Sr.prototype.to_object=function(){return{}};Sr.prototype.append=function(e){return new B(e,te)};Sr.prototype.to_array=function(){return[]};var te=new Sr;function B(e,r){if(typeof this<"u"&&this.constructor!==B||typeof this>"u")return new B(e,r);this.car=e,this.cdr=r}function Sa(e,r){return function(t){if(U(e,t,["pair","nil"]),$(t))return[];for(var i=[],a=t;;)if(C(a)){if(a.have_cycles("cdr"))break;var u=a.car;r&&C(u)&&(u=this.get(e).call(this,u)),i.push(u),a=a.cdr}else{if($(a))break;throw new Error("".concat(e,": can't convert improper list"))}return i}}B.prototype.flatten=function(){return B.fromArray(Ks(this.to_array()))};B.prototype.length=function(){for(var e=0,r=this;!(!r||$(r)||!C(r)||r.have_cycles("cdr"));)e++,r=r.cdr;return e};B.prototype.freeze=function(){for(var e=this;Z(e,"car",e.car),C(e.car)&&!e.have_cycles("car")&&e.car.freeze(),Z(e,"cdr",e.cdr),!(e.have_cycles("cdr")||(e=e.cdr,!C(e))););};B.match=function(e,r){return e instanceof x?x.is(e,r):C(e)?B.match(e.car,r)||B.match(e.cdr,r):Array.isArray(e)?e.some(function(n){return B.match(n,r)}):sr(e)?Object.values(e).some(function(n){return B.match(n,r)}):!1};B.prototype.find=function(e){return B.match(this,e)};B.prototype.clone=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,r=new Map;function n(t){if(C(t)){if(r.has(t))return r.get(t);var i=new B;return r.set(t,i),e?i.car=n(t.car):i.car=t.car,i.cdr=n(t.cdr),i[Ue]=t[Ue],i}return t}return n(this)};B.prototype.last_pair=function(){for(var e=this;;){if(!C(e.cdr))return e;if(e.have_cycles("cdr"))break;e=e.cdr}};B.prototype.to_array=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,r=[];return C(this.car)?e?r.push(this.car.to_array()):r.push(this.car):r.push(this.car.valueOf()),C(this.cdr)&&(r=r.concat(this.cdr.to_array(e))),r};B.fromArray=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(C(e)||n&&e instanceof Array&&e[dr])return e;if(r===!1){for(var t=te,i=e.length;i--;)t=new B(e[i],t);return t}e.length&&!(e instanceof Array)&&(e=ge(e));for(var a=te,u=e.length;u--;){var s=e[u];s instanceof Array?s=B.fromArray(s,r,n):typeof s=="string"?s=Q(s):typeof s=="number"&&!Number.isNaN(s)&&(s=l(s)),a=new B(s,a)}return a};B.prototype.to_object=function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=this,n={};C(r)&&C(r.car);){var t=r.car,i=t.car;i instanceof x&&(i=i.__name__),i instanceof Q&&(i=i.valueOf());var a=t.cdr;C(a)&&(a=a.to_object(e)),Mu(a)&&(e||(a=a.valueOf())),n[i]=a,r=r.cdr}return n};B.fromPairs=function(e){return e.reduce(function(r,n){return new B(new B(new x(n[0]),n[1]),r)},te)};B.fromObject=function(e){var r=Object.keys(e).map(function(n){return[n,e[n]]});return B.fromPairs(r)};B.prototype.reduce=function(e){for(var r=this,n=te;!$(r);)n=e(n,r.car),r=r.cdr;return n};B.prototype.reverse=function(){if(this.have_cycles())throw new Error("You can't reverse list that have cycles");for(var e=this,r=te;!$(e);){var n=e.cdr;e.cdr=r,r=e,e=n}return r};B.prototype.transform=function(e){function r(n){if(C(n)){if(n.replace)return delete n.replace,n;var t=e(n.car);C(t)&&(t=r(t));var i=e(n.cdr);return C(i)&&(i=r(i)),new B(t,i)}return n}return r(this)};B.prototype.map=function(e){return typeof this.car<"u"?new B(e(this.car),$(this.cdr)?te:this.cdr.map(e)):te};var kn=new Map;function sr(e){return e&&ye(e)==="object"&&e.constructor===Object}var Ou=Object.getOwnPropertyNames(Array.prototype),Su=[];Ou.forEach(function(e){Su.push(Array[e],Array.prototype[e])});function Js(e){return e=Qe(e),Su.includes(e)}function Vt(e){return he(e)&&(qr(e)||e.__doc__)}function Xs(e){var r=e.constructor||Object,n=sr(e),t=he(e[Symbol.asyncIterator])||he(e[Symbol.iterator]),i;return kn.has(r)?i=kn.get(r):kn.forEach(function(a,u){u=Qe(u),r===u&&(u===Object&&n&&!t||u!==Object)&&(i=a)}),i}var li=new Map;[[!0,"#t"],[!1,"#f"],[null,"#null"],[void 0,"#void"]].forEach(function(e){var r=ve(e,2),n=r[0],t=r[1];li.set(n,t)});function Bu(e){if(e&&ye(e)==="object"){var r={},n=Object.getOwnPropertySymbols(e);n.forEach(function(i){var a=i.toString().replace(/Symbol\(([^)]+)\)/,"$1");r[a]=ze(e[i])});var t=Object.getOwnPropertyNames(e);return t.forEach(function(i){var a=e[i];a&&ye(a)==="object"&&a.constructor===Object?r[i]=Bu(a):r[i]=ze(a)}),r}return e}function ju(e){return Object.keys(e).concat(Object.getOwnPropertySymbols(e))}function Qs(e,r){return e.hasOwnProperty(r)&&he(e.toString)}function Zs(e){if(kt(e))return"#<procedure(native)>";var r=e.prototype&&e.prototype.constructor;if(he(r)&&qr(r)&&e[yc]&&r.hasOwnProperty("__name__")){var n=r.__name__;return Q.isString(n)?(n=n.toString(),"#<class:".concat(n,">")):"#<class>"}if(e.hasOwnProperty("__name__")){var t=e.__name__;if(ye(t)==="symbol"&&(t=ji(t)),typeof t=="string")return"#<procedure:".concat(t,">")}return Qs(e,"toString")?e.toString():e.name&&!qr(e)?"#<procedure:".concat(e.name.trim(),">"):"#<procedure>"}var _i=new Map;[[Error,function(e){return e.message}],[B,function(e,r){var n=r.quote,t=r.skip_cycles,i=r.pair_args;return t||e.mark_cycles(),e.toString.apply(e,[n].concat(ge(i)))}],[pe,function(e,r){var n=r.quote;return n?e.toString():e.valueOf()}],[Q,function(e,r){var n=r.quote;return e=e.toString(),n?JSON.stringify(e).replace(/\\n/g,`
`):e}],[RegExp,function(e){return"#"+e.toString()}]].forEach(function(e){var r=ve(e,2),n=r[0],t=r[1];_i.set(n,t)});var ec=[x,fe,Ye,$e,we,Pe];function ze(e,r,n){if(typeof jQuery<"u"&&e instanceof jQuery.fn.init)return"#<jQuery("+e.length+")>";if(li.has(e))return li.get(e);if(Zn(e))return"#<prototype>";if(e){var t=e.constructor;if(_i.has(t)){for(var i=arguments.length,a=new Array(i>3?i-3:0),u=3;u<i;u++)a[u-3]=arguments[u];return _i.get(t)(e,{quote:r,skip_cycles:n,pair_args:a})}}var s=Or(ec),o;try{for(s.s();!(o=s.n()).done;){var f=o.value;if(e instanceof f)return e.toString(r)}}catch(k){s.e(k)}finally{s.f()}if(e instanceof l||[te,Se].includes(e))return e.toString();if(e===Ar)return"#<js:global>";if(e===null)return"null";if(he(e))return he(e.toString)&&e.hasOwnProperty("toString")?e.toString().valueOf():Zs(e);if(ye(e)==="object"){var c=e.constructor;c||(c=Object);var _;if(typeof c.__class__=="string")_=c.__class__;else{var m=Xs(e);if(m){if(he(m))return m(e,r);throw new Error("toString: Invalid repr value")}_=c.name}return he(e.toString)&&e.hasOwnProperty("toString")?e.toString().valueOf():(Ae(e)==="instance"&&(qr(c)&&c.__name__?(_=c.__name__.valueOf(),ye(_)==="symbol"&&(_=_.toString().replace(/^Symbol\((?:#:)?([^\)]+)\)$/,"$1"))):kt(c)||(_="instance")),mt(e,Symbol.iterator)?_?"#<iterator(".concat(_,")>"):"#<iterator>":mt(e,Symbol.asyncIterator)?_?"#<asyncIterator(".concat(_,")>"):"#<asyncIterator>":_!==""?"#<"+_+">":"#<Object>")}return typeof e!="string"?e.toString():e}B.prototype.mark_cycles=function(){return rc(this),this};B.prototype.have_cycles=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?!!(this[Ue]&&this[Ue][e]):this.have_cycles("car")||this.have_cycles("cdr")};B.prototype.is_cycle=function(){return hi(this)};function hi(e){return C(e)?e.have_cycles()?!0:hi(e.car,fn)||hi(e.cdr,fn):!1}function rc(e){var r=[],n=[],t=[];function i(f){r.includes(f)||r.push(f)}function a(f,c,_,m){if(C(_)&&m.includes(_))return t.includes(_)||t.push(_),f[Ue]||(f[Ue]={}),f[Ue][c]=_,n.includes(f)||n.push(f),!0}var u=Is(function f(c,_){if(C(c)){delete c[an],delete c[Ue],i(c),_.push(c);var m=a(c,"car",c.car,_),k=a(c,"cdr",c.cdr,_);if(m||u(c.car,_.slice()),!k)return new dt(function(){return f(c.cdr,_.slice())})}});function s(f,c){if(C(f[Ue][c])){var _=o.indexOf(f[Ue][c]);f[Ue][c]="#".concat(_,"#")}}u(e,[]);var o=r.filter(function(f){return t.includes(f)});o.forEach(function(f,c){f[an]="#".concat(c,"=")}),n.forEach(function(f){s(f,"car"),s(f,"cdr")})}B.prototype.toString=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.nested,t=n===void 0?!1:n,i=[];this[an]?i.push(this[an]+"("):t||i.push("(");var a;if(this[Ue]&&this[Ue].car?a=this[Ue].car:a=ze(this.car,e,!0),a!==void 0&&i.push(a),C(this.cdr))if(this[Ue]&&this[Ue].cdr)i.push(" . "),i.push(this[Ue].cdr);else{this.cdr[an]?i.push(" . "):i.push(" ");var u=this.cdr.toString(e,{nested:!0});i.push(u)}else $(this.cdr)||(i=i.concat([" . ",ze(this.cdr,e,!0)]));return(!t||this[an])&&i.push(")"),i.join("")};B.prototype.set=function(e,r){this[e]=r,C(r)&&this.mark_cycles()};B.prototype.append=function(e){if(e instanceof Array)return this.append(B.fromArray(e));var r=this;if(r.car===void 0)C(e)?(this.car=e.car,this.cdr=e.cdr):this.car=e;else if(!$(e)){for(;C(r)&&!$(r.cdr);)r=r.cdr;r.cdr=e}return this};B.prototype.serialize=function(){return[this.car,this.cdr]};B.prototype[Symbol.iterator]=function(){var e=this;return{next:function(){var n=e;return e=n.cdr,$(n)?{value:void 0,done:!0}:{value:n.car,done:!1}}}};function Ht(e){return e<0?-e:e}function Dn(e,r){for(var n=ut(r),t=n[0],i=n.slice(1);i.length>0;){var a=i,u=ve(a,1),s=u[0];if(!e(t,s))return!1;var o=i,f=ut(o);t=f[0],i=f.slice(1)}return!0}function Li(e,r){if(he(e))return he(r)&&Qe(e)===Qe(r);if(e instanceof l){if(!(r instanceof l))return!1;var n;return e.__type__===r.__type__&&(e.__type__==="complex"?n=e.__im__.__type__===r.__im__.__type__&&e.__re__.__type__===r.__re__.__type__:n=!0,n&&e.cmp(r)===0)?e.valueOf()===0?Object.is(e.valueOf(),r.valueOf()):!0:!1}else return typeof e=="number"?typeof r!="number"?!1:Number.isNaN(e)?Number.isNaN(r):e===Number.NEGATIVE_INFINITY?r===Number.NEGATIVE_INFINITY:e===Number.POSITIVE_INFINITY?r===Number.POSITIVE_INFINITY:Li(l(e),l(r)):e instanceof pe?r instanceof pe?e.__char__===r.__char__:!1:e===r}function nc(e,r){return Ae(e)!==Ae(r)||!Mi(e)?!1:e instanceof RegExp?e.source===r.source:e instanceof Q?e.valueOf()===r.valueOf():Li(e,r)}function Mi(e){return e instanceof x||Q.isString(e)||$(e)||e===null||e instanceof pe||e instanceof l||e===!0||e===!1}var tc=function(){return Math.trunc?Math.trunc:function(e){return e===0?0:e<0?Math.ceil(e):Math.floor(e)}}();function fe(e,r,n,t){if(typeof this<"u"&&this.constructor!==fe||typeof this>"u")return new fe(e,r);U("Macro",e,"string",1),U("Macro",r,"function",2),n&&(t?this.__doc__=n:this.__doc__=Ti(n)),this.__name__=e,this.__fn__=r}fe.defmacro=function(e,r,n,t){var i=new fe(e,r,n,t);return i.__defmacro__=!0,i};fe.prototype.invoke=function(e,r,n){var t=r.env,i=_n(r,ns),a=se(se({},i),{},{macro_expand:n}),u=this.__fn__.call(t,e,a,this.__name__);return u};fe.prototype.toString=function(){return"#<macro:".concat(this.__name__,">")};var Iu="define-macro";function ic(e){return e.car instanceof x&&C(e.cdr)&&C(e.cdr.car)&&x.is(e.cdr.car.car,"lambda")}function ac(e){return C(e.car)&&e.car.car instanceof x}function uc(e,r,n,t,i){var a=i.use_dynamic,u=i.error,s=fe.defmacro(e,function(o){var f=oc(r,o,this),c={env:f,dynamic_env:f,use_dynamic:a,error:u};if(C(n)){var _=n.reduce(function(m,k){return ie(k,c)});return _e(_,function(m){return ye(m)==="object"&&delete m[dr],m})}},t,!0);return s.__code__=new B(new x("define-macro"),Iu),s}function oc(e,r,n){for(var t=new we({},n,"defmacro"),i=r;!$(e);){if(e instanceof x){t.__env__[e.__name__]=i;break}else $(e.car)||($(i)?t.__env__[e.car.__name__]=te:(C(i.car)&&(i.car[dr]=!0),t.__env__[e.car.__name__]=i.car));if($(e.cdr))break;$(i)||(i=i.cdr),e=e.cdr}return t}var Ba=-1e4;function ja(e){return function(){var r=ke(ae.mark(function n(t,i){var a,u,s,o,f,c,_,m,k,L,b,g,h,v,p,A,O;return ae.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(O=function(){return O=ke(ae.mark(function G(M,W,ce){var y,N,P,R,T,X,j,D,F,z,re,ne,be;return ae.wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if(!(C(M)&&M.car instanceof x)){J.next=50;break}if(!M[dr]){J.next=3;break}return J.abrupt("return",M);case 3:if(y=M.car.valueOf(),N=ce.get(M.car,{throwError:!1}),P=_(y),R=P||k(N,M)||L(N),!(h(y,N)&&!m(y))){J.next=31;break}return T=N instanceof Te?M:M.cdr,J.next=11,N.invoke(T,se(se({},i),{},{env:ce}),!0);case 11:if(X=J.sent,!(N instanceof Te)){J.next=20;break}if(j=X,D=j.expr,F=j.scope,!C(D)){J.next=19;break}if(!(W!==-1&&W<=1||W<Ba)){J.next=17;break}return J.abrupt("return",D);case 17:return W!==-1&&(W=W-1),J.abrupt("return",A(D,W,F));case 19:X=D;case 20:if(!(X instanceof x)){J.next=22;break}return J.abrupt("return",Ve(X));case 22:if(!C(X)){J.next=27;break}if(!(W!==-1&&W<=1||W<Ba)){J.next=25;break}return J.abrupt("return",X);case 25:return W!==-1&&(W=W-1),J.abrupt("return",A(X,W,ce));case 27:if(!Mi(X)){J.next=29;break}return J.abrupt("return",X);case 29:J.next=50;break;case 31:if(!(R&&C(M.cdr.car))){J.next=50;break}if(!P){J.next=39;break}return u=g(M.cdr.car),J.next=36,v(M.cdr.car,W);case 36:z=J.sent,J.next=41;break;case 39:u=b(M.cdr.car),z=M.cdr.car;case 41:return J.t0=B,J.t1=M.car,J.t2=B,J.t3=z,J.next=47,A(M.cdr.cdr,W,ce);case 47:return J.t4=J.sent,J.t5=new J.t2(J.t3,J.t4),J.abrupt("return",new J.t0(J.t1,J.t5));case 50:if(re=M.car,!C(re)){J.next=55;break}return J.next=54,A(re,W,ce);case 54:re=J.sent;case 55:if(ne=M.cdr,!C(ne)){J.next=60;break}return J.next=59,A(ne,W,ce);case 59:ne=J.sent;case 60:return be=new B(re,ne),J.abrupt("return",be);case 62:case"end":return J.stop()}},G)})),O.apply(this,arguments)},A=function(G,M,W){return O.apply(this,arguments)},p=function(){return p=ke(ae.mark(function G(M,W){var ce;return ae.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(!$(M)){N.next=2;break}return N.abrupt("return",te);case 2:return ce=M.car,N.t0=B,N.t1=B,N.t2=ce.car,N.next=8,A(ce.cdr,W,a);case 8:return N.t3=N.sent,N.t4=new N.t1(N.t2,N.t3),N.next=12,v(M.cdr);case 12:return N.t5=N.sent,N.abrupt("return",new N.t0(N.t4,N.t5));case 14:case"end":return N.stop()}},G)})),p.apply(this,arguments)},v=function(G,M){return p.apply(this,arguments)},h=function(G,M){return M instanceof fe&&M.__defmacro__&&!u.includes(G)},g=function(G){return[].concat(ge(u),ge(G.to_array(!1).map(function(M){if(C(M))return M.car.valueOf();var W=Ae(M),ce="macroexpand: Invalid let binding expectig pair got ".concat(W);throw new Error(ce)})))},b=function(G){for(var M=[];!$(G);){if(G instanceof x){M.push(G.valueOf());break}M.push(G.car.valueOf()),G=G.cdr}return[].concat(ge(u),M)},L=function(G){return G===f},k=function(G,M){return G===c&&C(M.cdr.car)},m=function(G){return _(G)?o.includes(a.get(G)):!1},_=function(G){return s.includes(G)},a=i.env=this,u=[],s=["let","let*","letrec","letrec*"],o=s.map(function(K){return H.get(K)}),f=H.get("lambda"),c=H.get("define"),!(C(t.cdr)&&l.isNumber(t.cdr.car))){V.next=23;break}return V.t0=Ve,V.next=21,A(t,t.cdr.car.valueOf(),a);case 21:return V.t1=V.sent.car,V.abrupt("return",(0,V.t0)(V.t1));case 23:if(!e){V.next=29;break}return V.t2=Ve,V.next=27,A(t,1,a);case 27:return V.t3=V.sent.car,V.abrupt("return",(0,V.t2)(V.t3));case 29:return V.t4=Ve,V.next=32,A(t,-1,a);case 32:return V.t5=V.sent.car,V.abrupt("return",(0,V.t4)(V.t5));case 34:case"end":return V.stop()}},n,this)}));return function(n,t){return r.apply(this,arguments)}}()}function Te(e,r){this.__env__=r,this.__fn__=e,this.__defmacro__=!0}Te.__merge_env__=Symbol.for("merge");Te.prototype=Object.create(fe.prototype);Te.prototype.invoke=function(e,r,n){var t=r.error,i=r.env,a=r.use_dynamic,u={error:t,env:i,use_dynamic:a,dynamic_env:this.__env__,macro_expand:n};return this.__fn__.call(i,e,u,this.__name__||"syntax")};Te.prototype.constructor=Te;Te.prototype.toString=function(){return this.__name__?"#<syntax:".concat(this.__name__,">"):"#<syntax>"};var on=yr(function e(r){vr(this,e),Z(this,"_syntax",r,{hidden:!0}),Z(this._syntax,"_param",!0,{hidden:!0})});Te.Parameter=on;function sc(e,r,n,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},a={"...":{symbols:{},lists:[]},symbols:{}},u=i.expansion,s=i.define;Y(n);function o(f,c){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},m=_.ellipsis,k=m===void 0?!1:m,L=_.trailing,b=L===void 0?!1:L,g=_.pattern_names,h=g===void 0?[]:g;if(Y({code:c,pattern:f}),Mi(f)&&!(f instanceof x))return nc(f,c);if(f instanceof x){var v=f.literal();if(n.includes(v)){if(!x.is(c,v)&&!x.is(f,c))return!1;var p=u.ref(v);return!p||p===s||p===H}}if(Array.isArray(f)&&Array.isArray(c)){if(Y("<<< a 1"),f.length===0&&c.length===0)return!0;if(x.is(f[1],t)){if(f[0]instanceof x){var A=f[0].valueOf();if(Y("<<< a 2 "+k),k){var O=c.length-2,S=O>0?c.slice(0,O):c,V=B.fromArray(S,!1);a["..."].symbols[A]?a["..."].symbols[A].append(new B(V,te)):a["..."].symbols[A]=new B(V,te)}else a["..."].symbols[A]=B.fromArray(c,!1)}else if(Array.isArray(f[0])){Y("<<< a 3");var K=ge(h),G=se(se({},_),{},{pattern_names:K,ellipsis:!0});if(!c.every(function(mo){return o(f[0],mo,G)}))return!1}if(f.length>2){var M=f.slice(2);return o(M,c.slice(-M.length),_)}return!0}var W=o(f[0],c[0],_);Y({first:W,pattern:f[0],code:c[0]});var ce=o(f.slice(1),c.slice(1),_);return Y({first:W,rest:ce}),W&&ce}if(C(f)&&C(f.car)&&C(f.car.cdr)&&x.is(f.car.cdr.car,t)&&(Y(">> 0"),$(c)&&(Y({pattern:f}),f.car.car instanceof x))){var y=f.car.car.valueOf();if(a["..."].symbols[y])throw new Error("syntax: named ellipsis can only appear onces");a["..."].symbols[y]=c}if(C(f)&&C(f.cdr)&&x.is(f.cdr.car,t)){if(Y(">> 1 (a)"),!$(f.cdr.cdr)&&C(f.cdr.cdr)){Y(">> 1 (b)");var N=f.cdr.cdr.length(),P=!$(f.last_pair().cdr);if(!C(c))return!1;for(var R=c.length(),T=c,X=1;R-X>N;)T=T.cdr,R--;var j=T.cdr;T.cdr=te;var D=se(se({},_),{},{trailing:P});if(!o(f.cdr.cdr,j,D))return!1}if(f.car instanceof x){var F=f.car.__name__;if(a["..."].symbols[F]&&!h.includes(F)&&!k)throw new Error("syntax: named ellipsis can only appear onces");if(Y(">> 1 (next)"),$(c))Y(">> 2"),k?(Y("NIL"),a["..."].symbols[F]=te):(Y("NULL"),a["..."].symbols[F]=null);else if(C(c)&&(C(c.car)||$(c.car)))if(Y(">> 3 "+k),k)if(a["..."].symbols[F]){var z=a["..."].symbols[F];$(z)?z=new B(te,new B(c,te)):z=z.append(new B(c,te)),a["..."].symbols[F]=z}else a["..."].symbols[F]=new B(c,te);else Y(">> 4"),a["..."].symbols[F]=new B(c,te);else if(Y(">> 6"),C(c)){if(Y(">> 7 "+k),!C(c.cdr)&&!$(c.cdr)){if(Y(">> 7 (b)"),$(f.cdr.cdr))return!1;if(!a["..."].symbols[F])return a["..."].symbols[F]=new B(c.car,te),o(f.cdr.cdr,c.cdr,_)}var re=c.last_pair();if(Y({last_pair:re}),!$(re.cdr)){if(Y(">> 7 (c)"),$(f.cdr.cdr))return!1;Y(">> 7 (d)");var ne=c.clone();return ne.last_pair().cdr=te,a["..."].symbols[F]=ne,o(f.cdr.cdr,re.cdr,_)}if(h.push(F),!a["..."].symbols[F])Y(">> 7 (e)"),a["..."].symbols[F]=new B(c,te);else{Y(">> 7 (f)");var be=a["..."].symbols[F];a["..."].symbols[F]=be.append(new B(c,te))}Y({IIIIII:a["..."].symbols[F]})}else return f.car instanceof x&&C(f.cdr)&&x.is(f.cdr.car,t)?(Y(">> 8"),a["..."].symbols[F]=null,o(f.cdr.cdr,c,_)):(Y(">> 9"),!1);return!0}else if(C(f.car)){var Fe=ge(h);if($(c))return Y(">> 10"),a["..."].lists.push(te),!0;Y(">> 11");for(var J=c,nr=se(se({},_),{},{pattern_names:Fe,ellipsis:!0});C(J);){if(!o(f.car,J.car,nr))return!1;J=J.cdr}return!0}if(Array.isArray(f.car)){for(var Fe=ge(h),Ge=c,tr=se(se({},_),{},{pattern_names:Fe,ellipsis:!0});C(Ge);){if(!o(f.car,Ge.car,tr))return!1;Ge=Ge.cdr}return!0}return!1}if(f instanceof x){if(x.is(f,t))throw new Error("syntax: invalid usage of ellipsis");Y(">> 12");var lr=f.__name__;if(n.includes(lr))return!0;if(k){var Br,Hr;Y(a["..."].symbols[lr]),(Hr=(Br=a["..."].symbols)[lr])!==null&&Hr!==void 0||(Br[lr]=[]),a["..."].symbols[lr].push(c)}else a.symbols[lr]=c;return!0}if(C(f)&&C(c)){Y(">> 13"),Y({a:13,code:c,pattern:f});var je=f.car instanceof x&&f.cdr instanceof x;if(b&&je){if(Y(">> 13 (a)"),!$(c.cdr))return!1;var yn=f.car.valueOf(),Mn=f.cdr.valueOf();return a.symbols[yn]=c.car,a.symbols[Mn]=te,!0}if($(c.cdr)&&(Y(">> 13 (b)"),je)){if(!o(f.car,c.car,_))return!1;Y(">> 14");var br=f.cdr.valueOf();return br in a.symbols||(a.symbols[br]=te),br=f.car.valueOf(),br in a.symbols||(a.symbols[br]=c.car),!0}if(Y({pattern:f,code:c}),C(f.cdr)&&C(f.cdr.cdr)&&f.cdr.car instanceof x&&x.is(f.cdr.cdr.car,t)&&C(f.cdr.cdr.cdr)&&!x.is(f.cdr.cdr.cdr.car,t)&&o(f.car,c.car,_)&&o(f.cdr.cdr.cdr,c.cdr,se(se({},_),{},{trailing:!0}))){var gn=f.cdr.car.__name__;return Y({pattern:f,code:c,name:gn}),n.includes(gn)||(a["..."].symbols[gn]=null),!0}Y("recur"),Y({pattern:f,code:c});var Wi=o(f.car,c.car,_),Ki=o(f.cdr,c.cdr,_);if(Y({$car_code:c.car,$car_pattern:f.car,car:Wi,$cdr_code:c.cdr,$cdr_pattern:f.cdr,cdr:Ki}),Wi&&Ki)return!0}else{if($(f)&&($(c)||c===void 0))return!0;if(C(f.car)&&x.is(f.car.car,t))throw new Error("syntax: invalid usage of ellipsis");return!1}}if(o(e,r))return a}function cc(e,r){function n(t){if(C(t)){if(!r.length)return t;var i=n(t.car),a=n(t.cdr);return new B(i,a)}else if(t instanceof x){var u=r.find(function(s){return s.gensym===t});return u?x(u.name):t}else return t}return n(e)}function fc(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.bindings,n=e.expr,t=e.scope,i=e.symbols,a=e.names,u=e.ellipsis,s={};function o(b){return b instanceof x?!0:["string","symbol"].includes(ye(b))}function f(b){if(!o(b)){var g=Ae(b);throw new Error("syntax: internal error, need symbol got ".concat(g))}var h=b.valueOf();if(h===u)throw new Error("syntax: internal error, ellipis not transformed");var v=ye(h);if(["string","symbol"].includes(v)){if(h in r.symbols)return r.symbols[h];if(v==="string"&&h.match(/\./)){var p=h.split("."),A=p[0];if(A in r.symbols)return B.fromArray([x("."),r.symbols[A]].concat(p.slice(1).map(function(O){return Q(O)})))}}return i.includes(h)?b:c(h,b)}function c(b,g){if(!s[b]){var h=t.ref(b);if(ye(b)==="symbol"&&!h&&(b=g.literal()),s[b])return s[b];var v=Pi(b);if(h){var p=t.get(b);t.set(v,p)}else{var A=t.get(b,{throwError:!1});typeof A<"u"&&t.set(v,A)}if(a.push({name:b,gensym:v}),s[b]=v,typeof b=="string"&&b.match(/\./)){var O=b.split(".").filter(Boolean),S=ut(O),V=S[0],K=S.slice(1);s[V]&&xr(v,"__object__",[s[V]].concat(ge(K)))}}return s[b]}function _(b,g,h){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:function(){},p=h.nested;if(Y({bindings:g,expr:b}),Array.isArray(b)&&!b.length)return b;if(b instanceof x){var A=b.valueOf();if(Ii(b)&&g[A],Y("[t 1"),g[A]){if(C(g[A])){var O=g[A],S=O.car,V=O.cdr;if(p){var K=S.car,G=S.cdr;return $(G)||v(A,new B(G,te)),K}return $(V)||v(A,V),S}else if(g[A]instanceof Array)return v(A,g[A].slice(1)),g[A][0]}return f(b)}var M=Array.isArray(b);if(C(b)||M){var W=M?b[0]:b.car,ce=M?b[1]:C(b.cdr)&&b.cdr.car;if(W instanceof x&&x.is(ce,u)){M?b.slice(2):b.cdr.cdr,Y("[t 2");var y=W.valueOf(),N=g[y];if(N===null)return;if(y in g)if(Y({name:y,binding:g[y]}),C(N)){Y("[t 2 Pair "+p);var P=N.car,R=N.cdr,T=M?b.slice(2):b.cdr.cdr;if(p){if($(R)||(Y("|| next 1"),v(y,R)),M&&T.length||!$(T)&&!M){var X=_(T,g,h,v);if(M)return P.concat(X);if(C(P))return P.append(X);Y("UNKNOWN")}return P}else{if(C(P))return $(P.cdr)||(Y("|| next 2"),v(y,new B(P.cdr,R))),new He(P.car);if($(R))return P;var j=b.last_pair();if(j.cdr instanceof x)return Y("|| next 3"),v(y,N.last_pair()),P}}else if(N instanceof Array){if(Y("[t 2 Array "+p),p)return v(y,N.slice(1)),B.fromArray(N);var D=N.slice(1);return D.length&&v(y,D),N[0]}else return N}Y("[t 3 recur ",b);var F=M?b.slice(1):b.cdr,z=_(W,g,h,v),re=_(F,g,h,v);return Y({head:z,rest:re}),M?[z].concat(re):new B(z,re)}return b}function m(b,g){var h=Object.values(b),v=Object.getOwnPropertySymbols(b);return v.length&&h.push.apply(h,ge(v.map(function(p){return b[p]}))),h.length&&h.every(function(p){return p===null?!g:C(p)||$(p)||Array.isArray(p)&&p.length})}function k(b){return Object.keys(b).concat(Object.getOwnPropertySymbols(b))}function L(b){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=g.disabled;Y("traverse>> ",b);var v=Array.isArray(b);if(v&&b.length===0)return b;if(C(b)||v){Y(">> 0");var p=v?b[0]:b.car,A,O;if(v?(A=b[1],O=b.slice(2)):C(b.cdr)&&(A=b.cdr.car,O=b.cdr.cdr),Y({first:p,second:A,rest_second:O}),!h&&C(p)&&x.is(p.car,u))return new B(p.cdr.car,L(b.cdr));if(A&&x.is(A,u)&&!h){Y(">> 1");var S=r["..."].symbols,V=Object.values(S);if(V.length&&V.every(function(lr){return lr===null}))return Y(">>> 1 (a)"),L(O,{disabled:h});var K=k(S),G=p instanceof x&&x.is(O.car,u);if(C(p)||G){if(Y(">>> 1 (b)"),$(r["..."].lists[0]))return G?(Y(O),te):L(O,{disabled:h});var M=p;G&&(Y(">>> 1 (c)"),M=new B(p,new B(A,te))),Y(">> 2");var W;if(K.length){Y(">> 2 (a)");var ce=se({},S);W=v?[]:te;for(var y=function(){if(Y({bind:ce}),!m(ce))return 1;var Br={},Hr=function(br,gn){Br[br]=gn},je=_(M,ce,{nested:!0},Hr);if(je!==void 0)if(je instanceof He&&(je=je.valueOf()),G)if(v)if(Array.isArray(je)){var yn;(yn=W).push.apply(yn,ge(je))}else Y("ZONK {1}");else $(W)?W=je:W=W.append(je);else v?W.push(je):W=new B(je,W);ce=Br};!y(););if(!$(W)&&!G&&!v&&(W=W.reverse()),v){if(O){Y({rest_second:O,expr:b});var N=L(O,{disabled:h});return W.concat(N)}return W}if(!$(b.cdr.cdr)&&!x.is(b.cdr.cdr.car,u)){var P=L(b.cdr.cdr,{disabled:h});return W.append(P)}return W}else{Y(">> 3");var R=_(p,S,{nested:!0});return R?(R instanceof He&&(R=R.valueOf()),new B(R,te)):te}}else if(p instanceof x){Y(">> 4"),x.is(O.car,u)?Y(">> 4 (a)"):Y(">> 4 (b)");var T=p.__name__,X=Mr({},T,S[T]);Y({bind:X});for(var j=S[T]===null,D=v?[]:te,F=function(){if(!m(X,!0))return Y({bind:X}),1;var Br={},Hr=function(Mn,br){Br[Mn]=br},je=_(b,X,{nested:!1},Hr);Y({value:je}),typeof je<"u"&&(je instanceof He&&(je=je.valueOf()),v?D.push(je):D=new B(je,D)),X=Br};!F(););if(!$(D)&&!v&&(D=D.reverse()),C(b.cdr)&&(C(b.cdr.cdr)||b.cdr.cdr instanceof x)){var z=L(b.cdr.cdr,{disabled:h});if(Y({node:z}),j)return z;$(D)?D=z:D.append(z),Y({result:D,node:z})}return Y("<<<< 2"),Y({result:D}),D}}var re=L(p,{disabled:h}),ne,be;if(p instanceof x){var Fe=t.get(p,{throwError:!1});be=Fe instanceof fe&&Fe.__name__==="syntax-rules"}return be?(b.cdr.car instanceof x?ne=new B(L(b.cdr.car,{disabled:h}),new B(b.cdr.cdr.car,L(b.cdr.cdr.cdr,{disabled:h}))):ne=new B(b.cdr.car,L(b.cdr.cdr,{disabled:h})),Y("REST >>>> ",ne)):ne=L(b.cdr,{disabled:h}),Y({a:!0,car:ze(b.car),cdr:ze(b.cdr),head:ze(re),rest:ze(ne)}),new B(re,ne)}if(b instanceof x){if(h&&x.is(b,u))return b;var J=Object.keys(r["..."].symbols),nr=b.literal();if(J.includes(nr)){var Ge="missing ellipsis symbol next to name `".concat(nr,"'");throw new Error("syntax-rules: ".concat(Ge))}var tr=f(b);if(typeof tr<"u")return tr}return b}return L(n,{})}function Lr(e){return Ui(e)||$(e)||e===null}function $(e){return e===te}function he(e){return typeof e=="function"&&typeof e.bind=="function"}function Pu(e){return Eu.includes(e)}function xn(e){return e===!1||e===null}function Nu(e){return typeof e=="string"}function qr(e){return e&&e[Vu]}function lc(e){return e&&e[gc]}function Tu(e){return qr(e)&&!e[$u]&&!lc(e)&&!qu(e)}function kt(e){var r=Symbol.for("__native__");return he(e)&&e.toString().match(/\{\s*\[native code\]\s*\}/)&&(e.name.match(/^bound /)&&e[r]===!0||!e.name.match(/^bound /)&&!e[r])}function Zn(e){return e&&ye(e)==="object"&&e.hasOwnProperty&&e.hasOwnProperty("constructor")&&typeof e.constructor=="function"&&e.constructor.prototype===e}function Ri(e){return e instanceof to}function Ia(e){return e instanceof jt}function sn(e){return e instanceof Bt}function C(e){return e instanceof B}function qi(e){return e instanceof we}function Pa(e){return he(e)||Ri(e)||sn(e)||_c(e)}function _c(e){return e instanceof fe||e instanceof on}function Ke(e){return e instanceof Pe?!1:e instanceof Promise?!0:!!e&&he(e.then)}function Ui(e){return typeof e>"u"}function hc(e){return Object.getPrototypeOf(e)}function mt(e,r){if(Na(e,r)||Na(hc(e),r))return he(e[r])}function Lu(e){return!e||ye(e)!=="object"?!1:e.__instance__?(e.__instance__=!1,e.__instance__):!1}function pc(e){var r=ye(e);return["string","function"].includes(r)||ye(e)==="symbol"||e instanceof Pe||e instanceof x||e instanceof l||e instanceof Q||e instanceof RegExp}function Mu(e){return e&&(e instanceof l||e instanceof Q||e instanceof pe)}function Na(e,r){return e===null?!1:ye(e)==="object"&&r in Object.getOwnPropertySymbols(e)}function zi(e){switch(ye(e)){case"string":return Q(e);case"bigint":return l(e);case"number":return Number.isNaN(e)?gt:l(e)}return e}function Ru(e,r){var n=Object.getOwnPropertyNames(e),t=Object.getOwnPropertySymbols(e),i={};return n.concat(t).forEach(function(a){var u=r(e[a]);i[a]=u}),i}function Ur(e){var r=[Q,l,pe].some(function(n){return e instanceof n});return r?e.valueOf():e instanceof Array?e.map(Ur):(e instanceof Pe&&delete e.then,sr(e)?Ru(e,Ur):e)}function vt(e,r){return C(e)?(e.mark_cycles(),Ve(e)):he(e)&&r?dc(e,r):zi(e)}function Qe(e){return $i(e)?e[zu]:e}function dc(e,r){if(e[Symbol.for("__bound__")])return e;var n=e.bind(r),t=Object.getOwnPropertyNames(e),i=Or(t),a;try{for(i.s();!(a=i.n()).done;){var u=a.value;if(wc(u))try{n[u]=e[u]}catch{}}}catch(s){i.e(s)}finally{i.f()}return xr(n,"__fn__",e),xr(n,"__context__",r),xr(n,"__bound__",!0),kt(e)&&xr(n,"__native__",!0),sr(r)&&qr(e)&&xr(n,"__method__",!0),n.valueOf=function(){return e},n}function mc(e){return $i(e)&&e[Symbol.for("__context__")]===Object}function $i(e){return!!(he(e)&&e[zu])}function vc(e){if(he(e)){var r=e[Uu];if(r&&(r===mr||r.constructor&&r.constructor.__class__))return!0}return!1}function et(e){return e instanceof Ye||e instanceof $e}function qu(e){return!!(he(e)&&et(e[Uu]))}var Uu=Symbol.for("__context__"),zu=Symbol.for("__fn__"),dr=Symbol.for("__data__"),an=Symbol.for("__ref__"),Ue=Symbol.for("__cycles__"),yc=Symbol.for("__class__"),gc=Symbol.for("__method__"),$u=Symbol.for("__prototype__"),Vu=Symbol.for("__lambda__"),bc=["name","length","caller","callee","arguments","prototype"];function wc(e){return!bc.includes(e)}function cr(e,r,n){Object.defineProperty(e,r,{value:n,enumerable:!0})}function xr(e,r,n){Object.defineProperty(e,Symbol.for(r),{get:function(){return n},set:function(){},configurable:!1,enumerable:!1})}function Dc(e,r){try{return Object.defineProperty(e,"length",{get:function(){return r}}),e}catch{var n=new Array(r).fill(0).map(function(a,u){return"a"+u}).join(","),t=new Function("f","return function(".concat(n,`) {
                return f.apply(this, arguments);
            };`));return t(e)}}function Vn(e){var r;switch(e){case Symbol.for("letrec"):r="letrec";break;case Symbol.for("let"):r="let";break;case Symbol.for("let*"):r="let*";break;default:throw new Error("Invalid let_macro value")}return fe.defmacro(r,function(n,t){var i=t.dynamic_env,a=t.error,u=t.macro_expand,s=t.use_dynamic,o;if(n.car instanceof x){if(!(C(n.cdr.car)||$(n.cdr.car)))throw new Error("let require list of pairs");var f;return $(n.cdr.car)?(o=te,f=te):(f=n.cdr.car.map(function(h){return h.car}),o=n.cdr.car.map(function(h){return h.cdr.car})),new B(B.fromArray([x("letrec"),[[n.car,B(x("lambda"),B(f,n.cdr.cdr))]],n.car]),o)}else if(u)return;var c=this;o=H.get("list->array")(n.car);var _=c.inherit(r),m,k;r==="let*"?k=_:r==="let"&&(m=[]);var L=0;function b(){var h=si([_],n.cdr);return ie(h,{env:_,dynamic_env:_,use_dynamic:s,error:a})}function g(h){if(h in _.__env__)throw new Error("Duplicated let variable ".concat(h))}return function h(){var v=o[L++];if(i=r==="let*"?_:c,v){r==="let"?k=c:r==="letrec"&&(k=_);var M=ie(v.cdr.car,{env:k,dynamic_env:i,use_dynamic:s,error:a});return r==="let*"&&(k=_=k.inherit("let*["+L+"]")),m?(m.push({name:v.car,value:M}),h()):_e(M,function(W){return _.set(v.car,W),h()})}else{if(m&&m.length){var p=m.map(function(W){return W.value}),A=p.filter(Ke);if(A.length)return pn(p).then(function(W){for(var ce=0,y=W.length;ce<y;++ce){var N=m[ce].name;g(N),_.set(N,W[ce])}}).then(b);var O=Or(m),S;try{for(O.s();!(S=O.n()).done;){var V=S.value,K=V.name,G=V.value;g(K),_.set(K,G)}}catch(W){O.e(W)}finally{O.f()}}return b()}}()})}function xc(e,r){return new fe(e,function(n){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.use_dynamic,a=t.error,u=this,s=this,o=[],f=n;C(f);)o.push(ie(f.car,{env:u,dynamic_env:s,use_dynamic:i,error:a})),f=f.cdr;var c=o.filter(Ke).length;return c?pn(o).then(r.bind(this)):r.call(this,o)})}function Ec(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),t=1;t<r;t++)n[t-1]=arguments[t];return n.forEach(function(i){U("",i,"number")}),e.apply(void 0,n)}function Hu(){for(var e=this,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return n.forEach(function(i,a){U("pipe",i,"function",a+1)}),function(){for(var i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];return n.reduce(function(s,o){return[o.apply(e,s)]},a)[0]}}function Yu(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach(function(t,i){U("compose",t,"function",i+1)}),Hu.apply(void 0,ge(r.reverse()))}function Ta(e,r){var n=this;return function t(i,a){U(e,i,"function");for(var u=arguments.length,s=new Array(u>2?u-2:0),o=2;o<u;o++)s[o-2]=arguments[o];return s.some(Lr)?typeof a=="number"?l(a):a:r.call.apply(r,[n,t,i,a].concat(s))}}function Gu(e,r){return Ac(e+1,Ct(Ec,r))}var rn=Ct(Gu,1),rt=Ct(Gu,2);function La(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return function(){for(var n=arguments.length,t=new Array(n),i=0;i<n;i++)t[i]=arguments[i];return r!==null&&(t=[r].concat(ge(t))),t.reduce(rt(e))}}function Ct(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),t=1;t<r;t++)n[t-1]=arguments[t];U("curry",e,"function");var i=e.length;return function(){var a=this,u=n.slice(),s=function(){return function(){for(var o=arguments.length,f=new Array(o),c=0;c<o;c++)f[c]=arguments[c];return u=u.concat(f),u.length>=i?e.apply(a,u):s}}();return s.apply(void 0,arguments)}}function Ac(e,r){return U("limit",r,"function",2),function(){for(var n=arguments.length,t=new Array(n),i=0;i<n;i++)t[i]=arguments[i];return r.apply(void 0,ge(t.slice(0,e)))}}function pe(e){if(typeof this<"u"&&!(this instanceof pe)||typeof this>"u")return new pe(e);e instanceof Q&&(e=e.valueOf());var r;if(Array.from(e).length>1)if(e=e.toLowerCase(),pe.__names__[e])r=e,e=pe.__names__[e];else throw new Error("Internal: Unknown named character");else r=pe.__rev_names__[e];cr(this,"__char__",e),r&&cr(this,"__name__",r)}pe.is=function(e,r){return e instanceof pe&&e.__char__===r};pe.__names__=pu;pe.__rev_names__={};Object.keys(pe.__names__).forEach(function(e){var r=pe.__names__[e];pe.__rev_names__[r]=e});pe.prototype.toUpperCase=function(){return pe(this.__char__.toUpperCase())};pe.prototype.toLowerCase=function(){return pe(this.__char__.toLowerCase())};pe.prototype.toString=function(){return"#\\"+(this.__name__||this.__char__)};pe.prototype.valueOf=pe.prototype.serialize=function(){return this.__char__};function Q(e){if(typeof this<"u"&&!(this instanceof Q)||typeof this>"u")return new Q(e);e instanceof Array?this.__string__=e.map(function(r,n){return U("LString",r,"character",n+1),r.toString()}).join(""):this.__string__=e.valueOf()}{Ma=["length","constructor"],Ra=Object.getOwnPropertyNames(String.prototype).filter(function(e){return!Ma.includes(e)}),qa=function(r){return function(){for(var n=arguments.length,t=new Array(n),i=0;i<n;i++)t[i]=arguments[i];return r.apply(this.__string__,t)}},En=Or(Ra);try{for(En.s();!(Yt=En.n()).done;)Gt=Yt.value,Q.prototype[Gt]=qa(String.prototype[Gt])}catch(e){En.e(e)}finally{En.f()}}var Ma,Ra,qa,En,Yt,Gt;Q.prototype[Symbol.iterator]=ae.mark(function e(){var r,n,t,i;return ae.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:r=Array.from(this.__string__),n=0,t=r;case 2:if(!(n<t.length)){u.next=9;break}return i=t[n],u.next=6,pe(i);case 6:n++,u.next=2;break;case 9:case"end":return u.stop()}},e,this)});Q.prototype.serialize=function(){return this.valueOf()};Q.is=function(e,r){return e instanceof Q&&e.__string__===r};Q.isString=function(e){return e instanceof Q||typeof e=="string"};Q.prototype.freeze=function(){var e=this.__string__;delete this.__string__,Z(this,"__string__",e)};Q.prototype.get=function(e){return U("LString::get",e,"number"),Array.from(this.__string__)[e.valueOf()]};Q.prototype.cmp=function(e){U("LString::cmp",e,"string");var r=this.valueOf(),n=e.valueOf();return r<n?-1:r===n?0:1};Q.prototype.lower=function(){return Q(this.__string__.toLowerCase())};Q.prototype.upper=function(){return Q(this.__string__.toUpperCase())};Q.prototype.set=function(e,r){U("LString::set",e,"number"),U("LString::set",r,["string","character"]),e=e.valueOf(),r instanceof pe&&(r=r.__char__);var n=[];e>0&&n.push(this.__string__.substring(0,e)),n.push(r),e<this.__string__.length-1&&n.push(this.__string__.substring(e+1)),this.__string__=n.join("")};Object.defineProperty(Q.prototype,"length",{get:function(){return this.__string__.length}});Q.prototype.clone=function(){return Q(this.valueOf())};Q.prototype.fill=function(e){U("LString::fill",e,["string","character"]),e instanceof pe&&(e=e.valueOf());var r=this.__string__.length;this.__string__=e.repeat(r)};function l(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e instanceof l)return e;if(typeof this<"u"&&!(this instanceof l)||typeof this>"u")return new l(e,r);if(typeof e>"u")throw new Error("Invalid LNumber constructor call");var n=l.getType(e);if(l.types[n])return l.types[n](e,r);var t=e instanceof Array&&Q.isString(e[0])&&l.isNumber(e[1]);if(e instanceof l)return l(e.value);if(!l.isNumber(e)&&!t)throw new Error("You can't create LNumber from ".concat(Ae(e)));e===null&&(e=0);var i;if(t){var a=e,u=ve(a,2),s=u[0],o=u[1];s instanceof Q&&(s=s.valueOf()),o instanceof l&&(o=o.valueOf());var f=s.match(/^([+-])/),c=!1;f&&(s=s.replace(/^[+-]/,""),f[1]==="-"&&(c=!0))}if(Number.isNaN(e))return ue(e);if(t&&Number.isNaN(parseInt(s,o)))return gt;if(typeof BigInt<"u"){if(typeof e!="bigint"){if(t){var _;switch(o){case 8:_="0o";break;case 16:_="0x";break;case 2:_="0b";break;case 10:_="";break}if(typeof _>"u"){var m=BigInt(o);i=ge(s).map(function(k,L){return BigInt(parseInt(k,o))*Ot(m,BigInt(L))}).reduce(function(k,L){return k+L})}else i=BigInt(_+s)}else i=BigInt(e);c&&(i*=BigInt(-1))}else i=e;return De(i,!0)}else{if(typeof pr<"u"&&!(e instanceof pr))return e instanceof Array?De(at(pr,ge(e))):De(new pr(e));t?this.constant(parseInt(s,o),"integer"):this.constant(e,"integer")}}l.prototype.constant=function(e,r){cr(this,"__value__",e),cr(this,"__type__",r)};l.types={float:function(r){return new ue(r)},complex:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return l.isComplex(r)||(r={im:0,re:r}),new oe(r,n)},rational:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return l.isRational(r)||(r={num:r,denom:1}),new le(r,n)}};l.prototype.serialize=function(){return this.__value__};l.prototype.isNaN=function(){return Number.isNaN(this.__value__)};l.prototype.gcd=function(e){var r=this.abs();if(e=e.abs(),e.cmp(r)===1){var n=r;r=e,e=n}for(;;){if(r=r.rem(e),r.cmp(0)===0)return e;if(e=e.rem(r),e.cmp(0)===0)return r}};l.isFloat=function(r){return r instanceof ue||Number(r)===r&&r%1!==0};l.isNumber=function(e){return e instanceof l||l.isNative(e)||l.isBN(e)};l.isComplex=function(e){if(!e)return!1;var r=e instanceof oe||(l.isNumber(e.im)||l.isRational(e.im)||Number.isNaN(e.im))&&(l.isNumber(e.re)||l.isRational(e.re)||Number.isNaN(e.re));return r};l.isRational=function(e){return e?e instanceof le||l.isNumber(e.num)&&l.isNumber(e.denom):!1};l.isInteger=function(e){return!(!(l.isNative(e)||e instanceof l)||l.isFloat(e)||l.isRational(e)||l.isComplex(e))};l.isNative=function(e){return typeof e=="bigint"||typeof e=="number"};l.isBigInteger=function(e){return e instanceof De||typeof e=="bigint"||l.isBN(e)};l.isBN=function(e){return typeof pr<"u"&&e instanceof pr};l.getArgsType=function(e,r){return e instanceof ue||r instanceof ue?ue:e instanceof De||r instanceof De?De:l};l.prototype.toString=function(e){return Number.isNaN(this.__value__)?"+nan.0":e>=2&&e<36?this.__value__.toString(e):this.__value__.toString()};l.prototype.asType=function(e){var r=l.getType(this);return l.types[r]?l.types[r](e):l(e)};l.prototype.isBigNumber=function(){return typeof this.__value__=="bigint"||typeof pr<"u"&&!(this.value instanceof pr)};["floor","ceil","round"].forEach(function(e){l.prototype[e]=function(){return this.float||l.isFloat(this.__value__)?l(Math[e](this.__value__)):l(Math[e](this.valueOf()))}});l.prototype.valueOf=function(){if(l.isNative(this.__value__))return Number(this.__value__);if(l.isBN(this.__value__))return this.__value__.toNumber()};var nt=function(){var e=function(t,i){return[t,i]};return{bigint:{bigint:e,float:function(t,i){return[ue(t.valueOf()),i]},rational:function(t,i){return[{num:t,denom:1},i]},complex:function(t,i){return[{im:0,re:t},i]}},integer:{integer:e,float:function(t,i){return[ue(t.valueOf()),i]},rational:function(t,i){return[{num:t,denom:1},i]},complex:function(t,i){return[{im:0,re:t},i]}},float:{bigint:function(t,i){return[t,i&&ue(i.valueOf())]},integer:function(t,i){return[t,i&&ue(i.valueOf())]},float:e,rational:function(t,i){return[t,i&&ue(i.valueOf())]},complex:function(t,i){return[{re:t,im:ue(0)},i]}},complex:{bigint:r("bigint"),integer:r("integer"),float:r("float"),rational:r("rational"),complex:function(t,i){var a=l.coerce(t.__re__,i.__re__),u=ve(a,2),s=u[0],o=u[1],f=l.coerce(t.__im__,i.__im__),c=ve(f,2),_=c[0],m=c[1];return[{im:_,re:s},{im:m,re:o}]}},rational:{bigint:function(t,i){return[t,i&&{num:i,denom:1}]},integer:function(t,i){return[t,i&&{num:i,denom:1}]},float:function(t,i){return[ue(t.valueOf()),i]},rational:e,complex:function(t,i){return[{im:Pr(t.__type__,i.__im__.__type__,0)[0],re:Pr(t.__type__,i.__re__.__type__,t)[0]},{im:Pr(t.__type__,i.__im__.__type__,i.__im__)[0],re:Pr(t.__type__,i.__re__.__type__,i.__re__)[0]}]}}};function r(n){return function(t,i){return[{im:Pr(n,t.__im__.__type__,0,t.__im__)[1],re:Pr(n,t.__re__.__type__,0,t.__re__)[1]},{im:Pr(n,t.__im__.__type__,0,0)[1],re:Pr(n,i.__type__,0,i)[1]}]}}}();function Pr(e,r,n,t){return nt[e][r](n,t)}l.coerce=function(e,r){var n=l.getType(e),t=l.getType(r);if(nt[n]){if(!nt[n][t])throw new Error("LNumber::coerce unknown rhs type ".concat(t))}else throw new Error("LNumber::coerce unknown lhs type ".concat(n));var i=nt[n][t](e,r);return i.map(function(a){return l(a,!0)})};l.prototype.coerce=function(e){if(!(typeof e=="number"||e instanceof l))throw new Error("LNumber: you can't coerce ".concat(Ae(e)));return typeof e=="number"&&(e=l(e)),l.coerce(this,e)};l.getType=function(e){if(e instanceof l)return e.__type__;if(l.isFloat(e))return"float";if(l.isComplex(e))return"complex";if(l.isRational(e))return"rational";if(typeof e=="number")return"integer";if(typeof BigInt<"u"&&typeof e!="bigint"||typeof pr<"u"&&!(e instanceof pr))return"bigint"};l.prototype.isFloat=function(){return!!(l.isFloat(this.__value__)||this.float)};var Wt={add:"+",sub:"-",mul:"*",div:"/",rem:"%",or:"|",and:"&",neg:"~",shl:">>",shr:"<<"},Wu={};Object.keys(Wt).forEach(function(e){Wu[Wt[e]]=e,l.prototype[e]=function(r){return this.op(Wt[e],r)}});l._ops={"*":function(r,n){return r*n},"+":function(r,n){return r+n},"-":function(r,n){return typeof n>"u"?-r:r-n},"/":function(r,n){return r/n},"%":function(r,n){return r%n},"|":function(r,n){return r|n},"&":function(r,n){return r&n},"~":function(r){return~r},">>":function(r,n){return r>>n},"<<":function(r,n){return r<<n}};l.prototype.op=function(e,r){if(typeof r>"u")return l(l._ops[e](this.valueOf()));if(typeof r=="number"&&(r=l(r)),Number.isNaN(this.__value__)&&!l.isComplex(r)||!l.isComplex(this)&&Number.isNaN(r.__value__))return l(NaN);var n=this.coerce(r),t=ve(n,2),i=t[0],a=t[1];return i._op?i._op(e,a):l(l._ops[e](i,a))};l.prototype.sqrt=function(){var e=this.valueOf();if(this.cmp(0)<0){var r=Math.sqrt(-e);return oe({re:0,im:r})}return l(Math.sqrt(e))};var Ot=function(r,n){return Math.pow(r,n)};try{Kt=new Function("a,b","return a ** b"),Kt(2,2)===4&&(Ot=Kt)}catch{}var Kt;l.prototype.pow=function(e){var r,n=this.coerce(e),t=ve(n,2),i=t[0],a=t[1];if(l.isNative(i.__value__)&&l.isNative(a.__value__))r=Ot(i.__value__,a.__value__);else if(l.isBN(i.__value__)&&l.isBN(a.__value__))r=this.__value__.pow(e.__value__);else if(i.pow)return i.pow(a);return l(r)};l.prototype.abs=function(){var e=this.__value__;return l.isNative(this.__value__)?e<0&&(e=-e):l.isBN(e)&&e.iabs(),new l(e)};l.prototype.isOdd=function(){if(l.isNative(this.__value__)){if(this.isBigNumber())return this.__value__%BigInt(2)===BigInt(1);if(this.__type__==="float")throw new Error("Invalid number float");return this.__value__%2===1}else if(l.isBN(this.__value__))return this.__value__.isOdd();throw new Error("Invalid number ".concat(this.__type__))};l.prototype.isEven=function(){return!this.isOdd()};l.prototype.cmp=function(e){var r=this.coerce(e),n=ve(r,2),t=n[0],i=n[1];function a(u,s){return u.__value__<s.__value__?-1:u.__value__===s.__value__?0:1}if(t.__type__==="bigint"){if(l.isNative(t.__value__))return a(t,i);if(l.isBN(t.__value__))return this.__value__.cmp(i.__value__)}else if(t instanceof ue)return a(t,i)};function oe(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(typeof this<"u"&&!(this instanceof oe)||typeof this>"u")return new oe(e,r);if(e instanceof oe)return oe({im:e.__im__,re:e.__re__});if(l.isNumber(e)&&r){if(!r)return Number(e)}else if(!l.isComplex(e)){var n="Invalid constructor call for LComplex expect &(:im <num> :re <num>) object but got ".concat(toString(e));throw new Error(n)}var t=e.im instanceof l?e.im:l(e.im),i=e.re instanceof l?e.re:l(e.re);this.constant(t,i)}oe.prototype=Object.create(l.prototype);oe.prototype.constructor=oe;oe.prototype.constant=function(e,r){cr(this,"__im__",e),cr(this,"__re__",r),cr(this,"__type__","complex")};oe.prototype.abs=function(){return l(this.modulus())};oe.prototype.serialize=function(){return{re:this.__re__,im:this.__im__}};oe.prototype.toRational=function(e){var r=this.__im__,n=this.__re__;return l.isFloat(this.__im__)&&(r=ue(this.__im__).toRational(e)),l.isFloat(this.__re__)&&(n=ue(this.__re__).toRational(e)),oe({im:r,re:n})};oe.prototype.pow=function(e){if(e.cmp(0),e===0)return l(1);var r=l(Math.atan2(this.__im__.valueOf(),this.__re__.valueOf())),n=l(this.modulus());if(l.isComplex(e)&&e.__im__.cmp(0)!==0){var t=e.mul(Math.log(n.valueOf())).add(oe.i.mul(r).mul(e));if(!l.isComplex(t))return ue(Math.E).pow(t);var i=ue(Math.E).pow(t.__re__.valueOf());return oe({re:i.mul(Math.cos(t.__im__.valueOf())),im:i.mul(Math.sin(t.__im__.valueOf()))})}var a=e.__re__.cmp(0)>0;if(e=e.__re__.valueOf(),l.isInteger(e)&&a){for(var u=this;--e;)u=u.mul(this);return u}var s=n.pow(e),o=r.mul(e);return oe({re:s.mul(Math.cos(o)),im:s.mul(Math.sin(o))})};oe.prototype.add=function(e){return this.complex_op("add",e,function(r,n,t,i){return{re:r.add(n),im:t.add(i)}})};oe.prototype.factor=function(){if(this.__im__ instanceof ue||this.__im__ instanceof ue){var e=this.__re__,r=this.__im__,n,t;return e instanceof ue?n=e.toRational().mul(e.toRational()):n=e.mul(e),r instanceof ue?t=r.toRational().mul(r.toRational()):t=r.mul(r),n.add(t)}else return this.__re__.mul(this.__re__).add(this.__im__.mul(this.__im__))};oe.prototype.modulus=function(){return this.factor().sqrt()};oe.prototype.conjugate=function(){return oe({re:this.__re__,im:this.__im__.sub()})};oe.prototype.sqrt=function(){var e=this.modulus(),r,n;return e.cmp(0)===0?r=n=e:this.__re__.cmp(0)===1?(r=ue(.5).mul(e.add(this.__re__)).sqrt(),n=this.__im__.div(r).div(2)):(n=ue(.5).mul(e.sub(this.__re__)).sqrt(),this.__im__.cmp(0)===-1&&(n=n.sub()),r=this.__im__.div(n).div(2)),oe({im:n,re:r})};oe.prototype.div=function(e){if(l.isNumber(e)&&!l.isComplex(e)){e instanceof l||(e=l(e));var r=this.__re__.div(e),n=this.__im__.div(e);return oe({re:r,im:n})}else if(!l.isComplex(e))throw new Error("[LComplex::div] Invalid value");if(this.cmp(e)===0){var t=this.coerce(e),i=ve(t,2),a=i[0],u=i[1],s=a.__im__.div(u.__im__);return s.coerce(u.__re__)[0]}var o=this.coerce(e),f=ve(o,2),c=f[0],_=f[1],m=_.factor(),k=_.conjugate(),L=c.mul(k);if(!l.isComplex(L))return L.div(m);var b=L.__re__.op("/",m),g=L.__im__.op("/",m);return oe({re:b,im:g})};oe.prototype.sub=function(e){return this.complex_op("sub",e,function(r,n,t,i){return{re:r.sub(n),im:t.sub(i)}})};oe.prototype.mul=function(e){return this.complex_op("mul",e,function(r,n,t,i){var a={re:r.mul(n).sub(t.mul(i)),im:r.mul(i).add(n.mul(t))};return a})};oe.prototype.complex_op=function(e,r,n){var t=this,i=function(f,c){var _=n(t.__re__,f,t.__im__,c);return"im"in _&&"re"in _?_.im.cmp(0)===0?_.re:oe(_,!0):_};if(typeof r>"u")return i();if(l.isNumber(r)&&!l.isComplex(r)){r instanceof l||(r=l(r));var a=r.asType(0);r={__im__:a,__re__:r}}else if(!l.isComplex(r))throw new Error("[LComplex::".concat(e,"] Invalid value"));var u=r.__re__ instanceof l?r.__re__:this.__re__.asType(r.__re__),s=r.__im__ instanceof l?r.__im__:this.__im__.asType(r.__im__);return i(u,s)};oe._op={"+":"add","-":"sub","*":"mul","/":"div"};oe.prototype._op=function(e,r){var n=oe._op[e];return this[n](r)};oe.prototype.cmp=function(e){var r=this.coerce(e),n=ve(r,2),t=n[0],i=n[1],a=t.__re__.coerce(i.__re__),u=ve(a,2),s=u[0],o=u[1],f=s.cmp(o);if(f!==0)return f;var c=t.__im__.coerce(i.__im__),_=ve(c,2),m=_[0],k=_[1];return m.cmp(k)};oe.prototype.valueOf=function(){return[this.__re__,this.__im__].map(function(e){return e.valueOf()})};oe.prototype.toString=function(){var e;this.__re__.cmp(0)!==0?e=[ze(this.__re__)]:e=[];var r=this.__im__.valueOf(),n=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY].includes(r),t=ze(this.__im__);if(!n&&!Number.isNaN(r)){var i=this.__im__.cmp(0);i<0||i===0&&this.__im__._minus?e.push("-"):e.push("+"),t=t.replace(/^-/,"")}return e.push(t),e.push("i"),e.join("")};function ue(e){if(typeof this<"u"&&!(this instanceof ue)||typeof this>"u")return new ue(e);if(!l.isNumber(e))throw new Error("Invalid constructor call for LFloat");if(e instanceof l)return ue(e.valueOf());typeof e=="number"&&(Object.is(e,-0)&&Object.defineProperty(this,"_minus",{value:!0}),this.constant(e,"float"))}ue.prototype=Object.create(l.prototype);ue.prototype.constructor=ue;ue.prototype.toString=function(e){if(this.__value__===Number.NEGATIVE_INFINITY)return"-inf.0";if(this.__value__===Number.POSITIVE_INFINITY)return"+inf.0";if(Number.isNaN(this.__value__))return"+nan.0";e&&(e=e.valueOf());var r=this.__value__.toString(e);if(!r.match(/e[+-]?[0-9]+$/i)){var n=r.replace(/^-/,""),t=this.__value__<0?"-":"";if(r.match(/^-?0\.0{3}/)){var i=n.match(/^[.0]+/g)[0].length-1,a=n.replace(/^[.0]+/,"").replace(/^([0-9a-f])/i,"$1.");return"".concat(t).concat(a,"e-").concat(i.toString(e))}if(r.match(/^-?[0-9a-f]{7,}\.?/i)){var u=n.match(/^[0-9a-f]+/gi)[0].length-1,s=n.replace(/\./,"").replace(/^([0-9a-f])/i,"$1.").replace(/0+$/,"").replace(/\.$/,".0");return"".concat(t).concat(s,"e+").concat(u.toString(e))}if(!l.isFloat(this.__value__)){var o=r+".0";return this._minus?"-"+o:o}}return r.replace(/^([0-9]+)e/,"$1.0e")};ue.prototype._op=function(e,r){r instanceof l&&(r=r.__value__);var n=l._ops[e];return e==="/"&&this.__value__===0&&r===0?NaN:ue(n(this.__value__,r))};ue.prototype.toRational=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e===null?Fc(this.__value__.valueOf()):Ku(e.valueOf())(this.__value__.valueOf())};ue.prototype.sqrt=function(){var e=this.valueOf();if(this.cmp(0)<0){var r=ue(Math.sqrt(-e));return oe({re:0,im:r})}return ue(Math.sqrt(e))};ue.prototype.abs=function(){var e=this.valueOf();return e<0&&(e=-e),ue(e)};var Fc=Ku(1e-10);function Ku(e){return function(r){var n=function(a,u,s){var o=function(c,_){return _<a?c:o(_,c%_)};return Number.isNaN(u)||Number.isNaN(s)?NaN:o(Math.abs(u),Math.abs(s))},t=n(e||1e-4,1,r);return le({num:Math.floor(r/t),denom:Math.floor(1/t)})}}function kc(e,r){var n=e.sub(r),t=e.add(r),i;return n.cmp(t)>0?i=tt(t,n):t.cmp(n)<=0?i=n:n.cmp(0)>0?i=tt(n,t):r.cmp(0)<0?i=l(tt(t.sub(),n.sub())).sub():i=l(0),l.isFloat(r)||l.isFloat(e)?ue(i):i}function tt(e,r){var n=l(e).floor(),t=l(r).floor();if(e.cmp(n)<1)return n;if(n.cmp(t)===0){var i=l(1).div(r.sub(t)),a=l(1).div(e.sub(n));return n.add(l(1).div(tt(i,a)))}else return n.add(l(1))}function le(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(typeof this<"u"&&!(this instanceof le)||typeof this>"u")return new le(e,r);if(!l.isRational(e))throw new Error("Invalid constructor call for LRational");var n,t;if(e instanceof le?(n=l(e.__num__),t=l(e.__denom__)):(n=l(e.num),t=l(e.denom)),!r&&t.cmp(0)!==0){var i=n.op("%",t).cmp(0)===0;if(i)return l(n.div(t))}this.constant(n,t)}le.prototype=Object.create(l.prototype);le.prototype.constructor=le;le.prototype.constant=function(e,r){cr(this,"__num__",e),cr(this,"__denom__",r),cr(this,"__type__","rational")};le.prototype.serialize=function(){return{num:this.__num__,denom:this.__denom__}};le.prototype.pow=function(e){if(l.isRational(e))return l(Ot(this.valueOf(),e.valueOf()));var r=e.cmp(0);if(r===0)return l(1);if(r===-1){e=e.sub();var n=this.__denom__.pow(e),t=this.__num__.pow(e);return le({num:n,denom:t})}var i=this;for(e=e.valueOf();e>1;)i=i.mul(this),e--;return i};le.prototype.sqrt=function(){var e=this.__num__.sqrt(),r=this.__denom__.sqrt();return e instanceof ue||r instanceof ue?e.div(r):le({num:e,denom:r})};le.prototype.abs=function(){var e=this.__num__,r=this.__denom__;return e.cmp(0)===-1&&(e=e.sub()),r.cmp(0)!==1&&(r=r.sub()),le({num:e,denom:r})};le.prototype.cmp=function(e){return l(this.valueOf(),!0).cmp(e)};le.prototype.toString=function(){var e=this.__num__.gcd(this.__denom__),r,n;e.cmp(1)!==0?(r=this.__num__.div(e),r instanceof le&&(r=l(r.valueOf(!0))),n=this.__denom__.div(e),n instanceof le&&(n=l(n.valueOf(!0)))):(r=this.__num__,n=this.__denom__);var t=this.cmp(0)<0;if(t){if(r.abs().cmp(n.abs())===0)return r.toString()}else if(r.cmp(n)===0)return r.toString();return r.toString()+"/"+n.toString()};le.prototype.valueOf=function(e){return this.__denom__.cmp(0)===0?this.__num__.cmp(0)<0?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:e?l._ops["/"](this.__num__.value,this.__denom__.value):ue(this.__num__.valueOf()).div(this.__denom__.valueOf())};le.prototype.mul=function(e){if(e instanceof l||(e=l(e)),l.isRational(e)){var r=this.__num__.mul(e.__num__),n=this.__denom__.mul(e.__denom__);return le({num:r,denom:n})}var t=l.coerce(this,e),i=ve(t,2),a=i[0],u=i[1];return a.mul(u)};le.prototype.div=function(e){if(e instanceof l||(e=l(e)),l.isRational(e)){var r=this.__num__.mul(e.__denom__),n=this.__denom__.mul(e.__num__);return le({num:r,denom:n})}var t=l.coerce(this,e),i=ve(t,2),a=i[0],u=i[1],s=a.div(u);return s};le.prototype._op=function(e,r){return this[Wu[e]](r)};le.prototype.sub=function(e){if(typeof e>"u")return this.mul(-1);if(e instanceof l||(e=l(e)),l.isRational(e)){var r=e.__num__.sub(),n=e.__denom__;return this.add(le({num:r,denom:n}))}e instanceof l?e=e.sub():e=l(e).sub();var t=l.coerce(this,e),i=ve(t,2),a=i[0],u=i[1];return a.add(u)};le.prototype.add=function(e){if(e instanceof l||(e=l(e)),l.isRational(e)){var r=this.__denom__,n=e.__denom__,t=this.__num__,i=e.__num__,a,u;return r!==n?(u=n.mul(t).add(i.mul(r)),a=r.mul(n)):(u=t.add(i),a=r),le({num:u,denom:a})}if(l.isFloat(e))return ue(this.valueOf()).add(e);var s=l.coerce(this,e),o=ve(s,2),f=o[0],c=o[1];return f.add(c)};function De(e,r){if(typeof this<"u"&&!(this instanceof De)||typeof this>"u")return new De(e,r);if(e instanceof De)return De(e.__value__,e._native);if(!l.isBigInteger(e))throw new Error("Invalid constructor call for LBigInteger");this.constant(e,"bigint"),Object.defineProperty(this,"_native",{value:r})}De.prototype=Object.create(l.prototype);De.prototype.constructor=De;De.bn_op={"+":"iadd","-":"isub","*":"imul","/":"idiv","%":"imod","|":"ior","&":"iand","~":"inot","<<":"ishrn",">>":"ishln"};De.prototype.serialize=function(){return this.__value__.toString()};De.prototype._op=function(e,r){if(typeof r>"u")return l.isBN(this.__value__)?(e=De.bn_op[e],De(this.__value__.clone()[e](),!1)):De(l._ops[e](this.__value__),!0);if(l.isBN(this.__value__)&&l.isBN(r.__value__))return e=De.bn_op[e],De(this.__value__.clone()[e](r),!1);var n=l._ops[e](this.__value__,r.__value__);if(e==="/"){var t=this.op("%",r).cmp(0)===0;return t?l(n):le({num:this,denom:r})}return De(n,!0)};De.prototype.sqrt=function(){var e,r=this.cmp(0)<0;return l.isNative(this.__value__)?e=l(Math.sqrt(r?-this.valueOf():this.valueOf())):l.isBN(this.__value__)&&(e=r?this.__value__.neg().sqrt():this.__value__.sqrt()),r?oe({re:0,im:e}):e};l.NaN=l(NaN);oe.i=oe({im:1,re:0});function Ye(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:H;if(typeof this<"u"&&!(this instanceof Ye)||typeof this>"u")return new Ye(e);U("InputPort",e,"function"),Z(this,"__type__",mn);var t;Object.defineProperty(this,"__parser__",{enumerable:!0,get:function(){return t},set:function(a){U("InputPort::__parser__",a,"parser"),t=a}}),this._read=e,this._with_parser=this._with_init_parser.bind(this,ke(ae.mark(function i(){var a;return ae.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(r.char_ready()){s.next=6;break}return s.next=3,r._read();case 3:a=s.sent,t=new Fr({env:n}),t.prepare(a);case 6:return s.abrupt("return",r.__parser__);case 7:case"end":return s.stop()}},i)}))),this.char_ready=function(){return!!this.__parser__&&this.__parser__.__lexer__.peek()!==Se},this._make_defaults()}Ye.prototype._make_defaults=function(){this.read=this._with_parser(function(e){return e.read_object()}),this.read_line=this._with_parser(function(e){return e.__lexer__.read_line()}),this.read_char=this._with_parser(function(e){return e.__lexer__.read_char()}),this.read_string=this._with_parser(function(e,r){if(!l.isInteger(r)){var n=l.getType(r);Rr("read-string",n,"integer")}return e.__lexer__.read_string(r.valueOf())}),this.peek_char=this._with_parser(function(e){return e.__lexer__.peek_char()})};Ye.prototype._with_init_parser=function(e,r){var n=this;return ke(ae.mark(function t(){var i,a,u,s,o=arguments;return ae.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,e.call(n);case 2:for(i=c.sent,a=o.length,u=new Array(a),s=0;s<a;s++)u[s]=o[s];return c.abrupt("return",r.apply(void 0,[i].concat(u)));case 5:case"end":return c.stop()}},t)}))};Ye.prototype.is_open=function(){return this._with_parser!==null};Ye.prototype.close=function(){var e=this;this.__parser__=null,this._with_parser=null,["read","close","read_char","peek-char","read_line"].forEach(function(r){e[r]=function(){throw new Error("input-port: port is closed")}}),this.char_ready=function(){return!1}};Ye.prototype.toString=function(){return"#<input-port>"};function $e(e){if(typeof this<"u"&&!(this instanceof $e)||typeof this>"u")return new $e(e);U("OutputPort",e,"function"),Z(this,"__type__",mn),this.write=e}$e.prototype.is_open=function(){return this._closed!==!0};$e.prototype.close=function(){Object.defineProperty(this,"_closed",{get:function(){return!0},set:function(){},configurable:!1,enumerable:!1}),this.write=function(){throw new Error("output-port: port is closed")}};$e.prototype.flush=function(){};$e.prototype.toString=function(){return"#<output-port>"};var yt=function(e){function r(n){var t;return vr(this,r),t=xi(this,r,[function(){var i;return(i=t)._write.apply(i,arguments)}]),U("BufferedOutputPort",n,"function"),Z(t,"_fn",n,{hidden:!0}),Z(t,"_buffer",[],{hidden:!0}),t}return vi(r,e),yr(r,[{key:"flush",value:function(){this._buffer.length&&(this._fn(this._buffer.join("")),this._buffer.length=0)}},{key:"_write",value:function(){for(var t=this,i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];if(a.length){a.forEach(function(o){t._buffer.push(o)});var s=this._buffer[this._buffer.length-1];s.match(/\n$/)&&(this._buffer[this._buffer.length-1]=s.replace(/\n$/,""),this.flush())}}}])}($e);function kr(e){var r=this;if(typeof this<"u"&&!(this instanceof kr)||typeof this>"u")return new kr(e);U("OutputStringPort",e,"function"),Z(this,"__type__",mn),Z(this,"__buffer__",[]),this.write=function(n){Q.isString(n)?n=n.valueOf():n=e(n),r.__buffer__.push(n)}}kr.prototype=Object.create($e.prototype);kr.prototype.constructor=kr;kr.prototype.toString=function(){return"#<output-port (string)>"};kr.prototype.valueOf=function(){return this.__buffer__.map(function(e){return e.valueOf()}).join("")};function ur(e,r){var n=this;if(typeof this<"u"&&!(this instanceof ur)||typeof this>"u")return new ur(e,r);U("OutputFilePort",e,"string"),Z(this,"__filename__",e),Z(this,"_fd",r.valueOf(),{hidden:!0}),Z(this,"__type__",mn),this.write=function(t){Q.isString(t)?t=t.valueOf():t=ze(t),n.fs().write(n._fd,t,function(i){if(i)throw i})}}ur.prototype=Object.create($e.prototype);ur.prototype.constructor=ur;ur.prototype.fs=function(){return this._fs||(this._fs=this.internal("fs")),this._fs};ur.prototype.internal=function(e){return Oe.get("**internal-env**").get(e)};ur.prototype.close=function(){var e=this;return new Promise(function(r,n){e.fs().close(e._fd,function(t){t?n(t):(Z(e,"_fd",null,{hidden:!0}),$e.prototype.close.call(e),r())})})};ur.prototype.toString=function(){return"#<output-port ".concat(this.__filename__,">")};function fr(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:H;if(typeof this<"u"&&!(this instanceof fr)||typeof this>"u")return new fr(e);U("InputStringPort",e,"string"),e=e.valueOf(),this._with_parser=this._with_init_parser.bind(this,function(){return r.__parser__||(r.__parser__=new Fr({env:n}),r.__parser__.prepare(e)),r.__parser__}),Z(this,"__type__",mn),this._make_defaults()}fr.prototype.char_ready=function(){return!0};fr.prototype=Object.create(Ye.prototype);fr.prototype.constructor=fr;fr.prototype.toString=function(){return"#<input-port (string)>"};function zr(e){if(typeof this<"u"&&!(this instanceof zr)||typeof this>"u")return new zr(e);this._with_parser=this._with_init_parser.bind(this,function(){return e}),Z(this,"__type__",mn),this._make_defaults()}zr.prototype.char_ready=function(){return!0};zr.prototype=Object.create(Ye.prototype);zr.prototype.constructor=zr;zr.prototype.toString=function(){return"#<input-port (parser)>"};function Je(e){if(typeof this<"u"&&!(this instanceof Je)||typeof this>"u")return new Je(e);U("InputByteVectorPort",e,"uint8array"),Z(this,"__vector__",e),Z(this,"__type__",St);var r=0;Object.defineProperty(this,"__index__",{enumerable:!0,get:function(){return r},set:function(t){if(U("InputByteVectorPort::__index__",t,"number"),t instanceof l&&(t=t.valueOf()),typeof t=="bigint"&&(t=Number(t)),Math.floor(t)!==t)throw new Error("InputByteVectorPort::__index__ value is not integer");r=t}})}Je.prototype=Object.create(Ye.prototype);Je.prototype.constructor=Je;Je.prototype.toString=function(){return"#<input-port (bytevector)>"};Je.prototype.close=function(){var e=this;Z(this,"__vector__",te);var r=function(){throw new Error("Input-binary-port: port is closed")};["read_u8","close","peek_u8","read_u8_vector"].forEach(function(n){e[n]=r}),this.u8_ready=this.char_ready=function(){return!1}};Je.prototype.u8_ready=function(){return!0};Je.prototype.peek_u8=function(){return this.__index__>=this.__vector__.length?Se:this.__vector__[this.__index__]};Je.prototype.skip=function(){this.__index__<=this.__vector__.length&&++this.__index__};Je.prototype.read_u8=function(){var e=this.peek_u8();return this.skip(),e};Je.prototype.read_u8_vector=function(e){return typeof e>"u"?e=this.__vector__.length:e>this.__index__+this.__vector__.length&&(e=this.__index__+this.__vector__.length),this.peek_u8()===Se?Se:this.__vector__.slice(this.__index__,e)};function or(){if(typeof this<"u"&&!(this instanceof or)||typeof this>"u")return new or;Z(this,"__type__",St),Z(this,"_buffer",[],{hidden:!0}),this.write=function(e){if(U("write",e,["number","uint8array"]),l.isNumber(e))this._buffer.push(e.valueOf());else{var r;(r=this._buffer).push.apply(r,ge(Array.from(e)))}},Object.defineProperty(this,"__buffer__",{enumerable:!0,get:function(){return Uint8Array.from(this._buffer)}})}or.prototype=Object.create($e.prototype);or.prototype.constructor=or;or.prototype.close=function(){$e.prototype.close.call(this),Z(this,"_buffer",null,{hidden:!0})};or.prototype._close_guard=function(){if(this._closed)throw new Error("output-port: binary port is closed")};or.prototype.write_u8=function(e){U("OutputByteVectorPort::write_u8",e,"number"),this.write(e)};or.prototype.write_u8_vector=function(e){U("OutputByteVectorPort::write_u8_vector",e,"uint8array"),this.write(e)};or.prototype.toString=function(){return"#<output-port (bytevector)>"};or.prototype.valueOf=function(){return this.__buffer__};function $r(e,r){if(typeof this<"u"&&!(this instanceof $r)||typeof this>"u")return new $r(e,r);fr.call(this,e),U("InputFilePort",r,"string"),Z(this,"__filename__",r)}$r.prototype=Object.create(fr.prototype);$r.prototype.constructor=$r;$r.prototype.toString=function(){return"#<input-port (".concat(this.__filename__,")>")};function Xr(e,r){if(typeof this<"u"&&!(this instanceof Xr)||typeof this>"u")return new Xr(e,r);Je.call(this,e),U("InputBinaryFilePort",r,"string"),Z(this,"__filename__",r)}Xr.prototype=Object.create(Je.prototype);Xr.prototype.constructor=Xr;Xr.prototype.toString=function(){return"#<input-binary-port (".concat(this.__filename__,")>")};function Cr(e,r){var n=this;if(typeof this<"u"&&!(this instanceof Cr)||typeof this>"u")return new Cr(e,r);U("OutputBinaryFilePort",e,"string"),Z(this,"__filename__",e),Z(this,"_fd",r.valueOf(),{hidden:!0}),Z(this,"__type__",St);var t;this.write=function(i){U("write",i,["number","uint8array"]);var a;return t||(t=n.internal("fs")),l.isNumber(i)?a=new Uint8Array([i.valueOf()]):a=new Uint8Array(Array.from(i)),new Promise(function(u,s){t.write(n._fd,a,function(o){o?s(o):u()})})}}Cr.prototype=Object.create(ur.prototype);Cr.prototype.constructor=Cr;Cr.prototype.write_u8=function(e){U("OutputByteVectorPort::write_u8",e,"number"),this.write(e)};Cr.prototype.write_u8_vector=function(e){U("OutputByteVectorPort::write_u8_vector",e,"uint8array"),this.write(e)};var St=Symbol.for("binary"),mn=Symbol.for("text"),Se=new Vi;function Vi(){}Vi.prototype.toString=function(){return"#<eof>"};function Qr(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=n.stderr,i=n.stdin,a=n.stdout,u=n.command_line,s=u===void 0?null:u,o=_n(n,ts);if(typeof this<"u"&&!(this instanceof Qr)||typeof this>"u")return new Qr(e,se({stdin:i,stdout:a,stderr:t,command_line:s},o));typeof e>"u"&&(e="anonymous"),this.__env__=Oe.inherit(e,o),this.__parser__=new Fr({env:this.__env__}),this.__env__.set("parent.frame",E("parent.frame",function(){return r.__env__},H.__env__["parent.frame"].__doc__));var f="**interaction-environment-defaults**";this.set(f,ju(o).concat(f));var c=Xu.inherit("internal-".concat(e));et(i)&&c.set("stdin",i),et(t)&&c.set("stderr",t),et(a)&&c.set("stdout",a),c.set("command-line",s),Qu(this.__env__,c)}Qr.prototype.exec=function(){var e=ke(function(r){var n=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ae.mark(function i(){var a,u,s,o,f,c;return ae.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(a=t.use_dynamic,u=a===void 0?!1:a,s=t.dynamic_env,o=t.env,U("Interpreter::exec",r,["string","array"],1),U("Interpreter::exec",u,"boolean",2),o||(o=n.__env__),s||(s=o),H.set("**interaction-environment**",n.__env__),!Array.isArray(r)){m.next=10;break}return m.abrupt("return",cn(r,{env:o,dynamic_env:s,use_dynamic:u}));case 10:return m.prev=10,n.__parser__.prepare(r),m.next=14,cn(n.__parser__,{env:o,dynamic_env:s,use_dynamic:u});case 14:return m.abrupt("return",m.sent);case 17:throw m.prev=17,m.t0=m.catch(10),(f=m.t0.message)!==null&&f!==void 0&&f.includes("at line")||(c=" at line ".concat(n.__parser__.get_line()+1),m.t0.message+=c),m.t0;case 21:case"end":return m.stop()}},i,null,[[10,17]])})()});return function(r){return e.apply(this,arguments)}}();Qr.prototype.get=function(e){var r=this.__env__.get(e);if(he(r)){var n=new jt({env:this.__env__});return r.bind(n)}return r};Qr.prototype.set=function(e,r){return this.__env__.set(e,r)};Qr.prototype.constant=function(e,r){return this.__env__.constant(e,r)};function Pn(e,r){this.name="LipsError",this.message=e,this.args=r,this.stack=new Error().stack}Pn.prototype=new Error;Pn.prototype.constructor=Pn;var Cn=function(e){function r(){return vr(this,r),xi(this,r,arguments)}return vi(r,e),yr(r)}(ot(Error));function we(e,r,n){arguments.length===1&&(ye(arguments[0])==="object"?(e=arguments[0],r=null):typeof arguments[0]=="string"&&(e={},r=null,n=arguments[0])),this.__docs__=new Map,this.__env__=e,this.__parent__=r,this.__name__=n||"anonymous"}we.prototype.list=function(){return ju(this.__env__)};we.prototype.fs=function(){return this.get("**fs**")};we.prototype.unset=function(e){e instanceof x&&(e=e.valueOf()),e instanceof Q&&(e=e.valueOf()),delete this.__env__[e]};we.prototype.inherit=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ye(e)==="object"&&(r=e),(!e||ye(e)==="object")&&(e="child of "+(this.__name__||"unknown")),new we(r||{},this,e)};we.prototype.doc=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(e instanceof x&&(e=e.__name__),e instanceof Q&&(e=e.valueOf()),r)return n||(r=Ti(r)),this.__docs__.set(e,r),this;if(this.__docs__.has(e))return this.__docs__.get(e);if(this.__parent__)return this.__parent__.doc(e)};we.prototype.new_frame=function(e,r){var n=this.inherit("__frame__");return n.set("parent.frame",E("parent.frame",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;t=t.valueOf();var i=n.__parent__;if(!qi(i))return te;if(t<=0)return i;var a=i.get("parent.frame");return a(t-1)},H.__env__["parent.frame"].__doc__)),r.callee=e,n.set("arguments",r),n};we.prototype._lookup=function(e){if(e instanceof x&&(e=e.__name__),e instanceof Q&&(e=e.valueOf()),this.__env__.hasOwnProperty(e))return He(this.__env__[e]);if(this.__parent__)return this.__parent__._lookup(e)};we.prototype.toString=function(){return"#<environment:"+this.__name__+">"};we.prototype.clone=function(){var e=this,r={};return Object.keys(this.__env__).forEach(function(n){r[n]=e.__env__[n]}),new we(r,this.__parent__,this.__name__)};we.prototype.merge=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"merge";return U("Environment::merge",e,"environment"),this.inherit(r,e.__env__)};function He(e){if(typeof this<"u"&&!(this instanceof He)||typeof this>"u")return new He(e);this.value=e}He.isUndefined=function(e){return e instanceof He&&typeof e.value>"u"};He.prototype.valueOf=function(){return this.value};function Vr(e){if(e.length){if(e.length===1)return e[0];if(typeof this<"u"&&!(this instanceof Vr)||typeof this>"u")return new Vr(e);this.__values__=e}}Vr.prototype.toString=function(){return this.__values__.map(function(e){return ze(e)}).join(`
`)};Vr.prototype.valueOf=function(){return this.__values__};we.prototype.get=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};U("Environment::get",e,["symbol","string"]);var n=r.throwError,t=n===void 0?!0:n,i=e;(i instanceof x||i instanceof Q)&&(i=i.valueOf());var a=this._lookup(i);if(a instanceof He)return He.isUndefined(a)?void 0:vt(a.valueOf());var u;if(e instanceof x&&e[x.object]?u=e[x.object]:typeof i=="string"&&(u=i.split(".").filter(Boolean)),u&&u.length>0){var s=u,o=ut(s),f=o[0],c=o.slice(1);if(a=this._lookup(f),c.length)try{if(a instanceof He?a=a.valueOf():(a=On(Ar,f),he(a)&&(a=Qe(a))),typeof a<"u")return On.apply(void 0,[a].concat(ge(c)))}catch(_){throw _}else if(a instanceof He)return vt(a.valueOf());a=On(Ar,i)}if(typeof a<"u")return a;if(t)throw new Error("Unbound variable `"+i.toString()+"'")};we.prototype.set=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return U("Environment::set",e,["string","symbol"]),l.isNumber(r)&&(r=l(r)),e instanceof x&&(e=e.__name__),e instanceof Q&&(e=e.valueOf()),this.__env__[e]=r,n&&this.doc(e,n,!0),this};we.prototype.constant=function(e,r){var n=this;if(this.__env__.hasOwnProperty(e))throw new Error("Environment::constant: ".concat(e," already exists"));if(arguments.length===1&&sr(arguments[0])){var t=arguments[0];Object.keys(t).forEach(function(i){n.constant(e,t[i])})}else cr(this.__env__,e,r);return this};we.prototype.has=function(e){return this.__env__.hasOwnProperty(e)};we.prototype.ref=function(e){for(var r=this;r;){if(r.has(e))return r;r=r.__parent__}};we.prototype.parents=function(){for(var e=this,r=[];e;)r.unshift(e),e=e.__parent__;return r};function Ve(e){return Ke(e)?e.then(Ve):((C(e)||e instanceof x)&&(e[dr]=!0),e)}var Cc=Ni(hn(`(lambda ()
                                        "[native code]"
                                        (throw "Invalid Invocation"))`))[0],On=E("get",function(r){for(var n,t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];for(var u=i.length;i.length;){he(r)&&ye(i[0])!=="symbol"&&(r=Qe(r));var s=i.shift(),o=Ur(s);if(o==="then"&&r instanceof Pe?n=Pe.prototype.then:o==="__code__"&&he(r)&&typeof r.__code__>"u"?n=Cc:n=r[o],typeof n>"u"){if(i.length)throw new Error("Try to get ".concat(i[0]," from undefined"));return n}else{var f;i.length-1<u&&(f=r),n=vt(n,f)}r=n}return n},`(. obj . args)
    (get obj . args)

    This function uses an object as a base and keeps using arguments to get the
    property of JavaScript object. Arguments need to be a strings.
    e.g. \`(. console "log")\` if you use any function inside LIPS it
    will be weakly bound (can be rebound), so you can call this log function
    without problem unlike in JavaScript when you use
    \`var log = console.log\`.
    \`get\` is an alias because . doesn't work everywhere, e.g. you can't
    pass it as an argument.`);function Ju(e){return Oc(e,"**internal-env**")}function nn(e,r){var n=Ju(e);return n.get(r)}function Oc(e,r){var n=e.get("**interaction-environment**");return n.get(r)}var Xu=new we({stdout:new yt(function(){var e;(e=console).log.apply(e,arguments)}),stderr:new yt(function(){var e;(e=console).error.apply(e,arguments)}),"command-line":[],stdin:Ye(function(){return Promise.resolve(prompt(""))}),"letter-unicode-regex":/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])/,"numeral-unicode-regex":/(?:[0-9\xB2\xB3\xB9\xBC-\xBE\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u09F4-\u09F9\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0B72-\u0B77\u0BE6-\u0BF2\u0C66-\u0C6F\u0C78-\u0C7E\u0CE6-\u0CEF\u0D58-\u0D5E\u0D66-\u0D78\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F33\u1040-\u1049\u1090-\u1099\u1369-\u137C\u16EE-\u16F0\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1946-\u194F\u19D0-\u19DA\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2CFD\u3007\u3021-\u3029\u3038-\u303A\u3192-\u3195\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\uA620-\uA629\uA6E6-\uA6EF\uA830-\uA835\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]|\uD800[\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDEE1-\uDEFB\uDF20-\uDF23\uDF41\uDF4A\uDFD1-\uDFD5]|\uD801[\uDCA0-\uDCA9]|\uD802[\uDC58-\uDC5F\uDC79-\uDC7F\uDCA7-\uDCAF\uDCFB-\uDCFF\uDD16-\uDD1B\uDDBC\uDDBD\uDDC0-\uDDCF\uDDD2-\uDDFF\uDE40-\uDE48\uDE7D\uDE7E\uDE9D-\uDE9F\uDEEB-\uDEEF\uDF58-\uDF5F\uDF78-\uDF7F\uDFA9-\uDFAF]|\uD803[\uDCFA-\uDCFF\uDD30-\uDD39\uDD40-\uDD49\uDE60-\uDE7E\uDF1D-\uDF26\uDF51-\uDF54\uDFC5-\uDFCB]|\uD804[\uDC52-\uDC6F\uDCF0-\uDCF9\uDD36-\uDD3F\uDDD0-\uDDD9\uDDE1-\uDDF4\uDEF0-\uDEF9]|\uD805[\uDC50-\uDC59\uDCD0-\uDCD9\uDE50-\uDE59\uDEC0-\uDEC9\uDED0-\uDEE3\uDF30-\uDF3B]|\uD806[\uDCE0-\uDCF2\uDD50-\uDD59\uDFF0-\uDFF9]|\uD807[\uDC50-\uDC6C\uDD50-\uDD59\uDDA0-\uDDA9\uDF50-\uDF59\uDFC0-\uDFD4]|\uD809[\uDC00-\uDC6E]|\uD818[\uDD30-\uDD39]|\uD81A[\uDE60-\uDE69\uDEC0-\uDEC9\uDF50-\uDF59\uDF5B-\uDF61]|\uD81B[\uDD70-\uDD79\uDE80-\uDE96]|\uD833[\uDCF0-\uDCF9]|\uD834[\uDEC0-\uDED3\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDFCE-\uDFFF]|\uD838[\uDD40-\uDD49\uDEF0-\uDEF9]|\uD839[\uDCF0-\uDCF9\uDDF1-\uDDFA]|\uD83A[\uDCC7-\uDCCF\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9])/,"space-unicode-regex":/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]/},void 0,"internal"),gt=l(NaN),Ua=se({"#t":!0,"#f":!1,"#true":!0,"#false":!1,"+inf.0":Number.POSITIVE_INFINITY,"-inf.0":Number.NEGATIVE_INFINITY,"+nan.0":gt,"-nan.0":gt},xu),H=new we({eof:Se,undefined:void 0,"peek-char":E("peek-char",function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e===null&&(e=nn(this,"stdin")),Yn("peek-char",e,"input-port"),e.peek_char()},`(peek-char port)

        This function reads and returns a character from the string
        port, or, if there is no more data in the string port, it
        returns an EOF.`),"read-line":E("read-line",function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e===null&&(e=nn(this,"stdin")),Yn("read-line",e,"input-port"),e.read_line()},`(read-line port)

        This function reads and returns the next line from the input
        port.`),"read-char":E("read-char",function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e===null&&(e=nn(this,"stdin")),Yn("read-char",e,"input-port"),e.read_char()},`(read-char port)

        This function reads and returns the next character from the
        input port.`),read:E("read",function(){var e=ke(function(){var n=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return ae.mark(function i(){var a,u;return ae.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a=n.env,t===null?u=nn(a,"stdin"):u=t,Yn("read",u,"input-port"),o.abrupt("return",u.read.call(a));case 4:case"end":return o.stop()}},i)})()});function r(){return e.apply(this,arguments)}return r}(),`(read [port])

        This function, if called with a port, it will parse the next
        item from the port. If called without an input, it will read
        a string from standard input (using the browser's prompt or
        a user defined input method) and parse it. This function can be
        used together with \`eval\` to evaluate code from port.`),pprint:E("pprint",function(r){C(r)?(r=new mr.Formatter(r.toString(!0)).break().format(),H.get("display").call(H,r)):H.get("write").call(H,r),H.get("newline").call(H)},`(pprint expression)

        This function will pretty print its input to stdout. If it is called
        with a non-list, it will just call the print function on its
        input.`),print:E("print",function(){for(var r=H.get("display"),n=H.get("newline"),t=this.use_dynamic,i=H,a=H,u=arguments.length,s=new Array(u),o=0;o<u;o++)s[o]=arguments[o];s.forEach(function(f){un(r,[f],{env:i,dynamic_env:a,use_dynamic:t}),un(n,[],{env:i,dynamic_env:a,use_dynamic:t})})},`(print . args)

        This function converts each input into a string and prints
        the result to the standard output (by default it's the
        console but it can be defined in user code). This function
        calls \`(newline)\` after printing each input.`),format:E("format",function(r){for(var n=arguments.length,t=new Array(n>1?n-1:0),i=1;i<n;i++)t[i-1]=arguments[i];U("format",r,"string");var a=/(~[as%~])/g,u=r.match(/(~[as])/g);if(u&&u.length>t.length)throw new Error("Not enough arguments");var s=0,o=H.get("repr");if(r=r.replace(a,function(f){var c=f[1];if(c==="~")return"~";if(c==="%")return`
`;var _=t[s++];return c==="a"?o(_):o(_,!0)}),u=r.match(/~([\S])/),u)throw new Error("format: Unrecognized escape sequence ".concat(u[1]));return r},`(format string n1 n2 ...)

        This function accepts a string template and replaces any
        escape sequences in its inputs:

        * ~a value as if printed with \`display\`
        * ~s value as if printed with \`write\`
        * ~% newline character
        * ~~ literal tilde '~'

        If there are missing inputs or other escape characters it
        will error.`),newline:E("newline",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=H.get("display"),t=this.use_dynamic,i=H,a=H;un(n,[`
`,r],{env:i,dynamic_env:a,use_dynamic:t})},`(newline [port])

        Write newline character to standard output or given port`),display:E("display",function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;n===null?n=nn(this,"stdout"):U("display",n,"output-port");var t=r;n instanceof Cr||(t=H.get("repr")(r)),n.write.call(H,t)},`(display string [port])

        This function outputs the string to the standard output or
        the port if given. No newline.`),"display-error":E("display-error",function(){for(var r=nn(this,"stderr"),n=H.get("repr"),t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];var u=i.map(n).join(" ");r.write.call(H,u),H.get("newline").call(this,r)},`(display-error . args)

        Display an error message on stderr.`),"%foldcase-string":E("%foldcase-string",Cu,`(%foldcase-string string)

         Same as string-foldcase but without typechecking`),"%same-functions":E("%same-functions",function(e,r){return!he(e)||!he(r)?!1:Qe(e)===Qe(r)},`(%same-functions a b)

        A helper function that checks if the two input functions are
        the same.`),help:E(new fe("help",function(e,r){var n=r.dynamic_env,t=r.use_dynamic,i=r.error,a;if(e.car instanceof x)a=e.car;else if(C(e.car)&&e.car.car instanceof x)a=e.car.car;else{var u=this;n=this;var s=ie(e.car,{env:u,error:i,dynamic_env:n,use_dynamic:t});return s&&s.__doc__?s.__doc__:void 0}var o,f=this.get(a);if(o=f&&f.__doc__,o)return o;var c=this.ref(a);if(c&&(o=c.doc(a),o))return o}),`(help object)

         This macro returns documentation for a function, macro, or a variable.`),cons:E("cons",function(r,n){return new B(r,n)},`(cons left right)

        This function returns a new list with the first appended
        before the second. If the second is not a list cons will
        return a dotted pair.`),car:E("car",function(r){return U("car",r,"pair"),r.car},`(car pair)

        This function returns the car (item 1) of the list.`),cdr:E("cdr",function(r){return U("cdr",r,"pair"),r.cdr},`(cdr pair)

        This function returns the cdr (all but first) of the list.`),"set!":E(new fe("set!",function(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=n.use_dynamic,i=_n(n,is),a=this,u=this,s,o=se(se({},i),{},{env:this,dynamic_env:a,use_dynamic:t}),f=ie(e.cdr.car,o);f=vn(f);function c(g,h,v){return Ke(g)?g.then(function(p){return c(g,p,v)}):Ke(h)?h.then(function(p){return c(g,p,v)}):Ke(v)?v.then(function(p){return c(g,h,p)}):(u.get("set-obj!").call(u,g,h,v),v)}if(C(e.car)&&x.is(e.car.car,".")){var _=e.car.cdr.car,m=e.car.cdr.cdr.car,k=ie(_,o),L=ie(m,o);return c(k,L,f)}if(!(e.car instanceof x))throw new Error("set! first argument need to be a symbol or dot accessor that evaluate to object.");var b=e.car.valueOf();return s=this.ref(e.car.__name__),_e(f,function(g){if(!s){var h=b.split(".");if(h.length>1){var v=h.pop(),p=h.join("."),A=r.get(p,{throwError:!1});if(A){c(A,v,g);return}}throw new Error("Unbound variable `"+b+"'")}s.set(b,g)})}),`(set! name value)

         Macro that can be used to set the value of the variable or slot (mutate it).
         set! searches the scope chain until it finds first non empty slot and sets it.`),"unset!":E(new fe("set!",function(e){if(!(e.car instanceof x))throw new Error("unset! first argument need to be a symbol or dot accessor that evaluate to object.");var r=e.car,n=this.ref(r);n&&delete n.__env__[r.__name__]}),`(unset! name)

         Function to delete the specified name from environment.
         Trying to access the name afterwards will error.`),"set-car!":E("set-car!",function(e,r){U("set-car!",e,"pair"),e.car=r},`(set-car! obj value)

         Function that sets the car (first item) of the list/pair to specified value.
         The old value is lost.`),"set-cdr!":E("set-cdr!",function(e,r){U("set-cdr!",e,"pair"),e.cdr=r},`(set-cdr! obj value)

         Function that sets the cdr (tail) of the list/pair to specified value.
         It will destroy the list. The old tail is lost.`),"empty?":E("empty?",function(e){return typeof e>"u"||$(e)},`(empty? object)

         Function that returns #t if value is nil (an empty list) or undefined.`),gensym:E("gensym",Pi,`(gensym)

         Generates a unique symbol that is not bound anywhere,
         to use with macros as meta name.`),load:E("load",function(r,n){U("load",r,"string");var t=this;t.__name__==="__frame__"&&(t=t.__parent__),n instanceof we||(t===H?n=t:n=this.get("**interaction-environment**"));var i="@lips",a=r.startsWith(i),u="**module-path**",s=H.get(u,{throwError:!1});r=r.valueOf(),r.match(/.[^.]+$/)||(r+=".scm");var o=r.match(/\.xcb$/);function f(g){return o?g=fo(g):(Ae(g)==="buffer"&&(g=g.toString()),g=g.replace(/^(#!.*)/,function(h,v){return Pu(v)?v:""}),g.match(/^\{/)&&(g=oo(g))),cn(g,{env:n})}function c(g){return Ar.fetch(g).then(function(h){return o?h.arrayBuffer():h.text()}).then(function(h){return o&&(h=new Uint8Array(h)),h})}function _(){var g=H.get("__dirname");return g.replace(/[^/]+$/,"")}if(Hi())return new Promise(function(){var g=ke(ae.mark(function h(v,p){var A,O,S,V,K;return ae.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.prev=0,M.next=3,di;case 3:if(A=Nr("path"),O=Nr("fs"),S=_(),a&&(r=r.replace(i,S)),!s){M.next=12;break}s=s.valueOf(),r.startsWith("/")||(r=A.join(s,r)),M.next=19;break;case 12:if(r.startsWith("/")){M.next=19;break}if(V=t.get("command-line",{throwError:!1}),!V){M.next=18;break}return M.next=17,V();case 17:K=M.sent;case 18:K&&!$(K)&&(process.cwd(),r=A.join(A.dirname(K.car.valueOf()),r));case 19:H.set(u,A.dirname(r)),O.readFile(r,function(W,ce){if(W)p(W),H.set(u,s);else try{f(ce).then(function(){v(),H.set(u,s)}).catch(p)}catch(y){p(y)}}),M.next=26;break;case 23:M.prev=23,M.t0=M.catch(0),console.error(M.t0);case 26:case"end":return M.stop()}},h,null,[[0,23]])}));return function(h,v){return g.apply(this,arguments)}}());if(a){var m,k,L=(m=H.get("__dirname",{throwError:!1}))!==null&&m!==void 0?m:bt;(k=L)!==null&&k!==void 0||(L=bt);var b=L.replace(/dist\/?[^\/]*$/,"");r=r.replace(i,b)}return s&&(s=s.valueOf(),r.startsWith("/")||(r=s+"/"+r.replace(/^\.?\/?/,""))),c(r).then(function(g){return H.set(u,r.replace(/\/[^/]*$/,"")),f(g)}).then(function(){}).finally(function(){H.set(u,s)})},`(load filename)
        (load filename environment)

        Fetches the file (from disk or network) and evaluates its content as LIPS code.
        If the second argument is provided and it's an environment the evaluation
        will happen in that environment.`),while:E(new fe("while",function(e,r){var n=e.car,t=se(se({},r),{},{env:this}),i=new B(new x("begin"),e.cdr);return function a(){return _e(ie(n,t),function(u){if(u)return _e(ie(i,t),a)})}()}),`(while cond body)

         Creates a loop, it executes cond and body until cond expression is false.`),do:E(new fe("do",function(){var e=ke(function(r,n){var t=this,i=n.use_dynamic,a=n.error;return ae.mark(function u(){var s,o,f,c,_,m,k,L,b,g;return ae.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:s=t,o=s,f=s.inherit("do"),c=r.car,_=r.cdr.car,m=r.cdr.cdr,$(m)||(m=new B(x("begin"),m)),k={env:s,dynamic_env:o,use_dynamic:i,error:a},L=c;case 9:if($(L)){v.next=20;break}return b=L.car,v.t0=f,v.t1=b.car,v.next=15,ie(b.cdr.car,k);case 15:v.t2=v.sent,v.t0.set.call(v.t0,v.t1,v.t2),L=L.cdr,v.next=9;break;case 20:k={env:f,dynamic_env:o,error:a},g=ae.mark(function p(){var A,O,S,V,K;return ae.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if($(m)){M.next=3;break}return M.next=3,mr.evaluate(m,k);case 3:A=c,O={};case 5:if($(A)){M.next=15;break}if(S=A.car,$(S.cdr.cdr)){M.next=12;break}return M.next=10,ie(S.cdr.cdr.car,k);case 10:V=M.sent,O[S.car.valueOf()]=V;case 12:A=A.cdr,M.next=5;break;case 15:K=Object.getOwnPropertySymbols(O),k.env=f=s.inherit("do"),Object.keys(O).concat(K).forEach(function(W){f.set(W,O[W])});case 18:case"end":return M.stop()}},p)});case 22:return v.next=24,ie(_.car,k);case 24:if(v.t3=v.sent,v.t3!==!1){v.next=29;break}return v.delegateYield(g(),"t4",27);case 27:v.next=22;break;case 29:if($(_.cdr)){v.next=33;break}return v.next=32,ie(_.cdr.car,k);case 32:return v.abrupt("return",v.sent);case 33:case"end":return v.stop()}},u)})()});return function(r,n){return e.apply(this,arguments)}}()),`(do ((<var> <init> <next>)) (test return) . body)

         Iteration macro that evaluates the expression body in scope of the variables.
         On each loop it changes the variables according to the <next> expression and runs
         test to check if the loop should continue. If test is a single value, the macro
         will return undefined. If the test is a pair of expressions the macro will
         evaluate and return the second expression after the loop exits.`),if:E(new fe("if",function(e,r){var n=r.error,t=r.use_dynamic,i=this,a=this,u={env:a,dynamic_env:i,use_dynamic:t,error:n},s=function(c){return xn(c)?ie(e.cdr.cdr.car,u):ie(e.cdr.car,u)};if($(e))throw new Error("too few expressions for `if`");var o=ie(e.car,u);return _e(o,s)}),`(if cond true-expr false-expr)

         Macro that evaluates cond expression and if the value is true, it
         evaluates and returns true-expression, if not it evaluates and returns
         false-expression.`),"let-env":new fe("let-env",function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.dynamic_env,t=r.use_dynamic,i=r.error;U("let-env",e,"pair");var a=ie(e.car,{env:this,dynamic_env:n,error:i,use_dynamic:t});return _e(a,function(u){return U("let-env",u,"environment"),ie(B(x("begin"),e.cdr),{env:u,dynamic_env:n,error:i})})},`(let-env env . body)

        Special macro that evaluates body in context of given environment
        object.`),letrec:E(Vn(Symbol.for("letrec")),`(letrec ((a value-a) (b value-b) ...) . body)

         Macro that creates a new environment, then evaluates and assigns values to
         names and then evaluates the body in context of that environment.
         Values are evaluated sequentially and the next value can access the
         previous values/names.`),"letrec*":E(Vn(Symbol.for("letrec")),`(letrec* ((a value-a) (b value-b) ...) . body)

         Same as letrec but the order of execution of the binding is guaranteed,
         so you can use recursive code as well as referencing the previous binding.

         In LIPS both letrec and letrec* behave the same.`),"let*":E(Vn(Symbol.for("let*")),`(let* ((a value-a) (b value-b) ...) . body)

         Macro similar to \`let\`, but the subsequent bindings after the first
         are evaluated in the environment including the previous let variables,
         so you can define one variable, and use it in the next's definition.`),let:E(Vn(Symbol.for("let")),`(let ((a value-a) (b value-b) ...) . body)

         Macro that creates a new environment, then evaluates and assigns values to names,
         and then evaluates the body in context of that environment.  Values are evaluated
         sequentially but you can't access previous values/names when the next are
         evaluated. You can only get them in the body of the let expression.  (If you want
         to define multiple variables and use them in each other's definitions, use
         \`let*\`.)`),"begin*":E(xc("begin*",function(e){return e.pop()}),`(begin* . body)

         This macro is a parallel version of begin. It evaluates each expression
         in the body and if it's a promise it will await it in parallel and return
         the value of the last expression (i.e. it uses Promise.all()).`),shuffle:E("shuffle",function(e){U("shuffle",e,["pair","nil","array"]);var r=H.get("random");if($(e))return te;if(Array.isArray(e))return Oa(e.slice(),r);var n=H.get("list->array")(e);return n=Oa(n,r),H.get("array->list")(n)},`(shuffle obj)

        Order items in vector or list in random order.`),begin:E(new fe("begin",function(e,r){var n=se(se({},r),{},{env:this}),t=H.get("list->array")(e),i;return function a(){if(t.length){var u=t.shift(),s=ie(u,n);return _e(s,function(o){return i=o,a()})}else return i}()}),`(begin . args)

         Macro that runs a list of expressions in order and returns the value
         of the last one. It can be used in places where you can only have a
         single expression, like (if).`),ignore:new fe("ignore",function(e,r){var n=se(se({},r),{},{env:this,dynamic_env:this});ie(new B(new x("begin"),e),n)},`(ignore . body)

        Macro that will evaluate the expression and swallow any promises that may
        be created. It will discard any value that may be returned by the last body
        expression. The code should have side effects and/or when it's promise
        it should resolve to undefined.`),"call/cc":E(fe.defmacro("call/cc",function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=se({env:this},r);return _e(ie(e.car,n),function(t){if(he(t))return t(new to(null))})}),`(call/cc proc)

         Call-with-current-continuation.

         NOT SUPPORTED BY LIPS RIGHT NOW`),parameterize:E(new fe("parameterize",function(e,r){var n=r.dynamic_env,t=n.inherit("parameterize").new_frame(null,{}),i=se(se({},r),{},{env:this}),a=e.car;if(!C(a)){var u=Ae(a);throw new Error("Invalid syntax for parameterize expecting pair got ".concat(u))}function s(){var o=new B(new x("begin"),e.cdr);return ie(o,se(se({},i),{},{dynamic_env:t}))}return function o(){var f=a.car,c=f.car.valueOf();return _e(ie(f.cdr.car,i),function(_){var m=n.get(c,{throwError:!1});if(!sn(m))throw new Error("Unknown parameter ".concat(c));return t.set(c,m.inherit(_)),Lr(a.cdr)?s():(a=a.cdr,o())})}()}),`(parameterize ((name value) ...)

         Macro that change the dynamic variable created by make-parameter.`),"make-parameter":E(new fe("make-parameter",function(e,r){r.dynamic_env;var n=ie(e.car,r),t;return C(e.cdr.car)&&(t=ie(e.cdr.car,r)),new Bt(n,t)}),`(make-parameter init converter)

    Function creates new dynamic variable that can be custimized with parameterize
    macro. The value should be assigned to a variable e.g.:

    (define radix (make-parameter 10))

    The result value is a procedure that return the value of dynamic variable.`),"define-syntax-parameter":E(new fe("define-syntax-parameter",function(e,r){var n=e.car,t=this;if(!(n instanceof x))throw new Error("define-syntax-parameter: invalid syntax expecting symbol got ".concat(Ae(n)));var i=ie(e.cdr.car,se({env:t},r));U("define-syntax-parameter",i,"syntax",2),i.__name__=n.valueOf(),i.__name__ instanceof Q&&(i.__name__=i.__name__.valueOf());var a;C(e.cdr.cdr)&&Q.isString(e.cdr.cdr.car)&&(a=e.cdr.cdr.car.valueOf()),t.set(e.car,new on(i),a,!0)}),`(define-syntax-parameter name syntax [__doc__])

         Binds <keyword> to the transformer obtained by evaluating <transformer spec>.
         The transformer provides the default expansion for the syntax parameter,
         and in the absence of syntax-parameterize, is functionally equivalent to
         define-syntax.`),"syntax-parameterize":E(new fe("syntax-parameterize",function(e,r){for(var n=H.get("list->array")(e.car),t=this.inherit("syntax-parameterize");n.length;){var i=n.shift();if(!(C(i)||i.car instanceof x)){var a="invalid syntax for syntax-parameterize: ".concat(kn(e,!0));throw new Error("syntax-parameterize: ".concat(a))}var u=ie(i.cdr.car,se(se({},r),{},{env:this})),s=i.car;U("syntax-parameterize",u,["syntax"]),U("syntax-parameterize",s,"symbol"),u.__name__=s.valueOf(),u.__name__ instanceof Q&&(u.__name__=u.__name__.valueOf());var o=new on(u);if(s.is_gensym()){var f=s.literal(),c=this.get(f,{throwError:!1});c instanceof on&&t.set(f,o)}t.set(s,o)}var _=si([t,r.dynamic_env],e.cdr);return ie(_,se(se({},r),{},{env:t}))}),`(syntax-parameterize (bindings) body)

         Macro work similar to let-syntax but the the bindnds will be exposed to the user.
         With syntax-parameterize you can define anaphoric macros.`),define:E(fe.defmacro("define",function(e,r){var n=this;if(C(e.car)&&e.car.car instanceof x){var t=new B(new x("define"),new B(e.car.car,new B(new B(new x("lambda"),new B(e.car.cdr,e.cdr)))));return t}else if(r.macro_expand)return;r.dynamic_env=this,r.env=n;var i=e.cdr.car,a;return C(i)?(i=ie(i,r),a=!0):i instanceof x&&(i=n.get(i)),U("define",e.car,"symbol"),_e(i,function(u){n.__name__===Te.__merge_env__&&(n=n.__parent__),a&&(he(u)&&qr(u)||u instanceof Te||sn(u))&&(u.__name__=e.car.valueOf(),u.__name__ instanceof Q&&(u.__name__=u.__name__.valueOf()));var s;C(e.cdr.cdr)&&Q.isString(e.cdr.cdr.car)&&(s=e.cdr.cdr.car.valueOf()),n.set(e.car,u,s,!0)})}),`(define name expression)
         (define name expression "doc string")
         (define (function-name . args) . body)

         Macro for defining values. It can be used to define variables,
         or functions. If the first argument is list it will create a function
         with name being first element of the list. This form expands to
         \`(define function-name (lambda args body))\``),"set-obj!":E("set-obj!",function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=ye(e);if(Lr(e)||i!=="object"&&i!=="function"){var a=Rr("set-obj!",Ae(e),["object","function"]);throw new Error(a)}if(U("set-obj!",r,["string","symbol","number"]),e=Qe(e),r=r.valueOf(),arguments.length===2?delete e[r]:Zn(e)&&he(n)?(e[r]=Qe(n),e[r][$u]=!0):he(n)||Mu(n)||$(n)?e[r]=n:e[r]=n&&!Zn(n)?n.valueOf():n,Ou){var u=e[r];Object.defineProperty(e,r,se(se({},t),{},{value:u}))}},`(set-obj! obj key value)
        (set-obj! obj key value props)

        Function set a property of a JavaScript object. props should be a vector of pairs,
        passed to Object.defineProperty.`),"null-environment":E("null-environment",function(){return H.inherit("null")},`(null-environment)

        Returns a clean environment with only the standard library.`),values:E("values",function(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return Vr(n)},`(values a1 a2 ...)

        If called with more then one element it will create a special
        Values object that can be used in the call-with-values function.`),"call-with-values":E("call-with-values",function(e,r){U("call-with-values",e,"function",1),U("call-with-values",r,"function",2);var n=e.apply(this);return n instanceof Vr?r.apply(this,n.valueOf()):r.call(this,n)},`(call-with-values producer consumer)

        Calls the producer procedure with no arguments, then calls the
        consumer procedure with the returned value as an argument -- unless
        the returned value is a special Values object created by (values), if it is
        the values are unpacked and the consumer is called with multiple arguments.`),"current-environment":E("current-environment",function(){return this.__name__==="__frame__"?this.__parent__:this},`(current-environment)

        Function that returns the current environment (they're first-class objects!)`),"parent.frame":E("parent.frame",function(){return Oe},`(parent.frame)

        Returns the parent environment if called from inside a function.
        If no parent frame can be found it returns nil.`),eval:E("eval",function(e,r){return r=r||this.get("interaction-environment").call(this),new Promise(function(n,t){var i=ie(e,{env:r,dynamic_env:r,error:t});n(i)})},`(eval expr)
        (eval expr environment)

        Function that evaluates LIPS Scheme code. If the second argument is provided
        it will be the environment that the code is evaluated in.`),lambda:new fe("lambda",function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.use_dynamic,t=r.error,i=this,a;C(e.cdr)&&Q.isString(e.cdr.car)&&!$(e.cdr.cdr)&&(a=e.cdr.car.valueOf());function u(){var o=Ia(this)?this:{dynamic_env:i},f=o.dynamic_env,c=i.inherit("lambda");f=f.inherit("lambda"),this&&!Ia(this)&&(this&&!this.__instance__&&Object.defineProperty(this,"__instance__",{enumerable:!1,get:function(){return!0},set:function(){},configurable:!1}),c.set("this",this));for(var _=arguments.length,m=new Array(_),k=0;k<_;k++)m[k]=arguments[k];if(this instanceof jt){var L={throwError:!1};c.set("arguments",this.env.get("arguments",L)),c.set("parent.frame",this.env.get("parent.frame",L))}else{var b=m.slice();b.callee=u,b.env=c,c.set("arguments",b)}function g(K,G){c.__env__[K.__name__]=G,f.__env__[K.__name__]=G}var h=e.car,v=0;if(h instanceof x||!$(h))for(;;){if(!$(h.car)){if(h instanceof x){var p=Ve(B.fromArray(m.slice(v),!1));g(h,p);break}else if(C(h)){var A=m[v];g(h.car,A)}}if($(h.cdr))break;v++,h=h.cdr}var O=a?e.cdr.cdr:e.cdr,S=si([c,f],O),V={env:c,dynamic_env:f,use_dynamic:n,error:t};return ie(S,V)}var s=C(e.car)?e.car.length():null;return u.__code__=new B(new x("lambda"),e),u[Vu]=!0,C(e.car)?E(Dc(u,s),a,!0):E(u,a,!0)},`(lambda (a b) body)
        (lambda args body)
        (lambda (a b . rest) body)

        The lambda macro creates a new anonymous function. If the first element of
        the body is a string and there is more elements the string is used as the
        documentation string, that can be read using (help fn).`),macroexpand:E(new fe("macroexpand",ja()),`(macroexpand expr)

         Macro that expand all macros inside and return single expression as output.`),"macroexpand-1":E(new fe("macroexpand-1",ja(!0)),`(macroexpand-1 expr)

         Macro similar to macroexpand but it expand macros only one level
         and return single expression as output.`),"define-macro":E(new fe(Iu,function(e,r){var n=r.use_dynamic,t=r.error,i,a,u,s;if(ac(e)&&(i=e.car.car.__name__,u=e.cdr,s=e.car.cdr),ic(e)){i=e.car.__name__;var o=e.cdr.car;s=o.cdr.car,u=o.cdr.cdr}if(i&&u&&s){Q.isString(u.car)&&C(u.cdr)&&(a=u.car.valueOf(),u=u.cdr);var f=uc(i,s,u,a,{use_dynamic:n,error:t});this.set(i,f)}else throw new Error("Syntax Error: Invalid `define-macro` expression")}),`(define-macro (name . args) body)

         The meta-macro, that creates new macros. If the return value is a list structure
         it will be evaluated where the macro is invoked from. You can use quasiquote \`
         and unquote , and unquote-splicing ,@ inside to create an expression that will be
         evaluated at runtime. Macros works like this: if you pass any expression to a
         macro the arguments will not be evaluated unless the macro's body explicitly
         calls (eval) on it. Because of this a macro can manipulate the expression
         (arguments) as lists.`),"syntax-rules":new fe("syntax-rules",function(e,r){var n=r.use_dynamic,t=r.error,i=this;function a(o){for(var f=[];!$(o);){var c=o.car;f.push(c.valueOf()),o=o.cdr}return f}function u(o){for(;!$(o);){var f=o.car;if(!(f instanceof x))throw new Error("syntax-rules: wrong identifier");o=o.cdr}}e.car instanceof x?u(e.cdr.car):u(e.car);var s=new Te(function(o,f){var c=f.macro_expand;Y(">> SYNTAX"),Y(o),Y(e);var _=i.inherit("syntax"),m=_,k=this;if(k.__name__===Te.__merge_env__){var L=Object.getOwnPropertySymbols(k.__env__);L.forEach(function(W){k.__parent__.set(W,k.__env__[W])}),k=k.__parent__}var b={env:_,dynamic_env:m,use_dynamic:n,error:t},g,h,v;e.car instanceof x?(g=e.car,v=a(e.cdr.car),h=e.cdr.cdr):(g="...",v=a(e.car),h=e.cdr);try{for(;!$(h);){var p=h.car.car,A=h.car.cdr.car;Y("[[[ RULE"),Y(p);var O=sc(p,o,v,g,{expansion:this,define:i});if(O){ui()&&(console.log(JSON.stringify(Bu(O),!0,2)),console.log("PATTERN: "+p.toString(!0)),console.log("MACRO: "+o.toString(!0)));var S=[],V=fc({bindings:O,expr:A,symbols:v,scope:_,lex_scope:k,names:S,ellipsis:g});Y("OUPUT>>> ",V),V&&(A=V);var K=k.merge(_,Te.__merge_env__);if(c)return{expr:A,scope:K};var G=ie(A,se(se({},b),{},{env:K}));return cc(G,S)}h=h.cdr}}catch(W){var M=`
in macro:
  `.concat(e.toString(!0));throw W.message.includes(M)||(W.message+=M),W}throw new Error("syntax-rules: no matching syntax in macro ".concat(o.toString(!0)))},i);return s.__code__=e,s},`(syntax-rules () (pattern expression) ...)

        Base of hygienic macros, it will return a new syntax expander
        that works like Lisp macros.`),quote:E(new fe("quote",function(e){return Ve(e.car)}),`(quote expression) or 'expression

         Macro that returns a single LIPS expression as data (it won't evaluate the
         argument). It will return a list if put in front of LIPS code.
         And if put in front of a symbol it will return the symbol itself, not the value
         bound to that name.`),"unquote-splicing":E("unquote-splicing",function(){throw new Error("You can't call `unquote-splicing` outside of quasiquote")},`(unquote-splicing code) or ,@code

        Special form used in the quasiquote macro. It evaluates the expression inside and
        splices the list into quasiquote's result. If it is not the last element of the
        expression, the computed value must be a pair.`),unquote:E("unquote",function(){throw new Error("You can't call `unquote` outside of quasiquote")},`(unquote code) or ,code

        Special form used in the quasiquote macro. It evaluates the expression inside and
        substitutes the value into quasiquote's result.`),quasiquote:fe.defmacro("quasiquote",function(e,r){var n=r.use_dynamic,t=r.error,i=this,a=i;function u(h){return C(h)||sr(h)||Array.isArray(h)}function s(h,v){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:u;if(C(h)){var A=h.car,O=h.cdr;return p(A)&&(A=v(A)),p(O)&&(O=v(O)),Ke(A)||Ke(O)?pn([A,O]).then(function(S){var V=ve(S,2),K=V[0],G=V[1];return new B(K,G)}):new B(A,O)}return h}function o(h,v){return C(h)?$(v)||h.append(v):h=new B(h,v),h}function f(h){return!!h.filter(function(v){return C(v)&&x.is(v.car,/^(unquote|unquote-splicing)$/)}).length}function c(h,v,p){return h.reduce(function(A,O){if(!C(O))return A.push(O),A;if(x.is(O.car,"unquote-splicing")){var S;if(v+1<p?S=L(O.cdr,v+1,p):S=ie(O.cdr.car,{env:i,use_dynamic:n,dynamic_env:a,error:t}),!C(S))throw new Error("Expecting list ".concat(Ae(O)," found"));return A.concat(S.to_array())}return A.push(L(O,v,p)),A},[])}function _(h,v,p){var A={};return v++,Object.keys(h).forEach(function(O){var S=h[O];if(C(S)){if(x.is(S.car,"unquote-splicing"))throw new Error("You can't call `unquote-splicing` inside object");var V;v<p?V=L(S.cdr.car,v,p):V=ie(S.cdr.car,{env:i,dynamic_env:a,use_dynamic:n,error:t}),A[O]=V}else A[O]=S}),Object.isFrozen(h)&&Object.freeze(A),A}function m(h,v,p){if(v<p){var A=te;return $(h.cdr)||(A=L(h.cdr,v-1,p)),new B(new B(h.car.car,L(h.car.cdr,v,p)),A)}var O=[];return function S(V){var K=ie(V.car,{env:i,dynamic_env:a,use_dynamic:n,error:t});return O.push(K),C(V.cdr)?S(V.cdr):_e(O,function(G){if(G.some(function(y){return!C(y)})){if(C(h.cdr)&&x.is(h.cdr.car,".")&&C(h.cdr.cdr)&&$(h.cdr.cdr.cdr))return h.cdr.cdr.car;if(!($(h.cdr)||C(h.cdr))){var M="You can't splice atom inside list";throw new Error(M)}if(G.length>1){var W="You can't splice multiple atoms inside list";throw new Error(W)}if(!(C(h.cdr)&&$(G[0])))return G[0]}G=G.map(function(y){return k.has(y)?y.clone():(k.add(y),y)});var ce=L(h.cdr,0,1);if(!($(ce)&&$(G[0])))return _e(ce,function(y){if($(G[0]))return y;if(G.length===1)return o(G[0],y);var N=G.reduce(function(P,R){return o(P,R)});return o(N,y)})})}(h.car.cdr)}var k=new Set;function L(h,v,p){if(C(h)){if(C(h.car)){if(x.is(h.car.car,"unquote-splicing"))return m(h,v+1,p);if(x.is(h.car.car,"unquote")){if(v+2===p&&C(h.car.cdr)&&C(h.car.cdr.car)&&x.is(h.car.cdr.car.car,"unquote-splicing")){var A=h.car.cdr;return new B(new B(new x("unquote"),m(A,v+2,p)),te)}else if(C(h.car.cdr)&&!$(h.car.cdr.cdr))if(C(h.car.cdr.car)){var O=[];return function K(G){return $(G)?B.fromArray(O):_e(ie(G.car,{env:i,dynamic_env:a,use_dynamic:n,error:t}),function(M){return O.push(M),K(G.cdr)})}(h.car.cdr)}else return h.car.cdr}}if(x.is(h.car,"quasiquote")){var S=L(h.cdr,v,p+1);return new B(h.car,S)}if(x.is(h.car,"quote"))return new B(h.car,L(h.cdr,v,p));if(x.is(h.car,"unquote")){if(v++,v<p)return new B(new x("unquote"),L(h.cdr,v,p));if(v>p)throw new Error("You can't call `unquote` outside of quasiquote");if(C(h.cdr)){if($(h.cdr.cdr))return ie(h.cdr.car,{env:i,dynamic_env:a,error:t});if(C(h.cdr.car)){var V=[];return function K(G){return $(G)?B.fromArray(V):_e(ie(G.car,{env:i,dynamic_env:a,use_dynamic:n,error:t}),function(M){return V.push(M),K(G.cdr)})}(h.cdr)}else return h.cdr}else return h.cdr}return s(h,function(K){return L(K,v,p)})}else{if(sr(h))return _(h,v,p);if(h instanceof Array)return c(h,v,p)}return h}function b(h){C(h)&&(delete h[dr],h.have_cycles("car")||b(h.car),h.have_cycles("cdr")||b(h.cdr))}if(sr(e.car)&&!f(Object.values(e.car))||Array.isArray(e.car)&&!f(e.car)||C(e.car)&&!e.car.find("unquote")&&!e.car.find("unquote-splicing")&&!e.car.find("quasiquote"))return Ve(e.car);var g=L(e.car,0,1);return _e(g,function(h){return b(h),Ve(h)})},`(quasiquote list)

        Similar macro to \`quote\` but inside it you can use special expressions (unquote
        x) abbreviated to ,x that will evaluate x and insert its value verbatim or
        (unquote-splicing x) abbreviated to ,@x that will evaluate x and splice the value
        into the result. Best used with macros but it can be used outside.`),clone:E("clone",function(r){return U("clone",r,"pair"),r.clone()},`(clone list)

        Function that returns a clone of the list, that does not share any pairs with the
        original, so the clone can be safely mutated without affecting the original.`),append:E("append",function(){for(var r,n=arguments.length,t=new Array(n),i=0;i<n;i++)t[i]=arguments[i];return t=t.map(function(a){return C(a)?a.clone():a}),(r=H.get("append!")).call.apply(r,[this].concat(ge(t)))},`(append item ...)

        Function that creates a new list with each argument appended end-to-end.
        It will always return a new list and not modify its arguments.`),"append!":E("append!",function(){for(var e=H.get("list?"),r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return n.reduce(function(i,a){if(U("append!",i,["nil","pair"]),(C(a)||$(a))&&!e(a))throw new Error("append!: Invalid argument, value is not a list");return $(i)?$(a)?te:a:Lr(a)?i:i.append(a)},te)},`(append! arg1 ...)

        Destructive version of append, it can modify the lists in place. It returns
        a new list where each argument is appended to the end. It may modify
        lists added as arguments.`),reverse:E("reverse",function(r){if(U("reverse",r,["array","pair","nil"]),$(r))return te;if(C(r)){var n=H.get("list->array")(r).reverse();return H.get("array->list")(n)}else{if(Array.isArray(r))return r.reverse();throw new Error(Rr("reverse",Ae(r),"array or pair"))}},`(reverse list)

        Function that reverses the list or array. If value is not a list
        or array it will error.`),nth:E("nth",function(r,n){if(U("nth",r,"number"),U("nth",n,["array","pair"]),C(n)){for(var t=n,i=0;i<r;){if(!t.cdr||$(t.cdr)||t.have_cycles("cdr"))return te;t=t.cdr,i++}return t.car}else{if(n instanceof Array)return n[r];throw new Error(Rr("nth",Ae(n),"array or pair",2))}},`(nth index obj)

        Function that returns the nth element of the list or array.
        If used with a non-indexable value it will error.`),list:E("list",function(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return n.reverse().reduce(function(i,a){return new B(a,i)},te)},`(list . args)

        Function that creates a new list out of its arguments.`),substring:E("substring",function(r,n,t){return U("substring",r,"string"),U("substring",n,"number"),U("substring",t,["number","void"]),r.substring(n.valueOf(),t&&t.valueOf())},`(substring string start end)

        Function that returns the slice of the string starting at start and ending
        with end.`),concat:E("concat",function(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return n.forEach(function(i,a){return U("concat",i,"string",a+1)}),n.join("")},`(concat . strings)

        Function that creates a new string by joining its arguments.`),join:E("join",function(r,n){return U("join",r,"string"),U("join",n,["pair","nil"]),H.get("list->array")(n).join(r)},`(join separator list)

        Function that returns a string by joining elements of the list using separator.`),split:E("split",function(r,n){return U("split",r,["regex","string"]),U("split",n,"string"),H.get("array->list")(n.split(r))},`(split separator string)

        Function that creates a list by splitting string by separator which can
        be a string or regular expression.`),replace:E("replace",function(r,n,t){if(U("replace",r,["regex","string"]),U("replace",n,["string","function"]),U("replace",t,"string"),he(n)){var i=[];return t.replace(r,function(){i.push(n.apply(void 0,arguments))}),_e(i,function(a){return t.replace(r,function(){return a.shift()})})}return t.replace(r,n)},`(replace pattern replacement string)

        Function that changes pattern to replacement inside string. Pattern can be a
        string or regex and replacement can be function or string. See Javascript
        String.replace().`),match:E("match",function(r,n){U("match",r,["regex","string"]),U("match",n,"string");var t=n.match(r);return t?H.get("array->list")(t):!1},`(match pattern string)

        Function that returns a match object from JavaScript as a list or #f if
        no match.`),search:E("search",function(r,n){return U("search",r,["regex","string"]),U("search",n,"string"),n.search(r)},`(search pattern string)

        Function that returns the first found index of the pattern inside a string.`),repr:E("repr",function(r,n){return ze(r,n)},`(repr obj)

        Function that returns a LIPS code representation of the object as a string.`),"escape-regex":E("escape-regex",function(e){return U("escape-regex",e,"string"),Bs(e.valueOf())},`(escape-regex string)

        Function that returns a new string where all special operators used in regex,
        are escaped with backslashes so they can be used in the RegExp constructor
        to match a literal string.`),env:E("env",function(e){e=e||this.env;var r=Object.keys(e.__env__).map(x),n;return r.length?n=B.fromArray(r):n=te,e.__parent__ instanceof we?H.get("env").call(this,e.__parent__).append(n):n},`(env)
        (env obj)

        Function that returns a list of names (functions, macros and variables)
        that are bound in the current environment or one of its parents.`),new:E("new",function(e){for(var r=Qe(e),n,t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];return r[Symbol.for("__class__")]?n=at(r,i):n=at(r,ge(i.map(function(u){return Ur(u)}))),n},`(new obj . args)

        Function that creates new JavaScript instance of an object.`),typecheck:E(U,`(typecheck label value type [position])

         Checks the type of value and errors if the type is not one allowed.  Type can be
         string or list of strings. The position optional argument is used to create a
         proper error message for the nth argument of function calls.`),"typecheck-number":E(ro,`(typecheck-number label value type [position])

         Function similar to typecheck but checks if the argument is a number
         and specific type of number e.g. complex.`),"unset-special!":E("unset-special!",function(e){U("remove-special!",e,"string"),delete Ce.remove(e.valueOf())},`(unset-special! name)

        Function that removes a special symbol from parser added by \`set-special!\`,
        name must be a string.`),"set-special!":E("set-special!",function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ce.LITERAL;U("set-special!",e,"string",1),U("set-special!",r,"symbol",2),Ce.append(e.valueOf(),r,n)},`(set-special! symbol name [type])

        Add a special symbol to the list of transforming operators by the parser.
        e.g.: \`(add-special! "#" 'x)\` will allow to use \`#(1 2 3)\` and it will be
        transformed into (x (1 2 3)) so you can write x macro that will process
        the list. 3rd argument is optional, and it can be one of two values:
        lips.specials.LITERAL, which is the default behavior, or
        lips.specials.SPLICE which causes the value to be unpacked into the expression.
        This can be used for e.g. to make \`#(1 2 3)\` into (x 1 2 3) that is needed
        by # that defines vectors.`),get:On,".":On,unbind:E(Qe,`(unbind fn)

         Function that removes the weak 'this' binding from a function so you
         can get properties from the actual function object.`),type:E(Ae,`(type object)

         Function that returns the type of an object as string.`),debugger:E("debugger",function(){debugger},`(debugger)

        Function that triggers the JavaScript debugger (e.g. the browser devtools)
        using the "debugger;" statement. If a debugger is not running this
        function does nothing.`),in:E("in",function(e,r){return(e instanceof x||e instanceof Q||e instanceof l)&&(e=e.valueOf()),e in Ur(r)},`(in key value)

        Function that uses the Javascript "in" operator to check if key is
        a valid property in the value.`),"instance?":E("instance?",function(e){return Lu(e)},`(instance? obj)

        Checks if object is an instance, created with a new operator`),instanceof:E("instanceof",function(e,r){return r instanceof Qe(e)},`(instanceof type obj)

        Predicate that tests if the obj is an instance of type.`),"prototype?":E("prototype?",Zn,`(prototype? obj)

         Predicate that tests if value is a valid JavaScript prototype,
         i.e. calling (new) with it will not throw '<x> is not a constructor'.`),"macro?":E("macro?",function(e){return e instanceof fe},`(macro? expression)

        Predicate that tests if value is a macro.`),"continuation?":E("continuation?",Ri,`(continuation? expression)

         Predicate that tests if value is a callable continuation.`),"function?":E("function?",he,`(function? expression)

         Predicate that tests if value is a callable function.`),"real?":E("real?",function(e){return Ae(e)!=="number"?!1:e instanceof l?e.isFloat():l.isFloat(e)},`(real? number)

        Predicate that tests if value is a real number (not complex).`),"number?":E("number?",function(e){return Number.isNaN(e)||l.isNumber(e)},`(number? expression)

        Predicate that tests if value is a number or NaN value.`),"string?":E("string?",function(e){return Q.isString(e)},`(string? expression)

        Predicate that tests if value is a string.`),"pair?":E("pair?",C,`(pair? expression)

         Predicate that tests if value is a pair or list structure.`),"regex?":E("regex?",function(e){return e instanceof RegExp},`(regex? expression)

        Predicate that tests if value is a regular expression.`),"null?":E("null?",function(e){return Lr(e)},`(null? expression)

        Predicate that tests if value is null-ish (i.e. undefined, nil, or
        Javascript null).`),"boolean?":E("boolean?",function(e){return typeof e=="boolean"},`(boolean? expression)

        Predicate that tests if value is a boolean (#t or #f).`),"symbol?":E("symbol?",function(e){return e instanceof x},`(symbol? expression)

        Predicate that tests if value is a LIPS symbol.`),"array?":E("array?",function(e){return e instanceof Array},`(array? expression)

        Predicate that tests if value is an array.`),"object?":E("object?",function(e){return!$(e)&&e!==null&&!(e instanceof pe)&&!(e instanceof RegExp)&&!(e instanceof Q)&&!C(e)&&!(e instanceof l)&&ye(e)==="object"&&!(e instanceof Array)},`(object? expression)

        Predicate that tests if value is an plain object (not another LIPS type).`),flatten:E("flatten",function(r){return U("flatten",r,"pair"),r.flatten()},`(flatten list)

        Returns a shallow list from tree structure (pairs).`),"vector-append":E("vector-append",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return[];Yr("vector-append",r,"array");var t=r[0],i=r.slice(1);return t.concat.apply(t,ge(i))},`(vector-append v1 v2 ...)

         Returns new vector by combining it's arguments that should be vectors.`),"array->list":E("array->list",function(e){return U("array->list",e,"array"),B.fromArray(e)},`(array->list array)

        Function that converts a JavaScript array to a LIPS cons list.`),"tree->array":E("tree->array",Sa("tree->array",!0),`(tree->array list)

         Function that converts a LIPS cons tree structure into a JavaScript array.`),"list->array":E("list->array",Sa("list->array"),`(list->array list)

         Function that converts a LIPS list into a JavaScript array.`),apply:E("apply",function(r){for(var n=arguments.length,t=new Array(n>1?n-1:0),i=1;i<n;i++)t[i-1]=arguments[i];U("apply",r,"function",1);var a=t.pop();return U("apply",a,["pair","nil"],t.length+2),t=t.concat(H.get("list->array").call(this,a)),r.apply(this,no(r,t))},`(apply fn list)

        Function that calls fn with the list of arguments.`),length:E("length",function(r){if(!r||$(r))return 0;if(C(r))return r.length();if("length"in r)return r.length},`(length expression)

        Function that returns the length of the object. The object can be a LIPS
        list or any object that has a "length" property. Returns undefined if the
        length could not be found.`),"string->number":E("string->number",function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10;if(U("string->number",e,"string",1),U("string->number",r,"number",2),e=e.valueOf(),r=r.valueOf(),e.match(vu)||e.match(Oi))return yu(e,r);if(e.match(bs)||e.match(Ci))return bu(e,r);var n=r===10&&!e.match(/e/i)||r===16;return e.match(mu)&&n||e.match(Si)?gu(e,r):e.match(xt)?Bi(e):!1},`(string->number number [radix])

        Function that parses a string into a number.`),try:E(new fe("try",function(e,r){var n=this,t=r.use_dynamic;return r.error,new Promise(function(i,a){var u,s;if(x.is(e.cdr.car.car,"catch")?(u=e.cdr.car,C(e.cdr.cdr)&&x.is(e.cdr.cdr.car.car,"finally")&&(s=e.cdr.cdr.car)):x.is(e.cdr.car.car,"finally")&&(s=e.cdr.car),!(s||u))throw new Error("try: invalid syntax");function o(m){throw i(m),new Cn("[CATCH]")}var f=function(k,L){L(k)};s&&(f=function(k,L){f=a,c.error=function(b){throw b},_e(ie(new B(new x("begin"),s.cdr),c),function(){L(k)})});var c={env:n,use_dynamic:t,dynamic_env:n,error:function(k){if(k instanceof Cn)throw k;if(u){var L=n.inherit("try"),b=u.cdr.car.car;if(!(b instanceof x))throw new Error("try: invalid syntax: catch require variable name");L.set(b,k);var g,h={env:L,use_dynamic:t,dynamic_env:n,error:function(A){throw g=!0,a(A),new Cn("[CATCH]")}},v=ie(new B(new x("begin"),u.cdr.cdr),h);_e(v,function(A){g||f(A,o)})}else f(void 0,function(){a(k)})}},_=ie(e.car,c);_e(_,function(m){f(m,i)},c.error)})}),`(try expr (catch (e) code))
         (try expr (catch (e) code) (finally code))
         (try expr (finally code))

         Macro that executes expr and catches any exceptions thrown. If catch is provided
         it's executed when an error is thrown. If finally is provided it's always
         executed at the end.`),raise:E("raise",function(e){throw e},`(raise obj)

        Throws the object verbatim (no wrapping an a new Error).`),throw:E("throw",function(e){throw new Error(e)},`(throw string)

        Throws a new exception.`),find:E("find",function e(r,n){if(U("find",n,["pair","nil"]),Lr(n))return!1;var t=Fa("find",r);return _e(t(n.car),function(i){return i&&!$(i)?n.car:e(r,n.cdr)})},`(find fn list)
        (find regex list)
        (find atom list)

        Higher-order function that finds the first value for which fn return true.
        If called with a regex or any atom it will create a matcher function.`),"for-each":E("for-each",function(e){var r;U("for-each",e,"function");for(var n=arguments.length,t=new Array(n>1?n-1:0),i=1;i<n;i++)t[i-1]=arguments[i];t.forEach(function(u,s){U("for-each",u,["pair","nil"],s+1)});var a=(r=H.get("map")).call.apply(r,[this,e].concat(t));if(Ke(a))return a.then(function(){})},`(for-each fn . lists)

        Higher-order function that calls function \`fn\` on each
        value of the argument. If you provide more than one list
        it will take each value from each list and call \`fn\` function
        with that many arguments as number of list arguments.`),map:E("map",function e(r){for(var n=this,t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];U("map",r,"function");var u=H.get("list?");if(i.forEach(function(m,k){if(U("map",m,["pair","nil"],k+1),C(m)&&!u.call(n,m))throw new Error("map: argument ".concat(k+1," is not a list"))}),i.length===0||i.some($))return te;var s=i.map(function(m){return m.car}),o=this.env,f=this.dynamic_env,c=this.use_dynamic,_=un(r,s,{env:o,dynamic_env:f,use_dynamic:c});return _e(_,function(m){return _e(e.call.apply(e,[n,r].concat(ge(i.map(function(k){return k.cdr})))),function(k){return new B(m,k)})})},`(map fn . lists)

        Higher-order function that calls function \`fn\` with each
        value of the list. If you provide more then one list as argument
        it will take each value from each list and call \`fn\` function
        with that many argument as number of list arguments. The return
        values of the fn calls are accumulated in a result list and
        returned by map.`),"list?":E("list?",function(e){for(var r=e;;){if($(r))return!0;if(!C(r)||r.have_cycles("cdr"))return!1;r=r.cdr}},`(list? obj)

        Predicate that tests if value is a proper linked list structure.
        The car of each pair can be any value. It returns false on cyclic lists."`),fold:E("fold",Ta("fold",function(e,r,n){for(var t=arguments.length,i=new Array(t>3?t-3:0),a=3;a<t;a++)i[a-3]=arguments[a];if(U("fold",r,"function"),i.forEach(function(s,o){U("fold",s,["pair","nil"],o+1)}),i.some($))return n;var u=e.call.apply(e,[this,r,n].concat(ge(i.map(function(s){return s.cdr}))));return _e(u,function(s){return r.apply(void 0,ge(i.map(function(o){return o.car})).concat([s]))})}),`(fold fn init . lists)

         Function fold is left-to-right reversal of reduce. It call \`fn\`
         on each pair of elements of the list and returns a single value.
         e.g. it computes (fn 'a 'x (fn 'b 'y (fn 'c 'z 'foo)))
         for: (fold fn 'foo '(a b c) '(x y z))`),pluck:E("pluck",function(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return function(i){if(n=n.map(function(f){return f instanceof x?f.__name__:f}),n.length===0)return te;if(n.length===1){var a=n,u=ve(a,1),s=u[0];return i[s]}var o={};return n.forEach(function(f){o[f]=i[f]}),o}},`(pluck . strings)

        If called with a single string it will return a function that when
        called with an object will return that key from the object.
        If called with more then one string the returned function will
        create a new object by copying all properties from the given object.`),reduce:E("reduce",Ta("reduce",function(e,r,n){for(var t=this,i=arguments.length,a=new Array(i>3?i-3:0),u=3;u<i;u++)a[u-3]=arguments[u];return U("reduce",r,"function"),a.forEach(function(s,o){U("reduce",s,["pair","nil"],o+1)}),a.some($)?n:_e(r.apply(void 0,ge(a.map(function(s){return s.car})).concat([n])),function(s){return e.call.apply(e,[t,r,s].concat(ge(a.map(function(o){return o.cdr}))))})}),`(reduce fn init list . lists)

         Higher-order function that takes each element of the list and calls
         the fn with result of previous call or init and the next element
         of the list until each element is processed, and returns a single value
         as result of last call to \`fn\` function.
         e.g. it computes (fn 'c 'z (fn 'b 'y (fn 'a 'x 'foo)))
         for: (reduce fn 'foo '(a b c) '(x y z))`),filter:E("filter",function(r,n){U("filter",r,["regex","function"]),U("filter",n,["pair","nil"]);var t=H.get("list->array")(n),i=[],a=Fa("filter",r);return function u(s){function o(c){return c&&!$(c)&&i.push(f),u(++s)}if(s===t.length)return B.fromArray(i);var f=t[s];return _e(a(f),o)}(0)},`(filter fn list)
        (filter regex list)

        Higher-order function that calls \`fn\` for each element of the list
        and return a new list for only those elements for which fn returns
        a truthy value. If called with a regex it will create a matcher function.`),compose:E(Yu,`(compose . fns)

         Higher-order function that creates a new function that applies all functions
         from right to left and returns the last value. Reverse of pipe.
         e.g.:
         ((compose (curry + 2) (curry * 3)) 10) ==> (+ 2 (* 3 10)) ==> 32`),pipe:E(Hu,`(pipe . fns)

         Higher-order function that creates a new function that applies all functions
         from left to right and returns the last value. Reverse of compose.
         e.g.:
         ((pipe (curry + 2) (curry * 3)) 10) ==> (* 3 (+ 2 10)) ==> 36`),curry:E(Ct,`(curry fn . args)

         Higher-order function that creates a curried version of the function.
         The result function will have partially applied arguments and it
         will keep returning one-argument functions until all arguments are provided,
         then it calls the original function with the accumulated arguments.

         e.g.:
         (define (add a b c d) (+ a b c d))
         (define add1 (curry add 1))
         (define add12 (add 2))
         (display (add12 3 4))`),gcd:E("gcd",function(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return Yr("lcm",n,"number"),n.reduce(function(i,a){return i.gcd(a)})},`(gcd n1 n2 ...)

        Function that returns the greatest common divisor of the arguments.`),lcm:E("lcm",function(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];Yr("lcm",n,"number");for(var i=n.length,a=Ht(n[0]),u=1;u<i;u++){for(var s=Ht(n[u]),o=a;a&&s;)a>s?a%=s:s%=a;a=Ht(o*n[u])/(a+s)}return l(a)},`(lcm n1 n2 ...)

        Function that returns the least common multiple of the arguments.`),"odd?":E("odd?",rn(function(e){return l(e).isOdd()}),`(odd? number)

         Checks if number is odd.`),"even?":E("even?",rn(function(e){return l(e).isEven()}),`(even? number)

         Checks if number is even.`),"*":E("*",La(function(e,r){return l(e).mul(r)},l(1)),`(* . numbers)

        Multiplies all numbers passed as arguments. If single value is passed
        it will return that value.`),"+":E("+",La(function(e,r){return l(e).add(r)},l(0)),`(+ . numbers)

        Sums all numbers passed as arguments. If single value is passed it will
        return that value.`),"-":E("-",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r.length===0)throw new Error("-: procedure require at least one argument");if(Yr("-",r,"number"),r.length===1)return l(r[0]).sub();if(r.length)return r.reduce(rt(function(t,i){return l(t).sub(i)}))},`(- n1 n2 ...)
        (- n)

        Subtracts n2 and subsequent numbers from n1. If only one argument is passed
        it will negate the value.`),"/":E("/",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r.length===0)throw new Error("/: procedure require at least one argument");return Yr("/",r,"number"),r.length===1?l(1).div(r[0]):r.reduce(rt(function(t,i){return l(t).div(i)}))},`(/ n1 n2 ...)
        (/ n)

        Divides n1 by n2 and subsequent arguments one by one. If single argument
        is passed it will calculate (/ 1 n).`),abs:E("abs",rn(function(e){return l(e).abs()}),`(abs number)

         Function that returns the absolute value (magnitude) of number.`),truncate:E("truncate",function(e){return U("truncate",e,"number"),l.isFloat(e)?(e instanceof l&&(e=e.valueOf()),ue(tc(e))):e},`(truncate n)

        Function that returns the integer part (floor) of a real number.`),sqrt:E("sqrt",rn(function(e){return l(e).sqrt()}),`(sqrt number)

         Function that returns the square root of the number.`),"**":E("**",rt(function(e,r){if(e=l(e),r=l(r),l.isInteger(r)){var n=r.cmp(0)===-1;if(n&&(r=r.sub()),l.isRational(e)){if(n){var t=e.__denom__.pow(r);if(e.__num__.cmp(1)===0)return t;var i=e.__num__.pow(r);return le({num:t,denom:i})}return le({num:e.__num__.pow(r),denom:e.__denom__.pow(r)})}if(n)return le({num:1,denom:e.pow(r)})}if(l.isRational(r)&&e.cmp(0)===-1){var a=r.__denom__,u=r.__num__;if(a.cmp(2)===0){var s=e.abs().pow(le({num:1,denom:2})),o=e.coerce(s),f=ve(o,2);if(s=f[1],r.cmp(0)===1)return oe({re:l(0),im:s});if(u.cmp(0)===-1)return oe({re:l(0),im:le({num:-1,denom:s})})}var c=r.valueOf(),_=c*Math.PI,m=e.abs().pow(c),k=m.mul(Math.cos(_)),L=m.mul(Math.sin(_));return oe({re:k,im:L})}var b=e.coerce(r),g=ve(b,2);return e=g[0],r=g[1],e.pow(r)}),`(** a b)

         Function that calculates number a to to the power of b.`),"1+":E("1+",rn(function(e){return l(e).add(1)}),`(1+ number)

         Function that adds 1 to the number and return result.`),"1-":E(rn(function(e){return l(e).sub(1)}),`(1- number)

         Function that subtracts 1 from the number and return result.`),"%":E("%",function(e,r){return Yr("%",[e,r],"number"),l(e).rem(r)},`(% n1 n2)

        Function returns the remainder of n1/n2 (modulo).`),"==":E("==",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Yr("==",r,"number"),Dn(function(t,i){return l(t).cmp(i)===0},r)},`(== x1 x2 ...)}

        Function that compares its numerical arguments and checks if they are
        all equal.`),">":E(">",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Hn(">",r,["bigint","float","rational"]),Dn(function(t,i){return l(t).cmp(i)===1},r)},`(> x1 x2 x3 ...)

        Function that compares its numerical arguments and checks if they are
        monotonically decreasing, i.e. x1 > x2 and x2 > x3 and so on.`),"<":E("<",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Hn("<",r,["bigint","float","rational"]),Dn(function(t,i){return l(t).cmp(i)===-1},r)},`(< x1 x2 ...)

        Function that compares its numerical arguments and checks if they are
        monotonically increasing, i.e. x1 < x2 and x2 < x3 and so on.`),"<=":E("<=",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Hn("<=",r,["bigint","float","rational"]),Dn(function(t,i){return[0,-1].includes(l(t).cmp(i))},r)},`(<= x1 x2 ...)

        Function that compares its numerical arguments and checks if they are
        monotonically nondecreasing, i.e. x1 <= x2 and x2 <= x3 and so on.`),">=":E(">=",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Hn(">=",r,["bigint","float","rational"]),Dn(function(t,i){return[0,1].includes(l(t).cmp(i))},r)},`(>= x1 x2 ...)

        Function that compares its numerical arguments and checks if they are
        monotonically nonincreasing, i.e. x1 >= x2 and x2 >= x3 and so on.`),"eq?":E("eq?",Li,`(eq? a b)

         Function that compares two values if they are identical.`),or:E(new fe("or",function(e,r){var n=r.use_dynamic,t=r.error,i=H.get("list->array")(e),a=this,u=a;if(!i.length)return!1;var s;return function o(){function f(m){return s=m,xn(s)?o():s}if(i.length){var c=i.shift(),_=ie(c,{env:a,dynamic_env:u,use_dynamic:n,error:t});return _e(_,f)}else return xn(s)?!1:s}()}),`(or . expressions)

         Macro that executes the values one by one and returns the first that is
         a truthy value. If there are no expressions that evaluate to true it
         returns false.`),and:E(new fe("and",function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.use_dynamic,t=r.error,i=H.get("list->array")(e),a=this,u=a;if(!i.length)return!0;var s,o={env:a,dynamic_env:u,use_dynamic:n,error:t};return function f(){function c(m){return s=m,xn(s)?s:f()}if(i.length){var _=i.shift();return _e(ie(_,o),c)}else return xn(s)?!1:s}()}),`(and . expressions)

         Macro that evaluates each expression in sequence and if any value returns false
         it will stop and return false. If each value returns true it will return the
         last value. If it's called without arguments it will return true.`),"|":E("|",function(e,r){return l(e).or(r)},`(| a b)

        Function that calculates the bitwise or operation.`),"&":E("&",function(e,r){return l(e).and(r)},`(& a b)

        Function that calculates the bitwise and operation.`),"~":E("~",function(e){return l(e).neg()},`(~ number)

        Function that calculates the bitwise inverse (flip all the bits).`),">>":E(">>",function(e,r){return l(e).shr(r)},`(>> a b)

        Function that right shifts the value a by value b bits.`),"<<":E("<<",function(e,r){return l(e).shl(r)},`(<< a b)

        Function that left shifts the value a by value b bits.`),not:E("not",function(r){return!r},`(not object)

        Function that returns the Boolean negation of its argument.`)},void 0,"global"),Oe=H.inherit("user-env");function Qu(e,r){e.constant("**internal-env**",r),e.doc("**internal-env**",`**internal-env**

         Constant used to hide stdin, stdout and stderr so they don't interfere
         with variables with the same name. Constants are an internal type
         of variable that can't be redefined, defining a variable with the same name
         will throw an error.`),H.set("**interaction-environment**",e)}Qu(Oe,Xu);H.doc("**interaction-environment**",`**interaction-environment**

    Internal dynamic, global variable used to find interpreter environment.
    It's used so the read and write functions can locate **internal-env**
    that contains the references to stdin, stdout and stderr.`);function Sc(e){Oe.get("**internal-env**").set("fs",e)}(function(){var e={ceil:"ceiling"};["floor","round","ceil"].forEach(function(r){var n=e[r]?e[r]:r;H.set(n,E(n,function(t){if(U(n,t,"number"),t instanceof l)return t[r]()},"(".concat(n,` number)

            Function that calculates the `).concat(n," of a number.")))})})();function Zu(e){if(e.length===1)return e[0];for(var r=[],n=Zu(e.slice(1)),t=0;t<n.length;t++)for(var i=0;i<e[0].length;i++)r.push(e[0][i]+n[t]);return r}function Bc(e,r,n){for(var t=[],i=r;i<=n;++i){for(var a=[],u=0;u<i;++u)a.push(e);t=t.concat(Zu(a))}return t}Bc(["d","a"],2,5).forEach(function(e){var r=e.split(""),n=r.slice().reverse(),t=r.map(function(a){return"(c".concat(a,"r")}).join(" ")+" arg"+")".repeat(r.length),i="c"+e+"r";H.set(i,E(i,function(a){return n.reduce(function(u,s){return U(i,u,"pair"),s==="a"?u.car:u.cdr},a)},"(".concat(i,` arg)

        Function that calculates `).concat(t)))});function jc(e,r){for(var n=e.split(Tr.sep).filter(Boolean),t=n.length;t--;){var i,a=(i=Tr).join.apply(i,["/"].concat(ge(n.slice(0,t+1))));if(r(a))return a}}function Ic(e){return jc(e,function(r){return fu.existsSync(Tr.join(r,"node_modules"))})}function Hi(){return typeof global<"u"&&global.global===global}var eo=function(){};function Pc(){return pi.apply(this,arguments)}function pi(){return pi=ke(ae.mark(function e(){var r,n,t,i,a;return ae.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,import("module");case 2:return r=s.sent,n=r.createRequire,Nr=n(import.meta.url),s.next=7,import("fs");case 7:return fu=s.sent,s.next=10,import("path");case 10:Tr=s.sent,H.set("global",global),H.set("self",global),H.set("window",void 0),t=new URL(import.meta.url),i=Tr.dirname(t.pathname),a=Tr.basename(t.pathname),H.set("__dirname",i),H.set("__filename",a),H.set("require.resolve",E("require.resolve",function(o){U("require.resolve",o,"string");var f=o.valueOf();return Nr.resolve(f)},`(require.resolve path)

        Returns the path relative to the current module.

        Only available when LIPS is running under Node.js.`)),H.set("require",E("require",function(o){U("require",o,"string"),o=o.valueOf();var f=process.cwd(),c;try{if(o.match(/^\s*\./))c=Nr(Tr.join(f,o));else{var _=Ic(f);_?c=Nr(Tr.join(_,"node_modules",o)):c=Nr(o)}}catch{c=Nr(o)}return vt(c,global)},`(require module)

        Function used inside Node.js to import a module.`)),process.on("unhandledRejection",function(o,f){o instanceof Cn&&f.catch(eo)});case 22:case"end":return s.stop()}},e)})),pi.apply(this,arguments)}var di;Hi()?di=Pc():(di=Promise.resolve(),typeof window<"u"&&window===Ar?(H.set("window",window),H.set("global",void 0),H.set("self",window)):typeof self<"u"&&typeof WorkerGlobalScope<"u"&&(H.set("self",self),H.set("window",void 0),H.set("global",void 0)));function Rr(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=e?" in expression `".concat(e,"`"):"";if(t!==null&&(i+=" (argument ".concat(t,")")),he(n))return"Invalid type: got ".concat(r).concat(i);if(n instanceof Array)if(n.length===1){var a=n[0].toLowerCase();n="a"+("aeiou".includes(a)?"n ":" ")+n[0]}else n=new Intl.ListFormat("en",{style:"long",type:"disjunction"}).format(n);return"Expecting ".concat(n," got ").concat(r).concat(i)}function ro(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;U(e,r,"number",t);var i=r.__type__,a;if(C(n)&&(n=n.to_array()),n instanceof Array&&(n=n.map(function(u){return u.valueOf()})),n instanceof Array?(n=n.map(function(u){return u.valueOf().toLowerCase()}),n.includes(i)&&(a=!0)):n=n.valueOf().toLowerCase(),!a&&i!==n)throw new Error(Rr(e,i,n,t))}function Hn(e,r,n){r.forEach(function(t,i){ro(e,t,n,i+1)})}function Yr(e,r,n){r.forEach(function(t,i){U(e,t,n,i+1)})}function Yn(e,r,n){if(U(e,r,n),r.__type__===St)throw new Error(Rr(e,"binary-port","textual-port"))}function U(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;e=e.valueOf();var i=Ae(r).toLowerCase();if(he(n)){if(!n(r))throw new Error(Rr(e,i,n,t));return}var a=!1;if(C(n)&&(n=n.to_array()),n instanceof Array&&(n=n.map(function(u){return u.valueOf()})),n instanceof Array?(n=n.map(function(u){return u.valueOf().toLowerCase()}),n.includes(i)&&(a=!0)):n=n.valueOf().toLowerCase(),!a&&i!==n)throw new Error(Rr(e,i,n,t))}function Nc(e){var r=new WeakMap;return function(n){var t=r.get(n);return t||(t=e(n)),t}}Ae=Nc(Ae);function Ae(e){var r=_s.get(e);if(r)return r;if(ye(e)==="object"){for(var n=0,t=Object.entries(ls);n<t.length;n++){var i=ve(t[n],2),a=i[0],u=i[1];if(e instanceof u)return a}if(Lu(e))return he(e.typeOf)?e.typeOf():"instance";if(e.constructor){if(e.constructor.__class__)return e.constructor.__class__;if(e.constructor===Object){if(mt(e,Symbol.iterator))return"iterator";if(mt(e,Symbol.asyncIterator))return"async-iterator"}return e.constructor.name===""?"object":e.constructor.name.toLowerCase()}}return e===void 0?"void":ye(e)}function vn(e){var r=[];if(n(e),r.length)return a(e);return e;function n(u){Ke(u)?r.push(u):C(u)?(u.have_cycles("car")||n(u.car),u.have_cycles("cdr")||n(u.cdr)):u instanceof Array&&u.forEach(n)}function t(u){return i.apply(this,arguments)}function i(){return i=ke(ae.mark(function u(s){var o;return ae.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(c.t0=B,!s.have_cycles("car")){c.next=5;break}c.t1=s.car,c.next=8;break;case 5:return c.next=7,a(s.car);case 7:c.t1=c.sent;case 8:if(c.t2=c.t1,!s.have_cycles("cdr")){c.next=13;break}c.t3=s.cdr,c.next=16;break;case 13:return c.next=15,a(s.cdr);case 15:c.t3=c.sent;case 16:return c.t4=c.t3,o=new c.t0(c.t2,c.t4),s[dr]&&(o[dr]=!0),c.abrupt("return",o);case 20:case"end":return c.stop()}},u)})),i.apply(this,arguments)}function a(u){return u instanceof Array?pn(u.map(a)):C(u)&&r.length?t(u):u}}function Tc(e,r){var n=r.use_dynamic,t=_n(r,as),i=[],a=e;function u(){return i}return function s(){if(C(a)){var o=ie(a.car,se({use_dynamic:n},t));return n&&(o=_e(o,function(f){return kt(f)?f.bind(dynamic_env):f})),_e(vn(o),function(f){if(i.push(f),a.have_cycles("cdr"))throw new Error("Invalid expression: Can't evaluate cycle");return a=a.cdr,s()})}else{if($(a))return u();throw new Error("Syntax Error: improper list found in apply")}}()}function za(e,r,n){var t=e.invoke(r,n);return _e(vn(t),function(i){return C(i)&&i.mark_cycles(),Ve(i)})}function Lc(e,r,n){function t(a){return C(a)?(a.mark_cycles(),a):Ve(a)}var i=e.invoke(r,n);return _e(vn(i),function(u){return!u||u&&u[dr]||pc(u)?u:_e(ie(u,n),t)},function(a){throw a})}function no(e,r){if($i(e)&&!mc(e)&&(!vc(e)||qu(e))&&(r=r.map(Ur)),!Tu(e)&&r.some(Vt)&&!Vt(e)&&!Js(e)){for(var n=[],t=r.length,i=function(){var s=r[t];Vt(s)?(a=function(){for(var f=arguments.length,c=new Array(f),_=0;_<f;_++)c[_]=arguments[_];return _e(s.apply(this,c),Ur)},xr(a,"__bound__",!0),xr(a,"__fn__",s),a.prototype=s.prototype,n[t]=a):n[t]=s},a;t--;)i();r=n}return r}function un(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=n.env,i=n.dynamic_env,a=n.use_dynamic,u=t?.new_frame(e,r),s=i?.new_frame(e,r),o=new jt({env:u,use_dynamic:a,dynamic_env:s});return vn(e.apply(o,r))}function Mc(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=n.env,i=n.dynamic_env,a=n.use_dynamic,u=n.error,s=u===void 0?function(){}:u;return r=Tc(r,{env:t,dynamic_env:i,error:s,use_dynamic:a}),_e(r,function(o){Tu(e)&&(e=Qe(e)),o=no(e,o);var f=o.slice(),c=un(e,f,{env:t,dynamic_env:i,use_dynamic:a});return _e(c,function(_){return C(_)?(_.mark_cycles(),Ve(_)):zi(_)},s)})}var Gn=new WeakMap,Bt=function(){function e(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(vr(this,e),Mr(this,"__value__",void 0),Mr(this,"__fn__",void 0),os(this,Gn,void 0),this.__value__=r,n){if(!he(n))throw new Error("Section argument to Parameter need to be function "+"".concat(Ae(n)," given"));this.__fn__=n}t&&ya(Gn,this,t)}return yr(e,[{key:"__name__",get:function(){return cs(Gn,this)},set:function(n){ya(Gn,this,n),this.__fn__&&(this.__fn__.__name__="fn-".concat(n))}},{key:"invoke",value:function(){return he(this.__fn__)?this.__fn__(this.__value__):this.__value__}},{key:"inherit",value:function(n){return new e(n,this.__fn__,this.__name__)}}])}(),jt=function(){function e(r){vr(this,e),Mr(this,"env",void 0),Mr(this,"dynamic_env",void 0),Mr(this,"use_dynamic",void 0),Object.assign(this,r)}return yr(e,[{key:"__name__",get:function(){return this.env.__name__}},{key:"__parent__",get:function(){return this.env.__parent__}},{key:"get",value:function(){var n;return(n=this.env).get.apply(n,arguments)}}])}();function Rc(e,r){var n=e.get(r.__name__,{throwError:!1});if(sn(n)&&n!==r)return n;for(var t=Oe.get("**interaction-environment**");;){var i=e.get("parent.frame",{throwError:!1});if(e=i(0),e===t)break;if(n=e.get(r.__name__,{throwError:!1}),sn(n)&&n!==r)return n}return r}var to=function(){function e(r){vr(this,e),Mr(this,"__value__",void 0),this.__value__=r}return yr(e,[{key:"invoke",value:function(){if(this.__value__===null)throw new Error("Continuations are not implemented yet")}}])}();function ie(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.env,t=r.dynamic_env,i=r.use_dynamic,a=r.error,u=a===void 0?eo:a,s=_n(r,us);return function(o){try{qi(t)||(t=n===!0?Oe:n||Oe),i?n=t:n===!0?n=Oe:n=n||H;var f={env:n,dynamic_env:t,use_dynamic:i,error:u},c;if(Lr(e))return e;if(e instanceof x)return n.get(e);if(!C(e))return e;var _=e.car,o=e.cdr;if(C(_)){if(c=vn(ie(_,f)),Ke(c))return c.then(function(g){if(!Pa(g))throw new Error(Ae(g)+" "+n.get("repr")(g)+" is not callable while evaluating "+e.toString());return ie(new B(g,e.cdr),f)});if(!Pa(c))throw new Error(Ae(c)+" "+n.get("repr")(c)+" is not callable while evaluating "+e.toString())}_ instanceof x?c=n.get(_):he(_)&&(c=_);var m;if(c instanceof Te)m=za(c,e,f);else if(c instanceof fe)m=Lc(c,o,f);else if(he(c))m=Mc(c,o,f);else if(c instanceof on)m=za(c._syntax,e,f);else if(sn(c)){var k=Rc(t,c);if(Lr(e.cdr))m=k.invoke();else return _e(ie(e.cdr.car,f),function(g){k.__value__=g})}else if(Ri(c))m=c.invoke();else{if(C(e))throw c=_&&_.toString(),new Error("".concat(Ae(_)," ").concat(c," is not a function"));return e}var L=n.get(Symbol.for("__promise__"),{throwError:!1});return L===!0&&Ke(m)?(m=m.then(function(g){return C(g)&&!c[dr]?ie(g,f):g}),new Pe(m)):m}catch(b){u&&u.call(n,b,e)}}(s)}var qc=io(function(e){return e}),cn=io(function(e,r){return r});function $a(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.env,t=r.dynamic_env,i=r.use_dynamic;return ie(e,{env:n,dynamic_env:t,use_dynamic:i,error:function(u,s){if(u&&u.message){if(u.message.match(/^Error:/)){var o=/^(Error:)\s*([^:]+:\s*)/;u.message=u.message.replace(o,"$1 $2")}s&&(u.__code__ instanceof Array||(u.__code__=[]),u.__code__.push(s.toString(!0)))}if(!(u instanceof Cn))throw u}})}function io(e){return function(){var r=ke(function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=i.env,u=i.dynamic_env,s=i.use_dynamic;return ae.mark(function o(){var f,c,_,m,k,L,b,g,h;return ae.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(qi(u)||(u=a===!0?Oe:a||Oe),a===!0?a=Oe:a=a||Oe,f=[],!C(t)){p.next=8;break}return p.next=6,$a(t,{env:a,dynamic_env:u,use_dynamic:s});case 6:return p.t0=p.sent,p.abrupt("return",[p.t0]);case 8:c=Array.isArray(t)?t:Ni(t),_=!1,m=!1,p.prev=11,L=cu(c);case 13:return p.next=15,L.next();case 15:if(!(_=!(b=p.sent).done)){p.next=24;break}return g=b.value,p.next=19,$a(g,{env:a,dynamic_env:u,use_dynamic:s});case 19:h=p.sent,f.push(e(g,h));case 21:_=!1,p.next=13;break;case 24:p.next=30;break;case 26:p.prev=26,p.t1=p.catch(11),m=!0,k=p.t1;case 30:if(p.prev=30,p.prev=31,!(_&&L.return!=null)){p.next=35;break}return p.next=35,L.return();case 35:if(p.prev=35,!m){p.next=38;break}throw k;case 38:return p.finish(35);case 39:return p.finish(30);case 40:return p.abrupt("return",f);case 41:case"end":return p.stop()}},o,null,[[11,26,30,40],[31,,35,39]])})()});function n(t){return r.apply(this,arguments)}return n}()}function it(e){var r={"[":"]","(":")"},n;if(typeof e=="string")try{n=hn(e)}catch(_){if(_ instanceof At)return!1;throw _}else n=e.map(function(_){return _&&_.token?_.token:_});var t=Object.keys(r),i=Object.values(r).concat(t);n=n.filter(function(_){return i.includes(_)});var a=new Tn,u=Or(n),s;try{for(u.s();!(s=u.n()).done;){var o=s.value;if(t.includes(o))a.push(o);else{if(a.is_empty())throw new Error("Syntax error: not matched closing ".concat(o));var f=a.top(),c=r[f];if(o===c)a.pop();else throw new Error("Syntax error: missing closing ".concat(c))}}}catch(_){u.e(_)}finally{u.f()}return a.is_empty()}function Uc(e){var r="("+e.toString()+")()",n=window.URL||window.webkitURL,t;try{t=new Blob([r],{type:"application/javascript"})}catch{var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;t=new i,t.append(r),t=t.getBlob()}return new Ar.Worker(n.createObjectURL(t))}function zc(){return mr.version.match(/^(\{\{VER\}\}|DEV)$/)}function $c(){if(!Hi()){var e;if(document.currentScript)e=document.currentScript;else{var r=document.querySelectorAll("script");if(!r.length)return;e=r[r.length-1]}var n=e.getAttribute("src");return n}}var bt=$c();function ln(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r="dist/std.xcb";e===""&&(bt?e=bt.replace(/[^/]*$/,"std.xcb"):zc()?e="https://cdn.jsdelivr.net/gh/jcubic/lips@devel/".concat(r):e="https://cdn.jsdelivr.net/npm/@jcubic/lips@".concat(mr.version,"/").concat(r)),H.set("__dirname",e.replace(/[^/]+$/,""));var n=H.get("load");return n.call(Oe,e,H)}function Vc(e){this.url=e;var r=this.worker=Uc(function(){var n,t;self.addEventListener("message",function(i){var a=i.data,u=a.id;if(a.type!=="RPC"||u===null)return;function s(c){self.postMessage({id:u,type:"RPC",result:c})}function o(c){self.postMessage({id:u,type:"RPC",error:c})}if(a.method==="eval"){if(!t){o("Worker RPC: LIPS not initialized, call init first");return}t.then(function(){var c=a.params[0],_=a.params[1];n.exec(c,{use_dynamic:_}).then(function(m){m=m.map(function(k){return k&&k.valueOf()}),s(m)}).catch(function(m){o(m)})})}else if(a.method==="init"){var f=a.params[0];typeof f!="string"?o("Worker RPC: url is not a string"):(importScripts("".concat(f,"/dist/lips.min.js")),n=new mr.Interpreter("worker"),t=ln(f),t.then(function(){s(!0)}))}})});this.rpc=function(){var n=0;return function(i,a){var u=++n;return new Promise(function(s,o){r.addEventListener("message",function f(c){var _=c.data;_&&_.type==="RPC"&&_.id===u&&(_.error?o(_.error):s(_.result),r.removeEventListener("message",f))}),r.postMessage({type:"RPC",method:i,id:u,params:a})})}}(),this.rpc("init",[e]).catch(function(n){console.error(n)}),this.exec=function(n,t){var i=t.use_dynamic,a=i===void 0?!1:i;return this.rpc("eval",[n,a])}}var wt={pair:function(r){var n=ve(r,2),t=n[0],i=n[1];return B(t,i)},number:function(r){return Q.isString(r)?l([r,10]):l(r)},regex:function(r){var n=ve(r,2),t=n[0],i=n[1];return new RegExp(t,i)},nil:function(){return te},symbol:function(r){if(Q.isString(r))return x(r);if(Array.isArray(r))return x(Symbol.for(r[0]))},string:Q,character:pe},ao=Object.keys(wt),uo={};for(Wn=0,Jt=Object.entries(ao);Wn<Jt.length;Wn++)Xt=ve(Jt[Wn],2),Va=Xt[0],Ha=Xt[1],uo[Ha]=+Va;var Xt,Va,Ha,Wn,Jt;function Ya(e){return uo[e]}function Hc(e){return ao[e]}function Yc(e){return JSON.stringify(e,function(r,n){var t=this[r];if(t){if(t instanceof RegExp)return{"@":Ya("regex"),"#":[t.source,t.flags]};var i=Ya(t.constructor.__class__);if(!Ui(i))return{"@":i,"#":t.serialize()}}return n})}function oo(e){return JSON.parse(e,function(r,n){if(n&&ye(n)==="object"&&!Ui(n["@"])){var t=Hc(n["@"]);if(wt[t])return wt[t](n["#"])}return n})}var so=function(){var e={pair:B,symbol:x,number:l,string:Q,character:pe,nil:te.constructor,regex:RegExp};function r(_,m){return{deserialize:m,Class:_}}for(var n=new _t,t={},i=0,a=Object.entries(wt);i<a.length;i++){var u=ve(a[i],2),s=u[0],o=u[1],f=e[s];t[s]=r(f,o)}var c=43311;return Object.keys(t).forEach(function(_){var m=t[_];if(typeof m=="function"){var k=m;da({Class:k,tag:c,encode:function(h,v){v(h.serialize())},decode:function(h){return new k(h)}})}else{var L=m.deserialize,b=m.Class;da({Class:b,tag:c,encode:function(h,v){if(h instanceof RegExp)return v([h.source,h.flags]);v(h.serialize())},decode:function(h){return L(h)}})}c++}),n}();function Gc(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r.length>1){var t=r.reduce(function(u,s){return u+s.length},0),i=new Uint8Array(t),a=0;return r.forEach(function(u){i.set(u,a),a+=u.length}),i}else if(r.length)return r[0]}function Wc(){var e=1,r=new TextEncoder("utf-8");return r.encode("LIPS".concat(e.toString().padStart(3," ")))}var co=7;function Kc(e){var r=new TextDecoder("utf-8"),n=r.decode(e.slice(0,co)),t=n.substring(0,4);if(t==="LIPS"){var i=n.match(/^(....).*([0-9]+)$/);if(i)return{type:i[1],version:Number(i[2])}}return{type:"unknown"}}function Jc(e){var r=Wc(),n=so.encode(e);return Gc(r,uu.pack(n,{magic:!1}))}function fo(e){var r=Kc(e),n=r.type,t=r.version;if(n==="LIPS"&&t===1){var i=uu.unpack(e.slice(co),{magic:!1});return so.decode(i)}else throw new Error("Invalid file format ".concat(n))}function Ga(e){console.error(e.message||e),Array.isArray(e.code)&&console.error(e.code.map(function(r,n){return"[".concat(n+1,"]: ").concat(r)}))}function Xc(){var e=["text/x-lips","text/x-scheme"],r;function n(s){var o;return(o=s.getAttribute("data-bootstrap"))!==null&&o!==void 0?o:s.getAttribute("bootstrap")}function t(s){return new Promise(function(o){var f=s.getAttribute("src");return f?fetch(f).then(function(c){return c.text()}).then(cn).then(o).catch(function(c){Ga(c),o()}):cn(s.innerHTML).then(o).catch(function(c){Ga(c),o()})})}function i(){return new Promise(function(s){var o=Array.from(document.querySelectorAll("script"));return function f(){var c=o.shift();if(!c)s();else{var _=c.getAttribute("type");if(e.includes(_)){var m=n(c);return!r&&typeof m=="string"?ln(m).then(function(){return t(c)}).then(f):t(c).then(f)}else _&&_.match(/lips|lisp/)&&console.warn("Expecting "+e.join(" or ")+" found "+_);return f()}}()})}if(window.document){if(Wa){var a=Wa,u=n(a);if(typeof u=="string")return ln(u).then(function(){return r=!0,i()})}}else return Promise.resolve();return i()}var Wa=typeof window<"u"&&window.document&&document.currentScript;typeof window<"u"&&hs(window,Xc);var Qc=function(){var e=Q("Sat, 10 May 2025 19:46:53 +0000").valueOf(),r=e==="{{DATE}}"?new Date:new Date(e),n=function(s){return s.toString().padStart(2,"0")},t=r.getFullYear(),i=[t,n(r.getMonth()+1),n(r.getDate())].join("-"),a=`
  __ __                          __
 / / \\ \\       _    _  ___  ___  \\ \\
| |   \\ \\     | |  | || . \\/ __>  | |
| |    > \\    | |_ | ||  _/\\__ \\  | |
| |   / ^ \\   |___||_||_|  <___/  | |
 \\_\\ /_/ \\_\\                     /_/

LIPS Interpreter DEV (`.concat(i,`) <https://lips.js.org>
Copyright (c) 2018-`).concat(t,` Jakub T. Jankiewicz

Type (env) to see environment with functions macros and variables. You can also
use (help name) to display help for specific function or macro, (apropos name)
to display list of matched names in environment and (dir object) to list
properties of an object.
`).replace(/^.*\n/,"");return a}();Z(dn,"__class__","ahead");Z(B,"__class__","pair");Z(Sr,"__class__","nil");Z(gr,"__class__","pattern");Z(Re,"__class__","formatter");Z(fe,"__class__","macro");Z(Te,"__class__","syntax");Z(Te.Parameter,"__class__","syntax-parameter");Z(we,"__class__","environment");Z(Ye,"__class__","input-port");Z($e,"__class__","output-port");Z(yt,"__class__","output-port");Z(kr,"__class__","output-string-port");Z(fr,"__class__","input-string-port");Z($r,"__class__","input-file-port");Z(ur,"__class__","output-file-port");Z(Pn,"__class__","lips-error");[l,oe,le,ue,De].forEach(function(e){Z(e,"__class__","number")});Z(pe,"__class__","character");Z(x,"__class__","symbol");Z(Q,"__class__","string");Z(Pe,"__class__","promise");Z(Bt,"__class__","parameter");var Zc="DEV",ef="Sat, 10 May 2025 19:46:53 +0000",Yi=Yu($s,Ni),mr={version:Zc,banner:Qc,date:ef,exec:cn,parse:Yi,tokenize:hn,evaluate:ie,compile:qc,serialize:Yc,unserialize:oo,box:zi,unbox:Ur,serialize_bin:Jc,unserialize_bin:fo,bootstrap:ln,Environment:we,env:Oe,Worker:Vc,Interpreter:Qr,balanced_parenthesis:it,balancedParenthesis:it,balanced:it,Macro:fe,Syntax:Te,Pair:B,Values:Vr,QuotedPromise:Pe,Error:Pn,quote:Ve,InputPort:Ye,OutputPort:$e,BufferedOutputPort:yt,InputFilePort:$r,OutputFilePort:ur,InputStringPort:fr,OutputStringPort:kr,InputByteVectorPort:Je,OutputByteVectorPort:or,InputBinaryFilePort:Xr,OutputBinaryFilePort:Cr,set_fs:Sc,Formatter:Re,Parser:Fr,Lexer:q,specials:Ce,repr:kn,nil:te,eof:Se,LSymbol:x,LNumber:l,LFloat:ue,LComplex:oe,LRational:le,LBigInteger:De,LCharacter:pe,LString:Q,Parameter:Bt,rationalize:kc};H.set("lips",mr);await ln("https://cdn.jsdelivr.net/npm/@jcubic/lips/dist/std.xcb");Ce.__list__={};var It=class extends Fr{match_datum_label(r){return null}match_datum_ref(r){return null}};function lo(e){let r={title:void 0,category:"Uncategorized",author:void 0,"author-url":void 0,version:void 0,description:void 0},n=Oe.get("list->array");for(var t of e){let i=n(t);if(i.length===3&&x.is(i[0],"define")&&i[1]instanceof x){let a=i[1].__name__,u=Zi.exec(a);if(u===null)continue;r[u[1]]=i[2].valueOf()}}return r}var Af=Oe.get("list->array");async function _o(e){let r=new It({env:Oe,meta:!0});return r.prepare(e),await Yi(r)}var Gi=[];async function rf(){let e=await fetch(ea).then(r=>r.json());return Array.isArray(e)?e.map(r=>r.name):[]}async function nf(){let e=await fetch(import.meta.resolve("../examples/files/"));return e.status===404?[]:Array.from(new DOMParser().parseFromString(await e.text(),"text/html").querySelectorAll("a[href]")).map(n=>n.textContent)}var tf=(await Promise.all([rf(),nf()])).flat(1).filter(e=>e.endsWith(Qi));for(Pt of tf){let e=Pt.replace(/\.[^/.]+$/,""),r=await fetch(import.meta.resolve(`../examples/files/${Pt}`),{cache:"reload"}).then(n=>n.text()).then(n=>_o(n)).then(n=>lo(n));r.hidden||Gi.push({filename:Pt,id:e,...r})}var Pt;var ho=Xi("#examples-container"),po=Object.groupBy(Gi,e=>e.category);for(Nt of Object.keys(po).sort()){let e=po[Nt];ho.append(er("h3",{id:"category-"+Nt.toLowerCase().replaceAll(" ","-")},Nt));let r=er("dl");ho.append(r);for(Xe of e){let n=[er("strong",{},er("a",{href:`../runner?example=${Xe.id}`},Xe.title??Xe.id))];if(Xe.version&&n.push(er("code",{},` v${Xe.version}`)),n.push(" (",er("a",{href:`../editor?example=${Xe.id}`},"edit"),")"),Xe.author||Xe["author-url"]){n.push(er("em",{}," by "));let t=Xe.author||Xe["author-url"];Xe["author-url"]?n.push(er("a",{href:Xe["author-url"],target:"_blank"},t)):n.push(t)}r.append(er("dt",{},...n)),Xe.description&&r.append(er("dd",{},Ji(Xe.description)))}}var Xe,Nt;
/*! Bundled license information:

@jcubic/lips/dist/lips.esm.min.js:
  (**@license
   *   __ __                          __
   *  / / \ \       _    _  ___  ___  \ \
   * | |   \ \     | |  | || . \/ __>  | |
   * | |    > \    | |_ | ||  _/\__ \  | |
   * | |   / ^ \   |___||_||_|  <___/  | |
   *  \_\ /_/ \_\                     /_/ v. DEV
   *
   * LIPS is Pretty Simple - Scheme based Powerful LISP in JavaScript
   *
   * Copyright (c) 2018-2024 Jakub T. Jankiewicz <https://jcubic.pl/me>
   * Released under the MIT license
   *
   * includes:
   *
   * unfetch by Jason Miller (@developit) MIT License
   *
   * contentloaded.js
   *
   * Author: Diego Perini (diego.perini at gmail.com)
   * Summary: cross-browser wrapper for DOMContentLoaded
   * Updated: 20101020
   * License: MIT
   * Version: 1.2
   *
   * URL:
   * http://javascript.nwbox.com/ContentLoaded/
   * http://javascript.nwbox.com/ContentLoaded/MIT-LICENSE
   *
   * dist file generated by Babel includes code
   * Copyright (c) 2014-present, Facebook, Inc.
   * released under MIT license
   *
   * build: Sat, 10 May 2025 19:46:53 +0000
   *)
  (**@license
   *
   * No Dependency fast and small LZJB Compression for Browser and Node
   *
   * Copyright (c) 2021 Jakub T. Jankiewicz https://jcubic.pl/me
   * Released under BSD-3-Clause License
   *
   * build: Wed, 27 Oct 2021 10:43:10 GMT
   *)
*/
//# sourceMappingURL=examples_page_main.js.map
